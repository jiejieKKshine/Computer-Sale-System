{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\n/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _slicedToArray } from '../_chunks/dep-5efe53d1.mjs';\nimport { _ as _toArray } from '../_chunks/dep-b874078b.mjs';\nimport { _ as _defineProperty } from '../_chunks/dep-fa52aa21.mjs';\nimport { _ as _typeof } from '../_chunks/dep-4659d73b.mjs';\nimport { defineComponent, toRefs, ref, computed, watch, onMounted, createVNode, mergeProps } from 'vue';\nimport { g as get_1 } from '../_chunks/dep-ae202bc0.mjs';\nimport { s as set_1 } from '../_chunks/dep-ed41e004.mjs';\nimport { i as isFunction_1 } from '../_chunks/dep-06dcbf4c.mjs';\nimport { c as cloneDeep_1 } from '../_chunks/dep-bb899bfd.mjs';\nimport { Edit1Icon } from 'tdesign-icons-vue-next';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon.mjs';\nimport { renderCell } from './tr.mjs';\nimport { validate } from '../form/form-model.mjs';\nimport '../_common/js/log/index.mjs';\nimport { on, off } from '../utils/dom.mjs';\nimport { i as isObject_1 } from '../_chunks/dep-2b09875b.mjs';\nimport { usePrefixClass } from '../hooks/useConfig.mjs';\nimport log from '../_common/js/log/log.mjs';\nimport '../_chunks/dep-593f2b67.mjs';\nimport '../_chunks/dep-4a990ea3.mjs';\nimport '../_chunks/dep-eca422c3.mjs';\nimport '../_chunks/dep-aeaef131.mjs';\nimport '../_chunks/dep-eae2a67e.mjs';\nimport '../_chunks/dep-626c497d.mjs';\nimport '../_chunks/dep-ab4bb9b8.mjs';\nimport '../_chunks/dep-bf7257e7.mjs';\nimport '../_chunks/dep-29ef8419.mjs';\nimport '../_chunks/dep-6ab5363f.mjs';\nimport '../_chunks/dep-6dc3d0e1.mjs';\nimport '../_chunks/dep-76958824.mjs';\nimport '../_chunks/dep-cda4f568.mjs';\nimport '../_chunks/dep-e9841b9e.mjs';\nimport '../_chunks/dep-7932c2e8.mjs';\nimport '../_chunks/dep-0e581ac0.mjs';\nimport '../_chunks/dep-49aeee3c.mjs';\nimport '../_chunks/dep-b5bf85f5.mjs';\nimport '../_chunks/dep-ec0bbd9f.mjs';\nimport '../_chunks/dep-5922c8f3.mjs';\nimport '../_chunks/dep-92f86d1d.mjs';\nimport '../_chunks/dep-1a4bb2f2.mjs';\nimport '../_chunks/dep-cc8ebcde.mjs';\nimport '../_chunks/dep-f5579c03.mjs';\nimport '../_chunks/dep-3c65fae8.mjs';\nimport '../_chunks/dep-1b78414a.mjs';\nimport '../_chunks/dep-d84f19b3.mjs';\nimport '../_chunks/dep-732f0b7d.mjs';\nimport '../config-provider/useConfig.mjs';\nimport '../_chunks/dep-03a7fb6c.mjs';\nimport '../_chunks/dep-1b9718a2.mjs';\nimport '../_chunks/dep-e065dc25.mjs';\nimport '../_chunks/dep-400ec705.mjs';\nimport '../_chunks/dep-02f9394e.mjs';\nimport '../_chunks/dep-1725b1c7.mjs';\nimport '../_chunks/dep-532409c5.mjs';\nimport '../_common/js/global-config/default-config.mjs';\nimport '../_common/js/global-config/locale/zh_CN.mjs';\nimport '../_chunks/dep-9ed7da3e.mjs';\nimport '../_chunks/dep-7f65fc46.mjs';\nimport '../_chunks/dep-4f2cabb0.mjs';\nimport '../config-provider/type.mjs';\nimport '../_chunks/dep-03ad9cda.mjs';\nimport '../_chunks/dep-d8a34055.mjs';\nimport '../_chunks/dep-2f6e28a0.mjs';\nimport '../_chunks/dep-5a17bf21.mjs';\nimport '../_chunks/dep-4de7e2ca.mjs';\nimport '../_chunks/dep-69e0f6fc.mjs';\nimport '../_chunks/dep-4ec29b23.mjs';\nimport './utils.mjs';\nimport './hooks/useFixed.mjs';\nimport '../_chunks/dep-5993931e.mjs';\nimport '../_chunks/dep-8dfc9324.mjs';\nimport '../_chunks/dep-6a7115de.mjs';\nimport '../_chunks/dep-4d4e2af1.mjs';\nimport '../_chunks/dep-3c4e4325.mjs';\nimport '../_chunks/dep-fbd4eddb.mjs';\nimport '../_chunks/dep-88c8d9ed.mjs';\nimport '../_common/js/utils/getScrollbarWidth.mjs';\nimport '../_common/js/utils/helper.mjs';\nimport '../_chunks/dep-5d3f7c0e.mjs';\nimport '../_chunks/dep-73384992.mjs';\nimport '../_chunks/dep-58a62202.mjs';\nimport '../_chunks/dep-889e457b.mjs';\nimport '../utils/easing.mjs';\nimport './hooks/useClassName.mjs';\nimport './ellipsis.mjs';\nimport '../utils/render-tnode.mjs';\nimport '../_chunks/dep-b91a8171.mjs';\nimport '../_chunks/dep-bad871d5.mjs';\nimport '../tooltip/index.mjs';\nimport '../tooltip/tooltip.mjs';\nimport '../_chunks/dep-88ae49da.mjs';\nimport '../tooltip/props.mjs';\nimport '../popup/props.mjs';\nimport '../popup/index.mjs';\nimport '../popup/popup.mjs';\nimport '@popperjs/core';\nimport '../hooks/index.mjs';\nimport '../hooks/icon.mjs';\nimport '../hooks/slot.mjs';\nimport '../hooks/tnode.mjs';\nimport '../hooks/useCommonClassName.mjs';\nimport '../hooks/useDefaultValue.mjs';\nimport '../hooks/useDestroyOnClose.mjs';\nimport '../hooks/useKeepAnimation.mjs';\nimport '../hooks/useRipple.mjs';\nimport '../utils/set-style.mjs';\nimport '../hooks/useVirtualScroll.mjs';\nimport '../hooks/useVModel.mjs';\nimport '../hooks/useImagePreviewUrl.mjs';\nimport '../_common/js/upload/utils.mjs';\nimport '../_common/js/utils/set-style.mjs';\nimport '../popup/container.mjs';\nimport '../hooks/useResizeObserver.mjs';\nimport '../utils/withInstall.mjs';\nimport './style/css.mjs';\nimport '../popup/type.mjs';\nimport '../tooltip/util.mjs';\nimport '../tooltip/type.mjs';\nimport './base-table-props.mjs';\nimport './hooks/useLazyLoad.mjs';\nimport '../_common/js/utils/observe.mjs';\nimport './hooks/useRowspanAndColspan.mjs';\nimport '../_chunks/dep-0d047dce.mjs';\nimport '../_chunks/dep-df472119.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nvar EditableCell = defineComponent({\n  name: \"TableEditableCell\",\n  props: {\n    row: Object,\n    rowKey: String,\n    rowIndex: Number,\n    col: Object,\n    colIndex: Number,\n    oldCell: [Function, String],\n    tableBaseClass: Object,\n    cellEmptyContent: [Function, String],\n    editable: {\n      type: Boolean,\n      \"default\": void 0\n    },\n    readonly: {\n      type: Boolean\n    },\n    errors: {\n      type: Array,\n      \"default\": void 0\n    },\n    onChange: Function,\n    onValidate: Function,\n    onRuleChange: Function,\n    onEditableChange: Function\n  },\n  emits: [\"update-edited-cell\"],\n  setup: function setup(props, context) {\n    var _props$col$edit;\n    var _toRefs = toRefs(props),\n      row = _toRefs.row,\n      col = _toRefs.col;\n    var tableEditableCellRef = ref(null);\n    var isKeepEditMode = computed(function () {\n      var _col$value$edit;\n      return (_col$value$edit = col.value.edit) === null || _col$value$edit === void 0 ? void 0 : _col$value$edit.keepEditMode;\n    });\n    var isEdit = ref(isKeepEditMode.value || ((_props$col$edit = props.col.edit) === null || _props$col$edit === void 0 ? void 0 : _props$col$edit.defaultEditable) || false);\n    var editValue = ref();\n    var errorList = ref();\n    var classPrefix = usePrefixClass();\n    var _useGlobalIcon = useGlobalIcon({\n        Edit1Icon: Edit1Icon\n      }),\n      Edit1Icon$1 = _useGlobalIcon.Edit1Icon;\n    var updateEditedCellValue = function updateEditedCellValue(obj) {\n      if (_typeof(obj) === \"object\" && (\"rowValue\" in obj || obj.isUpdateCurrentRow)) {\n        var rowValue = obj.isUpdateCurrentRow ? get_1(row.value, props.rowKey) : obj.rowValue;\n        delete obj.rowValue;\n        delete obj.isUpdateCurrentRow;\n        context.emit(\"update-edited-cell\", rowValue, row.value, obj);\n      } else {\n        editValue.value = obj;\n      }\n    };\n    watch([isKeepEditMode], function (val) {\n      if (val) {\n        isEdit.value = true;\n      }\n    });\n    var editOnListeners = computed(function () {\n      var _col$value$edit2, _col$value$edit2$on;\n      return ((_col$value$edit2 = col.value.edit) === null || _col$value$edit2 === void 0 || (_col$value$edit2$on = _col$value$edit2.on) === null || _col$value$edit2$on === void 0 ? void 0 : _col$value$edit2$on.call(_col$value$edit2, _objectSpread(_objectSpread({}, cellParams.value), {}, {\n        editedRow: currentRow.value,\n        updateEditedCellValue: updateEditedCellValue\n      }))) || {};\n    });\n    var cellParams = computed(function () {\n      return {\n        rowIndex: props.rowIndex,\n        colIndex: props.colIndex,\n        col: props.col,\n        row: props.row\n      };\n    });\n    var currentRow = computed(function () {\n      var colKey = col.value.colKey;\n      var _ref = colKey.split(\".\") || [],\n        _ref2 = _toArray(_ref),\n        firstKey = _ref2[0],\n        restKeys = _ref2.slice(1);\n      var newRow = _objectSpread({}, row.value);\n      if (restKeys.length) {\n        newRow[firstKey] = cloneDeep_1(row.value[firstKey]);\n        set_1(newRow[firstKey], restKeys.join(\".\"), editValue.value);\n      } else {\n        set_1(newRow, colKey, editValue.value);\n      }\n      return newRow;\n    });\n    var cellNode = computed(function () {\n      var node = renderCell({\n        row: currentRow.value,\n        col: _objectSpread(_objectSpread({}, col.value), {}, {\n          cell: props.oldCell\n        }),\n        rowIndex: props.rowIndex,\n        colIndex: props.colIndex\n      }, context.slots, {\n        cellEmptyContent: props.cellEmptyContent\n      });\n      return node;\n    });\n    var editProps = computed(function () {\n      var edit = col.value.edit;\n      return isFunction_1(edit.props) ? edit.props(_objectSpread(_objectSpread({}, cellParams.value), {}, {\n        editedRow: currentRow.value,\n        updateEditedCellValue: updateEditedCellValue\n      })) : _objectSpread({}, edit.props);\n    });\n    var componentProps = computed(function () {\n      var _edit$abortEditOnEven;\n      var edit = col.value.edit;\n      if (!edit) return {};\n      var tmpProps = _objectSpread({}, editProps.value);\n      delete tmpProps.onChange;\n      delete tmpProps.value;\n      (_edit$abortEditOnEven = edit.abortEditOnEvent) === null || _edit$abortEditOnEven === void 0 || _edit$abortEditOnEven.forEach(function (item) {\n        delete tmpProps[item];\n      });\n      return tmpProps;\n    });\n    var isAbortEditOnChange = computed(function () {\n      var _edit$abortEditOnEven2;\n      var edit = col.value.edit;\n      if (!edit) return false;\n      return Boolean((_edit$abortEditOnEven2 = edit.abortEditOnEvent) === null || _edit$abortEditOnEven2 === void 0 ? void 0 : _edit$abortEditOnEven2.includes(\"onChange\"));\n    });\n    var validateEdit = function validateEdit(trigger) {\n      return new Promise(function (resolve) {\n        var params = {\n          result: [_objectSpread(_objectSpread({}, cellParams.value), {}, {\n            errorList: [],\n            value: editValue.value\n          })],\n          trigger: trigger\n        };\n        var rules = isFunction_1(col.value.edit.rules) ? col.value.edit.rules(cellParams.value) : col.value.edit.rules;\n        if (!col.value.edit || !rules || !rules.length) {\n          var _props$onValidate;\n          (_props$onValidate = props.onValidate) === null || _props$onValidate === void 0 || _props$onValidate.call(props, params);\n          resolve(true);\n          return;\n        }\n        validate(editValue.value, rules).then(function (result) {\n          var _props$onValidate2;\n          var list = result === null || result === void 0 ? void 0 : result.filter(function (t) {\n            return !t.result;\n          });\n          params.result[0].errorList = list;\n          (_props$onValidate2 = props.onValidate) === null || _props$onValidate2 === void 0 || _props$onValidate2.call(props, params);\n          if (!list || !list.length) {\n            errorList.value = [];\n            resolve(true);\n          } else {\n            errorList.value = list;\n            resolve(list);\n          }\n        });\n      });\n    };\n    var isSame = function isSame(a, b) {\n      if (isObject_1(a) && isObject_1(b)) {\n        return JSON.stringify(a) === JSON.stringify(b);\n      }\n      return a === b;\n    };\n    var updateAndSaveAbort = function updateAndSaveAbort(outsideAbortEvent, eventName) {\n      for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n        args[_key - 2] = arguments[_key];\n      }\n      validateEdit(\"self\").then(function (result) {\n        var _editOnListeners$valu, _editOnListeners$valu2;\n        if (result !== true) return;\n        var oldValue = get_1(row.value, col.value.colKey);\n        if (!isSame(editValue.value, oldValue)) {\n          editValue.value = oldValue;\n          outsideAbortEvent === null || outsideAbortEvent === void 0 || outsideAbortEvent.apply(void 0, args);\n        }\n        (_editOnListeners$valu = (_editOnListeners$valu2 = editOnListeners.value)[eventName]) === null || _editOnListeners$valu === void 0 || _editOnListeners$valu.call(_editOnListeners$valu2, args[2]);\n        var timer = setTimeout(function () {\n          var _props$onEditableChan;\n          if (!isKeepEditMode.value) {\n            isEdit.value = false;\n          }\n          errorList.value = [];\n          (_props$onEditableChan = props.onEditableChange) === null || _props$onEditableChan === void 0 || _props$onEditableChan.call(props, _objectSpread(_objectSpread({}, cellParams.value), {}, {\n            value: editValue.value,\n            editedRow: _objectSpread(_objectSpread({}, props.row), {}, _defineProperty({}, props.col.colKey, editValue.value)),\n            validateEdit: validateEdit,\n            isEdit: false\n          }));\n          clearTimeout(timer);\n        }, 0);\n      });\n    };\n    var listeners = computed(function () {\n      var _edit$abortEditOnEven3;\n      var edit = col.value.edit;\n      var isCellEditable = props.editable === void 0;\n      if (!isEdit.value || !isCellEditable) return;\n      if (!(edit !== null && edit !== void 0 && (_edit$abortEditOnEven3 = edit.abortEditOnEvent) !== null && _edit$abortEditOnEven3 !== void 0 && _edit$abortEditOnEven3.length)) return {};\n      var tListeners = {};\n      var outsideAbortEvent = edit === null || edit === void 0 ? void 0 : edit.onEdited;\n      edit.abortEditOnEvent.forEach(function (itemEvent) {\n        if (itemEvent === \"onChange\") return;\n        tListeners[itemEvent] = function () {\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n          updateAndSaveAbort.apply(void 0, [outsideAbortEvent, itemEvent, _objectSpread(_objectSpread({}, cellParams.value), {}, {\n            trigger: itemEvent,\n            newRowData: currentRow.value\n          })].concat(args));\n        };\n      });\n      return tListeners;\n    });\n    var onEditChange = function onEditChange(val) {\n      var _editProps$value, _editProps$value$onCh, _props$onChange, _props$onRuleChange, _editOnListeners$valu3, _editOnListeners$valu4, _col$value$edit4;\n      editValue.value = val;\n      var params = _objectSpread(_objectSpread({}, cellParams.value), {}, {\n        value: val,\n        editedRow: _objectSpread(_objectSpread({}, props.row), {}, _defineProperty({}, props.col.colKey, val))\n      });\n      for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        args[_key3 - 1] = arguments[_key3];\n      }\n      (_editProps$value = editProps.value) === null || _editProps$value === void 0 || (_editProps$value$onCh = _editProps$value.onChange) === null || _editProps$value$onCh === void 0 || _editProps$value$onCh.call.apply(_editProps$value$onCh, [_editProps$value, val].concat(args));\n      (_props$onChange = props.onChange) === null || _props$onChange === void 0 || _props$onChange.call(props, params);\n      (_props$onRuleChange = props.onRuleChange) === null || _props$onRuleChange === void 0 || _props$onRuleChange.call(props, params);\n      (_editOnListeners$valu3 = editOnListeners.value) === null || _editOnListeners$valu3 === void 0 || (_editOnListeners$valu4 = _editOnListeners$valu3.onChange) === null || _editOnListeners$valu4 === void 0 || _editOnListeners$valu4.call(_editOnListeners$valu3, params);\n      var isCellEditable = props.editable === void 0;\n      if (isCellEditable && isAbortEditOnChange.value) {\n        var _col$value$edit3;\n        var outsideAbortEvent = (_col$value$edit3 = col.value.edit) === null || _col$value$edit3 === void 0 ? void 0 : _col$value$edit3.onEdited;\n        updateAndSaveAbort.apply(void 0, [outsideAbortEvent, \"change\", _objectSpread(_objectSpread({}, cellParams.value), {}, {\n          trigger: \"onChange\",\n          newRowData: currentRow.value\n        })].concat(args));\n      }\n      if (((_col$value$edit4 = col.value.edit) === null || _col$value$edit4 === void 0 ? void 0 : _col$value$edit4.validateTrigger) === \"change\") {\n        validateEdit(\"self\");\n      }\n    };\n    var documentClickHandler = function documentClickHandler(e) {\n      var _e$composedPath;\n      if (!col.value.edit || !col.value.edit.component) return;\n      if (!isEdit.value) return;\n      var path = ((_e$composedPath = e.composedPath) === null || _e$composedPath === void 0 ? void 0 : _e$composedPath.call(e)) || e.path || [];\n      var node = path.find(function (node2) {\n        var _node2$classList;\n        return (_node2$classList = node2.classList) === null || _node2$classList === void 0 ? void 0 : _node2$classList.contains(\"\".concat(classPrefix.value, \"-popup__content\"));\n      });\n      if (node) return;\n      var outsideAbortEvent = col.value.edit.onEdited;\n      updateAndSaveAbort(outsideAbortEvent, \"\", _objectSpread(_objectSpread({}, cellParams.value), {}, {\n        trigger: \"document\",\n        newRowData: currentRow.value\n      }));\n    };\n    var enterEdit = function enterEdit() {\n      var _props$onEditableChan2;\n      (_props$onEditableChan2 = props.onEditableChange) === null || _props$onEditableChan2 === void 0 || _props$onEditableChan2.call(props, _objectSpread(_objectSpread({}, cellParams.value), {}, {\n        value: editValue.value,\n        editedRow: props.row,\n        isEdit: true,\n        validateEdit: validateEdit\n      }));\n    };\n    var onCellClick = function onCellClick(e) {\n      isEdit.value = true;\n      enterEdit();\n      e.stopPropagation();\n    };\n    onMounted(function () {\n      var _props$col$edit2;\n      if ((_props$col$edit2 = props.col.edit) !== null && _props$col$edit2 !== void 0 && _props$col$edit2.defaultEditable) {\n        enterEdit();\n      }\n    });\n    var cellValue = computed(function () {\n      return get_1(row.value, col.value.colKey);\n    });\n    watch(cellValue, function (cellValue2) {\n      editValue.value = cellValue2;\n    }, {\n      immediate: true\n    });\n    watch(isEdit, function (isEdit2) {\n      var isCellEditable = props.editable === void 0;\n      if (!col.value.edit || !col.value.edit.component || !isCellEditable) return;\n      if (isEdit2) {\n        on(document, \"click\", documentClickHandler);\n      } else {\n        off(document, \"click\", documentClickHandler);\n      }\n    }, {\n      immediate: true\n    });\n    watch(function () {\n      return [props.editable, props.row, props.col, props.rowIndex, props.colIndex];\n    }, function (_ref3) {\n      var _ref4 = _slicedToArray(_ref3, 1),\n        editable = _ref4[0];\n      if (editable === false) {\n        editValue.value = cellValue.value;\n      } else if (editable === true) {\n        var _props$onRuleChange2;\n        (_props$onRuleChange2 = props.onRuleChange) === null || _props$onRuleChange2 === void 0 || _props$onRuleChange2.call(props, _objectSpread(_objectSpread({}, cellParams.value), {}, {\n          value: cellValue.value,\n          editedRow: row.value\n        }));\n      }\n    }, {\n      immediate: true\n    });\n    watch(function () {\n      return props.errors;\n    }, function (errors) {\n      errorList.value = errors;\n    });\n    return function () {\n      var _col$value$edit6, _errorList$value, _col$value$edit7, _errorList$value2;\n      if (props.readonly) {\n        return cellNode.value;\n      }\n      if (props.editable === void 0 && !isEdit.value || props.editable === false) {\n        var _col$value$edit5;\n        return createVNode(\"div\", {\n          \"class\": props.tableBaseClass.cellEditable,\n          \"onClick\": onCellClick\n        }, [cellNode.value, ((_col$value$edit5 = col.value.edit) === null || _col$value$edit5 === void 0 ? void 0 : _col$value$edit5.showEditIcon) !== false && createVNode(Edit1Icon$1, null, null)]);\n      }\n      var Component = (_col$value$edit6 = col.value.edit) === null || _col$value$edit6 === void 0 ? void 0 : _col$value$edit6.component;\n      if (!Component) {\n        log.error(\"Table\", \"edit.component is required.\");\n        return null;\n      }\n      var errorMessage = (_errorList$value = errorList.value) === null || _errorList$value === void 0 || (_errorList$value = _errorList$value[0]) === null || _errorList$value === void 0 ? void 0 : _errorList$value.message;\n      var tmpEditOnListeners = _objectSpread({}, editOnListeners.value);\n      delete tmpEditOnListeners.onChange;\n      if ((_col$value$edit7 = col.value.edit) !== null && _col$value$edit7 !== void 0 && (_col$value$edit7 = _col$value$edit7.abortEditOnEvent) !== null && _col$value$edit7 !== void 0 && _col$value$edit7.length) {\n        col.value.edit.abortEditOnEvent.forEach(function (onEventName) {\n          if (tmpEditOnListeners[onEventName]) {\n            delete tmpEditOnListeners[onEventName];\n          }\n        });\n      }\n      return createVNode(\"div\", {\n        \"class\": props.tableBaseClass.cellEditWrap,\n        \"onClick\": function onClick(e) {\n          e.stopPropagation();\n        },\n        \"ref\": \"tableEditableCellRef\"\n      }, [createVNode(Component, mergeProps({\n        \"status\": errorMessage ? ((_errorList$value2 = errorList.value) === null || _errorList$value2 === void 0 || (_errorList$value2 = _errorList$value2[0]) === null || _errorList$value2 === void 0 ? void 0 : _errorList$value2.type) || \"error\" : void 0,\n        \"tips\": errorMessage\n      }, componentProps.value, listeners.value, tmpEditOnListeners, {\n        \"value\": editValue.value,\n        \"onChange\": onEditChange\n      }), null)]);\n    };\n  }\n});\nexport { EditableCell as default };","map":{"version":3,"names":["EditableCell","defineComponent","name","props","row","Object","rowKey","String","rowIndex","Number","col","colIndex","oldCell","Function","tableBaseClass","cellEmptyContent","editable","type","Boolean","readonly","errors","Array","onChange","onValidate","onRuleChange","onEditableChange","emits","setup","context","_props$col$edit","_toRefs","toRefs","tableEditableCellRef","ref","isKeepEditMode","computed","_col$value$edit","value","edit","keepEditMode","isEdit","defaultEditable","editValue","errorList","classPrefix","usePrefixClass","_useGlobalIcon","useGlobalIcon","Edit1Icon","Edit1Icon$1","updateEditedCellValue","obj","_typeof","isUpdateCurrentRow","rowValue","get_1","emit","watch","val","editOnListeners","_col$value$edit2","_col$value$edit2$on","on","call","_objectSpread","cellParams","editedRow","currentRow","colKey","_ref","split","_ref2","_toArray","firstKey","restKeys","slice","newRow","length","cloneDeep_1","set_1","join","cellNode","node","renderCell","cell","slots","editProps","isFunction_1","componentProps","_edit$abortEditOnEven","tmpProps","abortEditOnEvent","forEach","item","isAbortEditOnChange","_edit$abortEditOnEven2","includes","validateEdit","trigger","Promise","resolve","params","result","rules","_props$onValidate","validate","then","_props$onValidate2","list","filter","t","isSame","a","b","isObject_1","JSON","stringify","updateAndSaveAbort","outsideAbortEvent","eventName","_len","arguments","args","_key","_editOnListeners$valu","_editOnListeners$valu2","oldValue","apply","timer","setTimeout","_props$onEditableChan","_defineProperty","clearTimeout","listeners","_edit$abortEditOnEven3","isCellEditable","tListeners","onEdited","itemEvent","_len2","_key2","newRowData","concat","onEditChange","_editProps$value","_editProps$value$onCh","_props$onChange","_props$onRuleChange","_editOnListeners$valu3","_editOnListeners$valu4","_col$value$edit4","_len3","_key3","_col$value$edit3","validateTrigger","documentClickHandler","e","_e$composedPath","component","path","composedPath","find","node2","_node2$classList","classList","contains","enterEdit","_props$onEditableChan2","onCellClick","stopPropagation","onMounted","_props$col$edit2","cellValue","cellValue2","immediate","isEdit2","document","off","_ref3","_ref4","_slicedToArray","_props$onRuleChange2","_col$value$edit6","_errorList$value","_col$value$edit7","_errorList$value2","_col$value$edit5","createVNode","cellEditable","showEditIcon","Component","log","error","errorMessage","message","tmpEditOnListeners","onEventName","cellEditWrap","onClick","mergeProps"],"sources":["../../src/table/editable-cell.tsx"],"sourcesContent":["import { computed, defineComponent, onMounted, PropType, ref, SetupContext, toRefs, watch } from 'vue';\nimport get from 'lodash/get';\nimport set from 'lodash/set';\nimport isFunction from 'lodash/isFunction';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { Edit1Icon as TdEdit1Icon } from 'tdesign-icons-vue-next';\nimport {\n  TableRowData,\n  PrimaryTableCol,\n  PrimaryTableRowEditContext,\n  PrimaryTableRowValidateContext,\n  TdBaseTableProps,\n  TableEditableCellPropsParams,\n} from './type';\nimport { TableClassName } from './hooks/useClassName';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport { renderCell } from './tr';\nimport { validate } from '../form/form-model';\nimport log from '../_common/js/log';\nimport { AllValidateResult } from '../form/type';\nimport { on, off } from '../utils/dom';\nimport isObject from 'lodash/isObject';\nimport { usePrefixClass } from '../hooks/useConfig';\n\nexport interface OnEditableChangeContext<T> extends PrimaryTableRowEditContext<T> {\n  isEdit: boolean;\n  validateEdit: (trigger: 'self' | 'parent') => Promise<true | AllValidateResult[]>;\n}\n\nexport interface EditableCellProps {\n  rowKey: string;\n  row: TableRowData;\n  rowIndex: number;\n  col: PrimaryTableCol<TableRowData>;\n  colIndex: number;\n  oldCell: PrimaryTableCol<TableRowData>['cell'];\n  tableBaseClass?: TableClassName['tableBaseClass'];\n  /** 行编辑需要使用 editable。单元格编辑则无需使用，设置为 undefined */\n  editable?: boolean;\n  readonly?: boolean;\n  errors?: AllValidateResult[];\n  cellEmptyContent?: TdBaseTableProps['cellEmptyContent'];\n  /** 编辑数据时触发 */\n  onChange?: (context: PrimaryTableRowEditContext<TableRowData>) => void;\n  /** 校验结束后触发 */\n  onValidate?: (context: PrimaryTableRowValidateContext<TableRowData>) => void;\n  /** 校验规则发生变化时触发 */\n  onRuleChange?: (context: PrimaryTableRowEditContext<TableRowData>) => void;\n  /** 进入或退出编辑态时触发 */\n  onEditableChange?: (context: OnEditableChangeContext<TableRowData>) => void;\n}\n\nexport default defineComponent({\n  name: 'TableEditableCell',\n  props: {\n    row: Object as PropType<EditableCellProps['row']>,\n    rowKey: String,\n    rowIndex: Number,\n    col: Object as PropType<EditableCellProps['col']>,\n    colIndex: Number,\n    oldCell: [Function, String] as PropType<EditableCellProps['oldCell']>,\n    tableBaseClass: Object as PropType<EditableCellProps['tableBaseClass']>,\n    cellEmptyContent: [Function, String] as PropType<EditableCellProps['cellEmptyContent']>,\n    editable: {\n      type: Boolean,\n      default: undefined,\n    },\n    readonly: {\n      type: Boolean,\n    },\n    errors: {\n      type: Array as PropType<EditableCellProps['errors']>,\n      default: undefined,\n    },\n    onChange: Function as PropType<EditableCellProps['onChange']>,\n    onValidate: Function as PropType<EditableCellProps['onValidate']>,\n    onRuleChange: Function as PropType<EditableCellProps['onRuleChange']>,\n    onEditableChange: Function as PropType<EditableCellProps['onEditableChange']>,\n  },\n\n  emits: ['update-edited-cell'],\n\n  setup(props: EditableCellProps, context: SetupContext) {\n    const { row, col } = toRefs(props);\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const tableEditableCellRef = ref(null);\n    const isKeepEditMode = computed(() => col.value.edit?.keepEditMode);\n    const isEdit = ref(isKeepEditMode.value || props.col.edit?.defaultEditable || false);\n    const editValue = ref();\n    const errorList = ref<AllValidateResult[]>();\n    const classPrefix = usePrefixClass();\n\n    const { Edit1Icon } = useGlobalIcon({ Edit1Icon: TdEdit1Icon });\n\n    const updateEditedCellValue: TableEditableCellPropsParams<TableRowData>['updateEditedCellValue'] = (obj) => {\n      if (typeof obj === 'object' && ('rowValue' in obj || obj.isUpdateCurrentRow)) {\n        const rowValue = obj.isUpdateCurrentRow ? get(row.value, props.rowKey) : obj.rowValue;\n        delete obj.rowValue;\n        delete obj.isUpdateCurrentRow;\n        context.emit('update-edited-cell', rowValue, row.value, obj);\n      } else {\n        editValue.value = obj;\n      }\n    };\n\n    watch([isKeepEditMode], (val) => {\n      if (val) {\n        isEdit.value = true;\n      }\n    });\n\n    const editOnListeners = computed(() => {\n      return col.value.edit?.on?.({ ...cellParams.value, editedRow: currentRow.value, updateEditedCellValue }) || {};\n    });\n\n    const cellParams = computed(() => ({\n      rowIndex: props.rowIndex,\n      colIndex: props.colIndex,\n      col: props.col,\n      row: props.row,\n    }));\n\n    const currentRow = computed(() => {\n      const { colKey } = col.value;\n      // handle colKey like a.b.c\n      const [firstKey, ...restKeys] = colKey.split('.') || [];\n      const newRow = { ...row.value };\n      if (restKeys.length) {\n        newRow[firstKey] = cloneDeep(row.value[firstKey]);\n        set(newRow[firstKey], restKeys.join('.'), editValue.value);\n      } else {\n        set(newRow, colKey, editValue.value);\n      }\n      return newRow;\n    });\n\n    const cellNode = computed(() => {\n      const node = renderCell(\n        {\n          row: currentRow.value,\n          col: { ...col.value, cell: props.oldCell },\n          rowIndex: props.rowIndex,\n          colIndex: props.colIndex,\n        },\n        context.slots,\n        { cellEmptyContent: props.cellEmptyContent },\n      );\n      return node;\n    });\n\n    const editProps = computed(() => {\n      const { edit } = col.value;\n      return isFunction(edit.props)\n        ? edit.props({\n            ...cellParams.value,\n            editedRow: currentRow.value,\n            updateEditedCellValue,\n          })\n        : { ...edit.props };\n    });\n\n    const componentProps = computed(() => {\n      const { edit } = col.value;\n      if (!edit) return {};\n      const tmpProps = { ...editProps.value };\n      // for removing warn: runtime-core.esm-bundler.js:38 [Vue warn]: Invalid prop: type check failed for prop \"onChange\". Expected Function, got Array\n      delete tmpProps.onChange;\n      delete tmpProps.value;\n      edit.abortEditOnEvent?.forEach((item) => {\n        delete tmpProps[item];\n      });\n      return tmpProps;\n    });\n\n    const isAbortEditOnChange = computed(() => {\n      const { edit } = col.value;\n      if (!edit) return false;\n      return Boolean(edit.abortEditOnEvent?.includes('onChange'));\n    });\n\n    const validateEdit = (trigger: 'self' | 'parent'): Promise<true | AllValidateResult[]> => {\n      return new Promise((resolve) => {\n        const params: PrimaryTableRowValidateContext<TableRowData> = {\n          result: [\n            {\n              ...cellParams.value,\n              errorList: [],\n              value: editValue.value,\n            },\n          ],\n          trigger,\n        };\n        const rules = isFunction(col.value.edit.rules) ? col.value.edit.rules(cellParams.value) : col.value.edit.rules;\n        if (!col.value.edit || !rules || !rules.length) {\n          props.onValidate?.(params);\n          resolve(true);\n          return;\n        }\n        validate(editValue.value, rules).then((result) => {\n          const list = result?.filter((t) => !t.result);\n          params.result[0].errorList = list;\n          props.onValidate?.(params);\n          if (!list || !list.length) {\n            errorList.value = [];\n            resolve(true);\n          } else {\n            errorList.value = list;\n            resolve(list);\n          }\n        });\n      });\n    };\n\n    const isSame = (a: any, b: any) => {\n      if (isObject(a) && isObject(b)) {\n        return JSON.stringify(a) === JSON.stringify(b);\n      }\n      return a === b;\n    };\n\n    const updateAndSaveAbort = (outsideAbortEvent: Function, eventName: string, ...args: any) => {\n      validateEdit('self').then((result) => {\n        if (result !== true) return;\n        const oldValue = get(row.value, col.value.colKey);\n        // 相同的值无需触发变化\n        if (!isSame(editValue.value, oldValue)) {\n          editValue.value = oldValue;\n          outsideAbortEvent?.(...args);\n        }\n        editOnListeners.value[eventName]?.(args[2]);\n        // 此处必须在事件执行完成后异步销毁编辑组件，否则会导致事件清除不及时引起的其他问题\n        const timer = setTimeout(() => {\n          if (!isKeepEditMode.value) {\n            isEdit.value = false;\n          }\n          errorList.value = [];\n          props.onEditableChange?.({\n            ...cellParams.value,\n            value: editValue.value,\n            editedRow: { ...props.row, [props.col.colKey]: editValue.value },\n            validateEdit,\n            isEdit: false,\n          });\n          clearTimeout(timer);\n        }, 0);\n      });\n    };\n\n    const listeners = computed<{ [key: string]: Function }>(() => {\n      const { edit } = col.value;\n      const isCellEditable = props.editable === undefined;\n      if (!isEdit.value || !isCellEditable) return;\n      if (!edit?.abortEditOnEvent?.length) return {};\n      // 自定义退出编辑态的事件\n      const tListeners = {};\n      const outsideAbortEvent = edit?.onEdited;\n      edit.abortEditOnEvent.forEach((itemEvent) => {\n        if (itemEvent === 'onChange') return;\n        tListeners[itemEvent] = (...args: any) => {\n          updateAndSaveAbort(\n            outsideAbortEvent,\n            itemEvent,\n            {\n              ...cellParams.value,\n              trigger: itemEvent,\n              newRowData: currentRow.value,\n            },\n            ...args,\n          );\n        };\n      });\n\n      return tListeners;\n    });\n\n    // 数据输入时触发\n    const onEditChange = (val: any, ...args: any) => {\n      editValue.value = val;\n      const params = {\n        ...cellParams.value,\n        value: val,\n        editedRow: { ...props.row, [props.col.colKey]: val },\n      };\n      editProps.value?.onChange?.(val, ...args);\n      props.onChange?.(params);\n      props.onRuleChange?.(params);\n      editOnListeners.value?.onChange?.(params);\n      const isCellEditable = props.editable === undefined;\n      if (isCellEditable && isAbortEditOnChange.value) {\n        const outsideAbortEvent = col.value.edit?.onEdited;\n        updateAndSaveAbort(\n          outsideAbortEvent,\n          'change',\n          {\n            ...cellParams.value,\n            trigger: 'onChange',\n            newRowData: currentRow.value,\n          },\n          ...args,\n        );\n      }\n      if (col.value.edit?.validateTrigger === 'change') {\n        validateEdit('self');\n      }\n    };\n\n    const documentClickHandler = (e: MouseEvent) => {\n      if (!col.value.edit || !col.value.edit.component) return;\n      if (!isEdit.value) return;\n      // @ts-ignore some browser is also only support e.path\n      const path = e.composedPath?.() || e.path || [];\n      const node = path.find((node: HTMLElement) => node.classList?.contains(`${classPrefix.value}-popup__content`));\n      if (node) return;\n      const outsideAbortEvent = col.value.edit.onEdited;\n      updateAndSaveAbort(outsideAbortEvent, '', {\n        ...cellParams.value,\n        trigger: 'document',\n        newRowData: currentRow.value,\n      });\n    };\n\n    const enterEdit = () => {\n      props.onEditableChange?.({\n        ...cellParams.value,\n        value: editValue.value,\n        editedRow: props.row,\n        isEdit: true,\n        validateEdit,\n      });\n    };\n\n    const onCellClick = (e: MouseEvent) => {\n      isEdit.value = true;\n      enterEdit();\n      e.stopPropagation();\n    };\n\n    onMounted(() => {\n      if (props.col.edit?.defaultEditable) {\n        enterEdit();\n      }\n    });\n\n    const cellValue = computed(() => get(row.value, col.value.colKey));\n\n    watch(\n      cellValue,\n      (cellValue) => {\n        editValue.value = cellValue;\n      },\n      { immediate: true },\n    );\n\n    watch(\n      isEdit,\n      (isEdit) => {\n        const isCellEditable = props.editable === undefined;\n        if (!col.value.edit || !col.value.edit.component || !isCellEditable) return;\n        if (isEdit) {\n          on(document, 'click', documentClickHandler);\n        } else {\n          off(document, 'click', documentClickHandler);\n        }\n      },\n      { immediate: true },\n    );\n\n    watch(\n      () => [props.editable, props.row, props.col, props.rowIndex, props.colIndex],\n      ([editable]: [boolean]) => {\n        // 退出编辑态时，恢复原始值，等待父组件传入新的 data 值\n        if (editable === false) {\n          editValue.value = cellValue.value;\n        } else if (editable === true) {\n          props.onRuleChange?.({\n            ...cellParams.value,\n            value: cellValue.value,\n            editedRow: row.value,\n          });\n        }\n      },\n      { immediate: true },\n    );\n\n    watch(\n      () => props.errors,\n      (errors) => {\n        errorList.value = errors;\n      },\n    );\n\n    return () => {\n      if (props.readonly) {\n        return cellNode.value;\n      }\n      // props.editable = undefined 表示由组件内部控制编辑状态\n      if ((props.editable === undefined && !isEdit.value) || props.editable === false) {\n        return (\n          <div class={props.tableBaseClass.cellEditable} onClick={onCellClick}>\n            {cellNode.value}\n            {col.value.edit?.showEditIcon !== false && <Edit1Icon />}\n          </div>\n        );\n      }\n      const Component = col.value.edit?.component;\n      if (!Component) {\n        log.error('Table', 'edit.component is required.');\n        return null;\n      }\n      const errorMessage = errorList.value?.[0]?.message;\n      const tmpEditOnListeners = { ...editOnListeners.value };\n      delete tmpEditOnListeners.onChange;\n      // remove conflict events\n      if (col.value.edit?.abortEditOnEvent?.length) {\n        col.value.edit.abortEditOnEvent.forEach((onEventName) => {\n          if (tmpEditOnListeners[onEventName]) {\n            delete tmpEditOnListeners[onEventName];\n          }\n        });\n      }\n      return (\n        <div\n          class={props.tableBaseClass.cellEditWrap}\n          onClick={(e: MouseEvent) => {\n            e.stopPropagation();\n          }}\n          ref=\"tableEditableCellRef\"\n        >\n          <Component\n            status={errorMessage ? errorList.value?.[0]?.type || 'error' : undefined}\n            tips={errorMessage}\n            {...componentProps.value}\n            {...listeners.value}\n            {...tmpEditOnListeners}\n            value={editValue.value}\n            onChange={onEditChange}\n          />\n        </div>\n      );\n    };\n  },\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}