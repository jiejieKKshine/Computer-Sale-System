{"ast":null,"code":"/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { getMark, emitEvent } from '../util.mjs';\nimport useTreeAction from './useTreeAction.mjs';\nimport '../../_chunks/dep-fa52aa21.mjs';\nimport '../../_chunks/dep-4659d73b.mjs';\nimport '../../_chunks/dep-03ad9cda.mjs';\nimport '../../_chunks/dep-eca422c3.mjs';\nimport '../../_chunks/dep-7932c2e8.mjs';\nimport '../../_chunks/dep-bf7257e7.mjs';\nimport '../../_chunks/dep-eae2a67e.mjs';\nimport '../../_chunks/dep-626c497d.mjs';\nimport '../../_chunks/dep-ab4bb9b8.mjs';\nimport '../../_chunks/dep-29ef8419.mjs';\nimport '../../_chunks/dep-d8a34055.mjs';\nimport '../../_chunks/dep-2f6e28a0.mjs';\nimport '../../_chunks/dep-5a17bf21.mjs';\nimport '../adapt.mjs';\nimport 'vue';\nimport '../../utils/withInstall.mjs';\nimport '../../hooks/useVModel.mjs';\nimport '../../_chunks/dep-bad871d5.mjs';\nimport '../../hooks/useDefaultValue.mjs';\nimport 'tdesign-icons-vue-next';\nimport '../../checkbox/index.mjs';\nimport '../../checkbox/checkbox.mjs';\nimport '../../_chunks/dep-5efe53d1.mjs';\nimport '../../_chunks/dep-593f2b67.mjs';\nimport '../../_chunks/dep-03a7fb6c.mjs';\nimport '../../checkbox/props.mjs';\nimport '../../hooks/useRipple.mjs';\nimport '../../hooks/useKeepAnimation.mjs';\nimport '../../hooks/useConfig.mjs';\nimport '../../config-provider/useConfig.mjs';\nimport '../../_chunks/dep-06dcbf4c.mjs';\nimport '../../_chunks/dep-2b09875b.mjs';\nimport '../../_chunks/dep-cda4f568.mjs';\nimport '../../_chunks/dep-bb899bfd.mjs';\nimport '../../_chunks/dep-5922c8f3.mjs';\nimport '../../_chunks/dep-92f86d1d.mjs';\nimport '../../_chunks/dep-6ab5363f.mjs';\nimport '../../_chunks/dep-6dc3d0e1.mjs';\nimport '../../_chunks/dep-76958824.mjs';\nimport '../../_chunks/dep-e9841b9e.mjs';\nimport '../../_chunks/dep-1a4bb2f2.mjs';\nimport '../../_chunks/dep-cc8ebcde.mjs';\nimport '../../_chunks/dep-f5579c03.mjs';\nimport '../../_chunks/dep-49aeee3c.mjs';\nimport '../../_chunks/dep-b5bf85f5.mjs';\nimport '../../_chunks/dep-3c65fae8.mjs';\nimport '../../_chunks/dep-ec0bbd9f.mjs';\nimport '../../_chunks/dep-1b78414a.mjs';\nimport '../../_chunks/dep-d84f19b3.mjs';\nimport '../../_chunks/dep-732f0b7d.mjs';\nimport '../../_chunks/dep-1b9718a2.mjs';\nimport '../../_chunks/dep-e065dc25.mjs';\nimport '../../_chunks/dep-400ec705.mjs';\nimport '../../_chunks/dep-02f9394e.mjs';\nimport '../../_chunks/dep-1725b1c7.mjs';\nimport '../../_chunks/dep-532409c5.mjs';\nimport '../../_common/js/global-config/default-config.mjs';\nimport '../../_common/js/global-config/locale/zh_CN.mjs';\nimport '../../_chunks/dep-9ed7da3e.mjs';\nimport '../../_chunks/dep-7f65fc46.mjs';\nimport '../../_chunks/dep-4f2cabb0.mjs';\nimport '../../config-provider/type.mjs';\nimport '../../utils/set-style.mjs';\nimport '../../hooks/tnode.mjs';\nimport '../../utils/render-tnode.mjs';\nimport '../../_chunks/dep-b91a8171.mjs';\nimport '../../checkbox/constants.mjs';\nimport '../../checkbox/hooks/useCheckboxLazyLoad.mjs';\nimport '../../_common/js/utils/observe.mjs';\nimport '../../checkbox/hooks/useKeyboardEvent.mjs';\nimport '../../_common/js/common.mjs';\nimport '../../hooks/useDisabled.mjs';\nimport '../../_chunks/dep-df472119.mjs';\nimport '../../hooks/useReadonly.mjs';\nimport '../../checkbox/group.mjs';\nimport '../../_chunks/dep-4a990ea3.mjs';\nimport '../../_chunks/dep-64c2053b.mjs';\nimport '../../_chunks/dep-4d4e2af1.mjs';\nimport '../../_chunks/dep-3c4e4325.mjs';\nimport '../../_chunks/dep-58a62202.mjs';\nimport '../../checkbox/checkbox-group-props.mjs';\nimport '../../hooks/slot.mjs';\nimport './style/css.mjs';\nimport '../../checkbox/type.mjs';\nimport '../../loading/index.mjs';\nimport '../../_chunks/dep-bff7e93a.mjs';\nimport '../../_chunks/dep-0b414bea.mjs';\nimport '../../_chunks/dep-fbd4eddb.mjs';\nimport '../../_chunks/dep-ae202bc0.mjs';\nimport '../../_chunks/dep-aeaef131.mjs';\nimport '../../_chunks/dep-69e0f6fc.mjs';\nimport '../../_chunks/dep-ea20409b.mjs';\nimport '../../loading/plugin.mjs';\nimport '../../loading/loading.mjs';\nimport '../../loading/icon/gradient.mjs';\nimport '../../_common/js/loading/circle-adapter.mjs';\nimport '../../_common/js/utils/set-style.mjs';\nimport '../../_common/js/utils/helper.mjs';\nimport '../../_chunks/dep-5d3f7c0e.mjs';\nimport '../../_chunks/dep-73384992.mjs';\nimport '../../_chunks/dep-889e457b.mjs';\nimport '../../utils/dom.mjs';\nimport '../../utils/easing.mjs';\nimport '../../loading/props.mjs';\nimport '../../hooks/useTeleport.mjs';\nimport '../../loading/type.mjs';\nimport '../../hooks/useGlobalIcon.mjs';\nimport '../../hooks/useLazyLoad.mjs';\nimport '../../hooks/useVirtualScrollNew.mjs';\nimport '../../hooks/useResizeObserver.mjs';\nimport '../../_chunks/dep-525a54df.mjs';\nimport '../../_chunks/dep-5993931e.mjs';\nimport '../../_chunks/dep-8dfc9324.mjs';\nimport '../../_common/js/tree/tree-node.mjs';\nimport '../../_chunks/dep-0d047dce.mjs';\nimport '../../_chunks/dep-f909a041.mjs';\nimport '../../_chunks/dep-e4a8ef7d.mjs';\nimport '../../_chunks/dep-d2f4e062.mjs';\nimport '../../_common/js/tree/tree-node-model.mjs';\nimport '../../_chunks/dep-88ae49da.mjs';\nimport '../../_chunks/dep-88c8d9ed.mjs';\nimport '../../_chunks/dep-4ec29b23.mjs';\nimport '../../_common/js/log/log.mjs';\nimport '../../_common/js/log/index.mjs';\nfunction useTreeEvents(state) {\n  var treeState = state;\n  var props = treeState.props,\n    context = treeState.context;\n  var _useTreeAction = useTreeAction(state),\n    toggleExpanded = _useTreeAction.toggleExpanded,\n    toggleActived = _useTreeAction.toggleActived,\n    toggleChecked = _useTreeAction.toggleChecked;\n  var handleClick = function handleClick(evtState) {\n    var mouseEvent = evtState.mouseEvent,\n      event = evtState.event,\n      node = evtState.node;\n    if (!node || !mouseEvent) return;\n    treeState.mouseEvent = mouseEvent;\n    var shouldExpand = props.expandOnClickNode;\n    var shouldActive = !props.disabled && !node.disabled && node.isActivable();\n    [\"trigger\", \"ignore\"].forEach(function (markName) {\n      var mark = getMark(markName, event.target, event.currentTarget);\n      var markValue = (mark === null || mark === void 0 ? void 0 : mark.value) || \"\";\n      if (markValue.indexOf(\"expand\") >= 0) {\n        if (markName === \"trigger\") {\n          shouldExpand = true;\n        } else if (markName === \"ignore\") {\n          shouldExpand = false;\n        }\n      }\n      if (markValue.indexOf(\"active\") >= 0) {\n        if (markName === \"ignore\") {\n          shouldActive = false;\n        }\n      }\n    });\n    if (shouldExpand) {\n      toggleExpanded(node);\n    }\n    if (shouldActive) {\n      toggleActived(node);\n    }\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent\n    };\n    emitEvent(props, context, \"click\", evtCtx);\n    treeState.mouseEvent = null;\n  };\n  var handleChange = function handleChange(evtState, ctx) {\n    var disabled = props.disabled;\n    var node = evtState.node;\n    if (!node || disabled || node.disabled || !node.isCheckable()) {\n      return;\n    }\n    toggleChecked(node, ctx);\n  };\n  return {\n    handleChange: handleChange,\n    handleClick: handleClick\n  };\n}\nexport { useTreeEvents as default };","map":{"version":3,"names":["useTreeEvents","state","treeState","props","context","_useTreeAction","useTreeAction","toggleExpanded","toggleActived","toggleChecked","handleClick","evtState","mouseEvent","event","node","shouldExpand","expandOnClickNode","shouldActive","disabled","isActivable","forEach","markName","mark","getMark","target","currentTarget","markValue","value","indexOf","evtCtx","getModel","e","emitEvent","handleChange","ctx","isCheckable"],"sources":["../../../src/tree/hooks/useTreeEvents.ts"],"sourcesContent":["import { TreeProps, TypeTreeState, TypeEventState } from '../tree-types';\nimport { getMark, emitEvent } from '../util';\nimport useTreeAction from './useTreeAction';\n\n// tree 组件一般事件处理\nexport default function useTreeEvents(state: TypeTreeState) {\n  const treeState = state;\n  const { props, context } = treeState;\n  const { toggleExpanded, toggleActived, toggleChecked } = useTreeAction(state);\n\n  const handleClick = (evtState: TypeEventState) => {\n    const { mouseEvent, event, node } = evtState;\n    if (!node || !mouseEvent) return;\n\n    // 用于向内部方法传递事件对象\n    treeState.mouseEvent = mouseEvent;\n\n    let shouldExpand = props.expandOnClickNode;\n    let shouldActive = !props.disabled && !node.disabled && node.isActivable();\n\n    // 给节点添加属性 trigger=\"expand,active\", ignore=\"expand,active\"\n    // 来确认或者屏蔽动作\n    ['trigger', 'ignore'].forEach((markName) => {\n      const mark = getMark(markName, event.target as HTMLElement, event.currentTarget as HTMLElement);\n      const markValue = mark?.value || '';\n      if (markValue.indexOf('expand') >= 0) {\n        // 路径节点包含了 trigger=\"expand\" ignore=\"expand\"\n        if (markName === 'trigger') {\n          shouldExpand = true;\n        } else if (markName === 'ignore') {\n          shouldExpand = false;\n        }\n      }\n      if (markValue.indexOf('active') >= 0) {\n        // 路径节点包含了 trigger=\"active\" ignore=\"active\"\n        if (markName === 'ignore') {\n          shouldActive = false;\n        }\n      }\n    });\n\n    if (shouldExpand) {\n      toggleExpanded(node);\n    }\n\n    if (shouldActive) {\n      toggleActived(node);\n    }\n\n    const evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n    };\n    emitEvent<Parameters<TreeProps['onClick']>>(props, context, 'click', evtCtx);\n\n    treeState.mouseEvent = null;\n  };\n\n  const handleChange = (evtState: TypeEventState, ctx: { e: Event }) => {\n    const { disabled } = props;\n    const { node } = evtState;\n    if (!node || disabled || node.disabled || !node.isCheckable()) {\n      return;\n    }\n    toggleChecked(node, ctx);\n  };\n\n  return {\n    handleChange,\n    handleClick,\n  };\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA,SAAwBA,cAAcC,KAAsB;EAC1D,IAAMC,SAAY,GAAAD,KAAA;EACZ,IAAEE,KAAO,GAAYD,SAAA,CAAnBC,KAAO;IAAAC,OAAA,GAAYF,SAAA,CAAZE,OAAA;EACf,IAAAC,cAAA,GAAyDC,aAAA,CAAcL,KAAK;IAApEM,cAAgB,GAAAF,cAAA,CAAhBE,cAAgB;IAAAC,aAAA,GAAAH,cAAA,CAAAG,aAAA;IAAeC,aAAc,GAAAJ,cAAA,CAAdI,aAAc;EAE/C,IAAAC,WAAA,GAAc,SAAdA,YAAeC,QAA6B;IAChD,IAAQC,UAAA,GAA4BD,QAAA,CAA5BC,UAAA;MAAYC,KAAO,GAASF,QAAA,CAAhBE,KAAO;MAAAC,IAAA,GAASH,QAAA,CAATG,IAAA;IACvB,KAACA,IAAA,IAAQ,CAACF,UAAA,EAAY;IAG1BV,SAAA,CAAUU,UAAa,GAAAA,UAAA;IAEvB,IAAIG,YAAA,GAAeZ,KAAM,CAAAa,iBAAA;IACrB,IAAAC,YAAA,GAAe,CAACd,KAAM,CAAAe,QAAA,IAAY,CAACJ,IAAK,CAAAI,QAAA,IAAYJ,IAAA,CAAKK,WAAY;IAIzE,CAAC,SAAW,UAAQ,CAAE,CAAAC,OAAA,CAAQ,UAACC,QAAa;MAC1C,IAAMC,IAAA,GAAOC,OAAQ,CAAAF,QAAA,EAAUR,KAAM,CAAAW,MAAA,EAAuBX,KAAA,CAAMY,aAA4B;MACxF,IAAAC,SAAA,GAAY,CAAAJ,IAAA,aAAAA,IAAA,uBAAAA,IAAA,CAAMK,KAAS;MACjC,IAAID,SAAU,CAAAE,OAAA,CAAQ,QAAQ,KAAK,CAAG;QAEpC,IAAIP,QAAA,KAAa,SAAW;UACXN,YAAA;QACjB,WAAWM,QAAA,KAAa,QAAU;UACjBN,YAAA;QACjB;MACF;MACA,IAAIW,SAAU,CAAAE,OAAA,CAAQ,QAAQ,KAAK,CAAG;QAEpC,IAAIP,QAAA,KAAa,QAAU;UACVJ,YAAA;QACjB;MACF;IACF,CAAC;IAED,IAAIF,YAAc;MAChBR,cAAA,CAAeO,IAAI;IACrB;IAEA,IAAIG,YAAc;MAChBT,aAAA,CAAcM,IAAI;IACpB;IAEA,IAAMe,MAAS;MACbf,IAAA,EAAMA,IAAA,CAAKgB,QAAS;MACpBC,CAAG,EAAAnB;KACL;IAC4CoB,SAAA,CAAA7B,KAAA,EAAOC,OAAS,WAASyB,MAAM;IAE3E3B,SAAA,CAAUU,UAAa;GACzB;EAEM,IAAAqB,YAAA,GAAe,SAAfA,aAAgBtB,QAAA,EAA0BuB,GAAsB;IAC9D,IAAEhB,QAAA,GAAaf,KAAA,CAAbe,QAAA;IACF,IAAEJ,IAAA,GAASH,QAAA,CAATG,IAAA;IACJ,KAACA,IAAA,IAAQI,QAAY,IAAAJ,IAAA,CAAKI,QAAA,IAAY,CAACJ,IAAA,CAAKqB,WAAA,EAAe;MAC7D;IACF;IACA1B,aAAA,CAAcK,IAAA,EAAMoB,GAAG;GACzB;EAEO;IACLD,YAAA,EAAAA,YAAA;IACAvB,WAAA,EAAAA;GACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}