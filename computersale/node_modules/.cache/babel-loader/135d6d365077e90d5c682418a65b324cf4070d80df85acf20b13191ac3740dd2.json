{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\n/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _defineProperty } from '../../_chunks/dep-fa52aa21.mjs';\nimport { _ as _slicedToArray } from '../../_chunks/dep-5efe53d1.mjs';\nimport { _ as _typeof } from '../../_chunks/dep-4659d73b.mjs';\nimport { ref, toRefs, computed, watch, createVNode, h } from 'vue';\nimport useClassName from './useClassName.mjs';\nimport { Button } from '../../button/index.mjs';\nimport useDefaultValue from '../../hooks/useDefaultValue.mjs';\nimport { useTNodeDefault } from '../../hooks/tnode.mjs';\nimport TableFilterController from '../filter-controller.mjs';\nimport '../../hooks/useConfig.mjs';\nimport { i as isFunction_1 } from '../../_chunks/dep-06dcbf4c.mjs';\nimport { getColumnsResetValue } from '../../_common/js/table/utils.mjs';\nimport { renderTitle } from './useTableHeader.mjs';\nimport { useConfig } from '../../config-provider/useConfig.mjs';\nimport '../../_chunks/dep-593f2b67.mjs';\nimport '../../_chunks/dep-eca422c3.mjs';\nimport '../../_chunks/dep-bf7257e7.mjs';\nimport '../../_chunks/dep-2b09875b.mjs';\nimport '../../_chunks/dep-cda4f568.mjs';\nimport '../../_chunks/dep-bb899bfd.mjs';\nimport '../../_chunks/dep-5922c8f3.mjs';\nimport '../../_chunks/dep-92f86d1d.mjs';\nimport '../../_chunks/dep-6ab5363f.mjs';\nimport '../../_chunks/dep-6dc3d0e1.mjs';\nimport '../../_chunks/dep-76958824.mjs';\nimport '../../_chunks/dep-e9841b9e.mjs';\nimport '../../_chunks/dep-1a4bb2f2.mjs';\nimport '../../_chunks/dep-cc8ebcde.mjs';\nimport '../../_chunks/dep-29ef8419.mjs';\nimport '../../_chunks/dep-f5579c03.mjs';\nimport '../../_chunks/dep-49aeee3c.mjs';\nimport '../../_chunks/dep-b5bf85f5.mjs';\nimport '../../_chunks/dep-3c65fae8.mjs';\nimport '../../_chunks/dep-eae2a67e.mjs';\nimport '../../_chunks/dep-626c497d.mjs';\nimport '../../_chunks/dep-ec0bbd9f.mjs';\nimport '../../_chunks/dep-1b78414a.mjs';\nimport '../../_chunks/dep-d84f19b3.mjs';\nimport '../../_chunks/dep-732f0b7d.mjs';\nimport '../../_chunks/dep-03a7fb6c.mjs';\nimport '../../_chunks/dep-1b9718a2.mjs';\nimport '../../_chunks/dep-e065dc25.mjs';\nimport '../../_chunks/dep-400ec705.mjs';\nimport '../../_chunks/dep-02f9394e.mjs';\nimport '../../_chunks/dep-1725b1c7.mjs';\nimport '../../_chunks/dep-532409c5.mjs';\nimport '../../_common/js/global-config/default-config.mjs';\nimport '../../_common/js/global-config/locale/zh_CN.mjs';\nimport '../../_chunks/dep-9ed7da3e.mjs';\nimport '../../_chunks/dep-7f65fc46.mjs';\nimport '../../_chunks/dep-4f2cabb0.mjs';\nimport '../../config-provider/type.mjs';\nimport '../../button/button.mjs';\nimport '../../_chunks/dep-4a990ea3.mjs';\nimport '../../loading/index.mjs';\nimport '../../_chunks/dep-bff7e93a.mjs';\nimport '../../_chunks/dep-0b414bea.mjs';\nimport '../../_chunks/dep-4d4e2af1.mjs';\nimport '../../_chunks/dep-fbd4eddb.mjs';\nimport '../../_chunks/dep-ae202bc0.mjs';\nimport '../../_chunks/dep-aeaef131.mjs';\nimport '../../_chunks/dep-ab4bb9b8.mjs';\nimport '../../_chunks/dep-7932c2e8.mjs';\nimport '../../_chunks/dep-69e0f6fc.mjs';\nimport '../../_chunks/dep-ea20409b.mjs';\nimport '../../loading/plugin.mjs';\nimport '../../loading/loading.mjs';\nimport '../../loading/icon/gradient.mjs';\nimport '../../_common/js/loading/circle-adapter.mjs';\nimport '../../_common/js/utils/set-style.mjs';\nimport '../../_common/js/utils/helper.mjs';\nimport '../../_chunks/dep-5d3f7c0e.mjs';\nimport '../../_chunks/dep-73384992.mjs';\nimport '../../_chunks/dep-58a62202.mjs';\nimport '../../_chunks/dep-889e457b.mjs';\nimport '../../utils/dom.mjs';\nimport '../../utils/easing.mjs';\nimport '../../utils/render-tnode.mjs';\nimport '../../_chunks/dep-b91a8171.mjs';\nimport '../../_chunks/dep-03ad9cda.mjs';\nimport '../../_chunks/dep-d8a34055.mjs';\nimport '../../_chunks/dep-2f6e28a0.mjs';\nimport '../../_chunks/dep-5a17bf21.mjs';\nimport '../../_chunks/dep-bad871d5.mjs';\nimport '../../loading/props.mjs';\nimport '../../hooks/useTeleport.mjs';\nimport '../../utils/withInstall.mjs';\nimport './style/css.mjs';\nimport '../../loading/type.mjs';\nimport '../../button/props.mjs';\nimport '../../hooks/useRipple.mjs';\nimport '../../hooks/useKeepAnimation.mjs';\nimport '../../utils/set-style.mjs';\nimport '../../hooks/useDisabled.mjs';\nimport '../../_chunks/dep-df472119.mjs';\nimport '../../button/type.mjs';\nimport 'tdesign-icons-vue-next';\nimport '../../popup/index.mjs';\nimport '../../popup/popup.mjs';\nimport '@popperjs/core';\nimport '../../_chunks/dep-5993931e.mjs';\nimport '../../_chunks/dep-8dfc9324.mjs';\nimport '../../hooks/index.mjs';\nimport '../../hooks/icon.mjs';\nimport '../../hooks/slot.mjs';\nimport '../../hooks/useCommonClassName.mjs';\nimport '../../hooks/useDestroyOnClose.mjs';\nimport '../../hooks/useVirtualScroll.mjs';\nimport '../../hooks/useVModel.mjs';\nimport '../../hooks/useImagePreviewUrl.mjs';\nimport '../../_common/js/upload/utils.mjs';\nimport '../../_common/js/log/log.mjs';\nimport '../../popup/container.mjs';\nimport '../../popup/props.mjs';\nimport '../../hooks/useResizeObserver.mjs';\nimport '../../popup/type.mjs';\nimport '../../checkbox/index.mjs';\nimport '../../checkbox/checkbox.mjs';\nimport '../../checkbox/props.mjs';\nimport '../../checkbox/constants.mjs';\nimport '../../checkbox/hooks/useCheckboxLazyLoad.mjs';\nimport '../../_common/js/utils/observe.mjs';\nimport '../../checkbox/hooks/useKeyboardEvent.mjs';\nimport '../../_common/js/common.mjs';\nimport '../../hooks/useReadonly.mjs';\nimport '../../checkbox/group.mjs';\nimport '../../_chunks/dep-64c2053b.mjs';\nimport '../../_chunks/dep-3c4e4325.mjs';\nimport '../../checkbox/checkbox-group-props.mjs';\nimport '../../checkbox/type.mjs';\nimport '../../radio/index.mjs';\nimport '../../radio/radio.mjs';\nimport '../../utils/helper.mjs';\nimport '../../radio/props.mjs';\nimport '../../radio/constants.mjs';\nimport '../../radio/group.mjs';\nimport '../../_chunks/dep-0d047dce.mjs';\nimport '../../_chunks/dep-d2f4e062.mjs';\nimport '../../_chunks/dep-525a54df.mjs';\nimport '../../radio/radio-group-props.mjs';\nimport '../../radio/useKeyboard.mjs';\nimport '../../watermark/hooks.mjs';\nimport '../../radio/radio-button.mjs';\nimport '../../radio/type.mjs';\nimport '../../input/index.mjs';\nimport '../../input/input.mjs';\nimport '../../input/props.mjs';\nimport '../../hooks/useGlobalIcon.mjs';\nimport '../../input/useInput.mjs';\nimport '../../form/const.mjs';\nimport '../../input/useLengthLimit.mjs';\nimport '../../_common/js/log/index.mjs';\nimport '../../input/useInputEventHandler.mjs';\nimport '../../input/useInputWidth.mjs';\nimport '../../input/input-group.mjs';\nimport '../../input/input-group-props.mjs';\nimport '../../input/type.mjs';\nimport './useMultiHeader.mjs';\nimport '../ellipsis.mjs';\nimport '../../tooltip/index.mjs';\nimport '../../tooltip/tooltip.mjs';\nimport '../../_chunks/dep-88ae49da.mjs';\nimport '../../_chunks/dep-88c8d9ed.mjs';\nimport '../../_chunks/dep-4ec29b23.mjs';\nimport '../../tooltip/props.mjs';\nimport '../../tooltip/util.mjs';\nimport '../../tooltip/type.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nfunction isFilterValueExist(value) {\n  var isArrayTrue = value instanceof Array && value.length;\n  var isObject = _typeof(value) === \"object\" && !(value instanceof Array);\n  var isObjectTrue = isObject && Object.keys(value).length;\n  return isArrayTrue || isObjectTrue || ![\"null\", \"\", \"undefined\"].includes(String(value));\n}\nfunction filterEmptyData(data) {\n  var newFilterValue = {};\n  Object.keys(data).forEach(function (key) {\n    var item = data[key];\n    if (isFilterValueExist(item)) {\n      newFilterValue[key] = item;\n    }\n  });\n  return newFilterValue;\n}\nfunction useFilter(props, context) {\n  var primaryTableRef = ref(null);\n  var _useConfig = useConfig(\"table\", props.locale),\n    t = _useConfig.t,\n    globalConfig = _useConfig.globalConfig;\n  var renderTNode = useTNodeDefault();\n  var _toRefs = toRefs(props),\n    filterValue = _toRefs.filterValue,\n    columns = _toRefs.columns;\n  var _useClassName = useClassName(),\n    tableFilterClasses = _useClassName.tableFilterClasses,\n    isFocusClass = _useClassName.isFocusClass;\n  var isTableOverflowHidden = ref();\n  var _useDefaultValue = useDefaultValue(filterValue, props.defaultFilterValue, props.onFilterChange, \"filterValue\"),\n    _useDefaultValue2 = _slicedToArray(_useDefaultValue, 2),\n    tFilterValue = _useDefaultValue2[0],\n    setTFilterValue = _useDefaultValue2[1];\n  var innerFilterValue = ref(tFilterValue.value);\n  var hasEmptyCondition = computed(function () {\n    var filterEmpty = filterEmptyData(tFilterValue.value || {});\n    return !tFilterValue.value || !Object.keys(filterEmpty).length;\n  });\n  watch([tFilterValue], function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 1),\n      val = _ref2[0];\n    innerFilterValue.value = val;\n  });\n  function renderFirstFilterRow() {\n    var _props$pagination, _props$data;\n    if (hasEmptyCondition.value) return null;\n    var defaultNode = createVNode(\"div\", {\n      \"class\": tableFilterClasses.result\n    }, [createVNode(\"span\", null, [t(globalConfig.value.searchResultText, {\n      result: getFilterResultContent(),\n      count: ((_props$pagination = props.pagination) === null || _props$pagination === void 0 ? void 0 : _props$pagination.total) || ((_props$data = props.data) === null || _props$data === void 0 ? void 0 : _props$data.length)\n    })]), createVNode(Button, {\n      \"theme\": \"primary\",\n      \"variant\": \"text\",\n      \"onClick\": onResetAll\n    }, {\n      \"default\": function _default() {\n        return [globalConfig.value.clearFilterResultButtonText];\n      }\n    })]);\n    var filterContent = renderTNode(\"filterRow\");\n    if (props.filterRow && !filterContent || props.filterRow === null) return null;\n    return createVNode(\"div\", {\n      \"class\": tableFilterClasses.inner\n    }, [filterContent || defaultNode]);\n  }\n  function getFilterResultContent() {\n    var arr = [];\n    var columns2 = [];\n    getAllColumns(props.columns, columns2);\n    columns2.filter(function (col) {\n      return col.filter;\n    }).forEach(function (col, index) {\n      var value = tFilterValue.value[col.colKey];\n      if (col.filter.list && ![\"null\"].includes(String(value))) {\n        var formattedValue = value instanceof Array ? value : [value];\n        var label = [];\n        col.filter.list.forEach(function (option) {\n          if (formattedValue.includes(option.value)) {\n            label.push(option.label);\n          }\n        });\n        value = label.join();\n      }\n      if (isFilterValueExist(value)) {\n        var _col$filter, _col$filter2;\n        var _label = isFunction_1((_col$filter = col.filter) === null || _col$filter === void 0 ? void 0 : _col$filter.label) ? col.filter.label(h) : (_col$filter2 = col.filter) === null || _col$filter2 === void 0 ? void 0 : _col$filter2.label;\n        var title = renderTitle(context.slots, col, index);\n        arr.push(\"\".concat(_label || title, \"\\uFF1A\").concat(value));\n      }\n    });\n    return arr.join(\"\\uFF1B\");\n  }\n  function getAllColumns(col, columns2) {\n    col.forEach(function (column) {\n      if (column.children) {\n        getAllColumns(column.children, columns2);\n      }\n      columns2.push(column);\n    });\n  }\n  function onInnerFilterChange(val, column) {\n    var filterValue2 = _objectSpread(_objectSpread({}, innerFilterValue.value), {}, _defineProperty({}, column.colKey, val));\n    innerFilterValue.value = filterValue2;\n    if (!column.filter.showConfirmAndReset) {\n      emitFilterChange(filterValue2, \"filter-change\", column);\n    }\n  }\n  function emitFilterChange(filterValue2, trigger, column) {\n    var _props$onChange;\n    setTFilterValue(filterValue2, {\n      col: column,\n      trigger: trigger\n    });\n    (_props$onChange = props.onChange) === null || _props$onChange === void 0 || _props$onChange.call(props, {\n      filter: filterValue2\n    }, {\n      trigger: \"filter\"\n    });\n  }\n  function onReset(column) {\n    var _ref3, _column$filter$resetV;\n    var filterValue2 = _objectSpread(_objectSpread({}, tFilterValue.value), {}, _defineProperty({}, column.colKey, (_ref3 = (_column$filter$resetV = column.filter.resetValue) !== null && _column$filter$resetV !== void 0 ? _column$filter$resetV : {\n      single: \"\",\n      multiple: [],\n      input: \"\"\n    }[column.filter.type]) !== null && _ref3 !== void 0 ? _ref3 : \"\"));\n    emitFilterChange(filterValue2, \"reset\", column);\n  }\n  function onResetAll() {\n    var resetValue = getColumnsResetValue(columns.value);\n    emitFilterChange(resetValue, \"clear\", void 0);\n  }\n  function onConfirm(column) {\n    emitFilterChange(innerFilterValue.value, \"confirm\", column);\n  }\n  function renderFilterIcon(_ref4) {\n    var _primaryTableRef$valu;\n    var col = _ref4.col,\n      colIndex = _ref4.colIndex;\n    return createVNode(TableFilterController, {\n      \"column\": col,\n      \"colIndex\": colIndex,\n      \"filterIcon\": props.filterIcon,\n      \"tFilterValue\": tFilterValue.value,\n      \"innerFilterValue\": innerFilterValue.value,\n      \"tableFilterClasses\": tableFilterClasses,\n      \"isFocusClass\": isFocusClass,\n      \"popupProps\": col.filter.popupProps,\n      \"attach\": props.attach,\n      \"locale\": props.locale,\n      \"onReset\": onReset,\n      \"onConfirm\": onConfirm,\n      \"onInnerFilterChange\": onInnerFilterChange,\n      \"primaryTableElement\": (_primaryTableRef$valu = primaryTableRef.value) === null || _primaryTableRef$valu === void 0 ? void 0 : _primaryTableRef$valu.$el,\n      \"onVisibleChange\": onPopupVisibleChange\n    }, {\n      filterIcon: context.slots.filterIcon\n    });\n  }\n  function setFilterPrimaryTableRef(primaryTableElement) {\n    primaryTableRef.value = primaryTableElement;\n  }\n  function onPopupVisibleChange(visible) {\n    if (visible && !isTableOverflowHidden.value) {\n      isTableOverflowHidden.value = !visible;\n    }\n  }\n  return {\n    hasEmptyCondition: hasEmptyCondition,\n    isTableOverflowHidden: isTableOverflowHidden,\n    renderFilterIcon: renderFilterIcon,\n    renderFirstFilterRow: renderFirstFilterRow,\n    setFilterPrimaryTableRef: setFilterPrimaryTableRef\n  };\n}\nexport { useFilter as default };","map":{"version":3,"names":["isFilterValueExist","value","isArrayTrue","Array","length","isObject","_typeof","isObjectTrue","Object","keys","includes","String","filterEmptyData","data","newFilterValue","forEach","key","item","useFilter","props","context","primaryTableRef","ref","_useConfig","useConfig","locale","t","globalConfig","renderTNode","useTNodeDefault","_toRefs","toRefs","filterValue","columns","_useClassName","useClassName","tableFilterClasses","isFocusClass","isTableOverflowHidden","_useDefaultValue","useDefaultValue","defaultFilterValue","onFilterChange","_useDefaultValue2","_slicedToArray","tFilterValue","setTFilterValue","innerFilterValue","hasEmptyCondition","computed","filterEmpty","watch","_ref","_ref2","val","renderFirstFilterRow","_props$pagination","_props$data","defaultNode","createVNode","result","searchResultText","getFilterResultContent","count","pagination","total","Button","onResetAll","_default","clearFilterResultButtonText","filterContent","filterRow","inner","arr","columns2","getAllColumns","filter","col","index","colKey","list","formattedValue","label","option","push","join","_col$filter","_col$filter2","_label","isFunction_1","h","title","renderTitle","slots","concat","column","children","onInnerFilterChange","filterValue2","_objectSpread","_defineProperty","showConfirmAndReset","emitFilterChange","trigger","_props$onChange","onChange","call","onReset","_ref3","_column$filter$resetV","resetValue","single","multiple","input","type","getColumnsResetValue","onConfirm","renderFilterIcon","_ref4","_primaryTableRef$valu","colIndex","TableFilterController","filterIcon","popupProps","attach","$el","onPopupVisibleChange","setFilterPrimaryTableRef","primaryTableElement","visible"],"sources":["../../../src/table/hooks/useFilter.tsx"],"sourcesContent":["import { toRefs, ref, watch, computed, SetupContext, h } from 'vue';\nimport useClassName from './useClassName';\nimport TButton from '../../button';\nimport { TdPrimaryTableProps, PrimaryTableCol, TableRowData, FilterValue, TableFilterChangeContext } from '../type';\nimport useDefaultValue from '../../hooks/useDefaultValue';\nimport { useTNodeDefault } from '../../hooks/tnode';\nimport TableFilterController from '../filter-controller';\nimport { useConfig } from '../../hooks/useConfig';\nimport isFunction from 'lodash/isFunction';\nimport { getColumnsResetValue } from '../../_common/js/table/utils';\nimport { renderTitle } from './useTableHeader';\n\nfunction isFilterValueExist(value: any) {\n  const isArrayTrue = value instanceof Array && value.length;\n  const isObject = typeof value === 'object' && !(value instanceof Array);\n  const isObjectTrue = isObject && Object.keys(value).length;\n  return isArrayTrue || isObjectTrue || !['null', '', 'undefined'].includes(String(value));\n}\n\n// 筛选条件不为空，才需要显示筛选结果行\nfunction filterEmptyData(data: FilterValue) {\n  const newFilterValue: FilterValue = {};\n  Object.keys(data).forEach((key) => {\n    const item = data[key];\n    if (isFilterValueExist(item)) {\n      newFilterValue[key] = item;\n    }\n  });\n  return newFilterValue;\n}\n\nexport default function useFilter(props: TdPrimaryTableProps, context: SetupContext) {\n  const primaryTableRef = ref(null);\n  const { t, globalConfig } = useConfig('table', props.locale);\n  const renderTNode = useTNodeDefault();\n  const { filterValue, columns } = toRefs(props);\n  const { tableFilterClasses, isFocusClass } = useClassName();\n  const isTableOverflowHidden = ref<boolean>();\n\n  // unControl and control\n  const [tFilterValue, setTFilterValue] = useDefaultValue(\n    filterValue,\n    props.defaultFilterValue,\n    props.onFilterChange,\n    'filterValue',\n  );\n\n  // 过滤内部值\n  const innerFilterValue = ref<FilterValue>(tFilterValue.value);\n\n  const hasEmptyCondition = computed(() => {\n    const filterEmpty = filterEmptyData(tFilterValue.value || {});\n    return !tFilterValue.value || !Object.keys(filterEmpty).length;\n  });\n\n  watch([tFilterValue], ([val]) => {\n    innerFilterValue.value = val;\n  });\n\n  function renderFirstFilterRow() {\n    if (hasEmptyCondition.value) return null;\n    const defaultNode = (\n      <div class={tableFilterClasses.result}>\n        <span>\n          {/* 搜索 “{getFilterResultContent()}”， */}\n          {/* 找到 {props.pagination?.total || props.data?.length} 条结果 */}\n          {t(globalConfig.value.searchResultText, {\n            result: getFilterResultContent(),\n            count: props.pagination?.total || props.data?.length,\n          })}\n        </span>\n        <TButton theme=\"primary\" variant=\"text\" onClick={onResetAll}>\n          {globalConfig.value.clearFilterResultButtonText}\n        </TButton>\n      </div>\n    );\n    const filterContent = renderTNode('filterRow');\n    if ((props.filterRow && !filterContent) || props.filterRow === null) return null;\n    return <div class={tableFilterClasses.inner}>{filterContent || defaultNode}</div>;\n  }\n\n  // 获取搜索条件内容，存在 options 需要获取其 label 显示\n  function getFilterResultContent(): string {\n    const arr: string[] = [];\n    const columns: Array<PrimaryTableCol> = [];\n    getAllColumns(props.columns, columns);\n    columns\n      .filter((col) => col.filter)\n      .forEach((col, index) => {\n        let value = tFilterValue.value[col.colKey];\n        if (col.filter.list && !['null'].includes(String(value))) {\n          const formattedValue = value instanceof Array ? value : [value];\n          const label: string[] = [];\n          col.filter.list.forEach((option) => {\n            if (formattedValue.includes(option.value)) {\n              label.push(option.label);\n            }\n          });\n          value = label.join();\n        }\n        if (isFilterValueExist(value)) {\n          const label = isFunction(col.filter?.label) ? col.filter.label(h) : col.filter?.label;\n          const title = renderTitle(context.slots, col, index);\n          arr.push(`${label || title}：${value}`);\n        }\n      });\n    return arr.join('；');\n  }\n  //递归拿到所有的 column\n  function getAllColumns(col: Array<PrimaryTableCol>, columns: Array<PrimaryTableCol>) {\n    col.forEach((column) => {\n      if (column.children) {\n        getAllColumns(column.children, columns);\n      }\n      columns.push(column);\n    });\n  }\n\n  function onInnerFilterChange(val: any, column: PrimaryTableCol) {\n    const filterValue = {\n      ...innerFilterValue.value,\n      [column.colKey]: val,\n    };\n    innerFilterValue.value = filterValue;\n    if (!column.filter.showConfirmAndReset) {\n      emitFilterChange(filterValue, 'filter-change', column);\n    }\n  }\n\n  function emitFilterChange(\n    filterValue: FilterValue,\n    trigger: TableFilterChangeContext<TableRowData>['trigger'],\n    column?: PrimaryTableCol,\n  ) {\n    setTFilterValue(filterValue, { col: column, trigger });\n    props.onChange?.({ filter: filterValue }, { trigger: 'filter' });\n  }\n\n  function onReset(column: PrimaryTableCol) {\n    const filterValue: FilterValue = {\n      ...tFilterValue.value,\n      [column.colKey]:\n        column.filter.resetValue ??\n        {\n          single: '',\n          multiple: [],\n          input: '',\n        }[column.filter.type] ??\n        '',\n    };\n    emitFilterChange(filterValue, 'reset', column);\n  }\n\n  function onResetAll() {\n    const resetValue = getColumnsResetValue(columns.value);\n    emitFilterChange(resetValue, 'clear', undefined);\n  }\n\n  function onConfirm(column: PrimaryTableCol) {\n    emitFilterChange(innerFilterValue.value, 'confirm', column);\n  }\n\n  // 图标：内置图标，组件自定义图标，全局配置图标\n  function renderFilterIcon({ col, colIndex }: { col: PrimaryTableCol<TableRowData>; colIndex: number }) {\n    return (\n      <TableFilterController\n        v-slots={{ filterIcon: context.slots.filterIcon }}\n        column={col}\n        colIndex={colIndex}\n        filterIcon={props.filterIcon}\n        tFilterValue={tFilterValue.value}\n        innerFilterValue={innerFilterValue.value}\n        tableFilterClasses={tableFilterClasses}\n        isFocusClass={isFocusClass}\n        popupProps={col.filter.popupProps}\n        attach={props.attach}\n        locale={props.locale}\n        onReset={onReset}\n        onConfirm={onConfirm}\n        onInnerFilterChange={onInnerFilterChange}\n        primaryTableElement={primaryTableRef.value?.$el}\n        onVisibleChange={onPopupVisibleChange}\n      ></TableFilterController>\n    );\n  }\n\n  function setFilterPrimaryTableRef(primaryTableElement: any) {\n    primaryTableRef.value = primaryTableElement;\n  }\n\n  function onPopupVisibleChange(visible: boolean) {\n    if (visible && !isTableOverflowHidden.value) {\n      isTableOverflowHidden.value = !visible;\n    }\n  }\n\n  return {\n    hasEmptyCondition,\n    isTableOverflowHidden,\n    renderFilterIcon,\n    renderFirstFilterRow,\n    setFilterPrimaryTableRef,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}