{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\n/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _classCallCheck, a as _createClass } from '../../../_chunks/dep-f909a041.mjs';\nimport { _ as _defineProperty } from '../../../_chunks/dep-fa52aa21.mjs';\nimport '../../../_chunks/dep-4659d73b.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nfunction _classPrivateMethodInitSpec(e, a) {\n  _checkPrivateRedeclaration(e, a), a.add(e);\n}\nfunction _checkPrivateRedeclaration(e, t) {\n  if (t.has(e)) throw new TypeError(\"Cannot initialize the same private elements twice on an object\");\n}\nfunction _assertClassBrand(e, t, n) {\n  if (\"function\" == typeof e ? e === t : e.has(t)) return arguments.length < 3 ? t : n;\n  throw new TypeError(\"Private element is not present on this object\");\n}\nvar defaultsOptions = {\n  start: function start(coordinate, event) {},\n  drag: function drag(coordinate, event) {},\n  end: function end(coordinate, event) {}\n};\nvar _Draggable_brand = /*#__PURE__*/new WeakSet();\nvar Draggable = /*#__PURE__*/function () {\n  function Draggable(el, options) {\n    _classCallCheck(this, Draggable);\n    _classPrivateMethodInitSpec(this, _Draggable_brand);\n    _defineProperty(this, \"dragging\", false);\n    _defineProperty(this, \"$el\", void 0);\n    _defineProperty(this, \"props\", void 0);\n    _defineProperty(this, \"handles\", void 0);\n    this.$el = el;\n    this.props = _objectSpread(_objectSpread({}, defaultsOptions), options);\n    this.handles = {\n      start: _assertClassBrand(_Draggable_brand, this, _dragStart).bind(this),\n      drag: _assertClassBrand(_Draggable_brand, this, _drag).bind(this),\n      end: _assertClassBrand(_Draggable_brand, this, _dragEnd).bind(this)\n    };\n    this.$el.addEventListener(\"mousedown\", this.handles.start, false);\n  }\n  return _createClass(Draggable, [{\n    key: \"destroy\",\n    value: function destroy() {\n      this.$el.removeEventListener(\"mousedown\", this.handles.start, false);\n      window.removeEventListener(\"mousemove\", this.handles.drag, false);\n      window.removeEventListener(\"mouseup\", this.handles.end, false);\n      window.removeEventListener(\"contextmenu\", this.handles.end, false);\n    }\n  }]);\n}();\nfunction _dragStart(event) {\n  if (this.dragging) {\n    return;\n  }\n  window.addEventListener(\"mousemove\", this.handles.drag, false);\n  window.addEventListener(\"mouseup\", this.handles.end, false);\n  window.addEventListener(\"contextmenu\", this.handles.end, false);\n  this.dragging = true;\n  this.props.start(_assertClassBrand(_Draggable_brand, this, _getCoordinate).call(this, event), event);\n}\nfunction _drag(event) {\n  if (!this.dragging) {\n    return;\n  }\n  this.props.drag(_assertClassBrand(_Draggable_brand, this, _getCoordinate).call(this, event), event);\n}\nfunction _dragEnd(event) {\n  var _this = this;\n  setTimeout(function () {\n    _this.dragging = false;\n    _this.props.end(_assertClassBrand(_Draggable_brand, _this, _getCoordinate).call(_this, event), event);\n  }, 0);\n  window.removeEventListener(\"mousemove\", this.handles.drag, false);\n  window.removeEventListener(\"mouseup\", this.handles.end, false);\n  window.removeEventListener(\"contextmenu\", this.handles.end, false);\n}\nfunction _getCoordinate(event) {\n  var rect = this.$el.getBoundingClientRect();\n  var mouseEvent = event;\n  var left = mouseEvent.clientX - rect.left;\n  var top = mouseEvent.clientY - rect.top;\n  return {\n    y: Math.min(Math.max(0, top), rect.height),\n    x: Math.min(Math.max(0, left), rect.width)\n  };\n}\nexport { Draggable, Draggable as default };","map":{"version":3,"names":["defaultsOptions","start","coordinate","event","drag","end","_Draggable_brand","WeakSet","Draggable","el","options","_classCallCheck","_classPrivateMethodInitSpec","_defineProperty","$el","props","_objectSpread","handles","_assertClassBrand","_dragStart","bind","_drag","_dragEnd","addEventListener","_createClass","key","value","destroy","removeEventListener","window","dragging","_getCoordinate","call","_this","setTimeout","rect","getBoundingClientRect","mouseEvent","left","clientX","top","clientY","y","Math","min","max","height","x","width"],"sources":["../../../../src/_common/js/color-picker/draggable.ts"],"sourcesContent":["/* eslint-disable no-use-before-define */\nexport interface Coordinate {\n  x: number;\n  y: number;\n}\n\nexport type DraggableEvent = MouseEvent;\n\ninterface DraggableCallback {\n  (coordinate: Coordinate, event?: DraggableEvent): void;\n}\n\nexport interface DraggableProps {\n  start?: DraggableCallback;\n  drag?: DraggableCallback;\n  end?: DraggableCallback;\n}\n\ninterface DraggableHandles {\n  start: (this: Draggable, event: DraggableEvent) => {};\n  drag: (this: Draggable, event: DraggableEvent) => {};\n  end: (this: Draggable, event: DraggableEvent) => {};\n}\n\n// 配置项\nconst defaultsOptions: DraggableProps = {\n  start: (coordinate: Coordinate, event: DraggableEvent) => {},\n  drag: (coordinate: Coordinate, event: DraggableEvent) => {},\n  end: (coordinate: Coordinate, event: DraggableEvent) => {},\n};\n\nexport class Draggable {\n  private dragging = false;\n\n  private $el: HTMLElement;\n\n  private props: DraggableProps;\n\n  private handles: DraggableHandles;\n\n  constructor(el: HTMLElement, options?: DraggableProps) {\n    this.$el = el;\n    this.props = { ...defaultsOptions, ...options };\n    this.handles = {\n      start: this.#dragStart.bind(this),\n      drag: this.#drag.bind(this),\n      end: this.#dragEnd.bind(this),\n    };\n    this.$el.addEventListener('mousedown', this.handles.start, false);\n  }\n\n  #dragStart(event: DraggableEvent) {\n    if (this.dragging) {\n      return;\n    }\n    // event.preventDefault();\n    window.addEventListener('mousemove', this.handles.drag, false);\n    window.addEventListener('mouseup', this.handles.end, false);\n    window.addEventListener('contextmenu', this.handles.end, false);\n    this.dragging = true;\n    this.props.start(this.#getCoordinate(event), event);\n  }\n\n  #drag(event: DraggableEvent) {\n    if (!this.dragging) {\n      return;\n    }\n    this.props.drag(this.#getCoordinate(event), event);\n  }\n\n  #dragEnd(event: DraggableEvent) {\n    setTimeout(() => {\n      this.dragging = false;\n      this.props.end(this.#getCoordinate(event), event);\n    }, 0);\n    window.removeEventListener('mousemove', this.handles.drag, false);\n    window.removeEventListener('mouseup', this.handles.end, false);\n    window.removeEventListener('contextmenu', this.handles.end, false);\n  }\n\n  #getCoordinate(event: DraggableEvent) {\n    const rect = this.$el.getBoundingClientRect();\n    const mouseEvent = event;\n    const left = mouseEvent.clientX - rect.left;\n    const top = mouseEvent.clientY - rect.top;\n    return {\n      y: Math.min(Math.max(0, top), rect.height),\n      x: Math.min(Math.max(0, left), rect.width),\n    };\n  }\n\n  destroy() {\n    this.$el.removeEventListener('mousedown', this.handles.start, false);\n    window.removeEventListener('mousemove', this.handles.drag, false);\n    window.removeEventListener('mouseup', this.handles.end, false);\n    window.removeEventListener('contextmenu', this.handles.end, false);\n  }\n}\n\nexport default Draggable;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}