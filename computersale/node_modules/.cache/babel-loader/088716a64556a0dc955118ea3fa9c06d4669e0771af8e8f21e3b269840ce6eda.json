{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.some.js\";\n/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _classCallCheck, a as _createClass } from '../_chunks/dep-f909a041.mjs';\nimport { _ as _defineProperty } from '../_chunks/dep-fa52aa21.mjs';\nimport { _ as _toConsumableArray } from '../_chunks/dep-4a990ea3.mjs';\nimport { ref } from 'vue';\nimport '../_chunks/dep-4659d73b.mjs';\nimport '../_chunks/dep-593f2b67.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nvar _getTreePaths = function getTreePaths(node, val, ans) {\n  if (!node) return;\n  for (var i = 0; i < node.children.length; ++i) {\n    var child = node.children[i];\n    if (child.value === val) return [].concat(_toConsumableArray(ans), [node.value]);\n    var target = _getTreePaths(child, val, [].concat(_toConsumableArray(ans), [node.value]));\n    if (target) return target;\n  }\n};\nvar _getTreeSameParentNodes = function getTreeSameParentNodes(node, val) {\n  if (!node) return [];\n  for (var i = 0; i < node.children.length; ++i) {\n    var child = node.children[i];\n    if (child.value === val) return node.children;\n    var target = _getTreeSameParentNodes(child, val);\n    if (target) return target;\n  }\n};\nvar _DFS = function DFS(root, val) {\n  if (root.value === val) return root;\n  if (root.children.length > 0) {\n    for (var i = 0, len = root.children.length; i < len; i++) {\n      var res = _DFS(root.children[i], val);\n      if (res) return res;\n    }\n  }\n};\nvar VMenu = /*#__PURE__*/function () {\n  function VMenu(options) {\n    _classCallCheck(this, VMenu);\n    _defineProperty(this, \"data\", null);\n    _defineProperty(this, \"cache\", /* @__PURE__ */new Set());\n    _defineProperty(this, \"isMutex\", ref(false));\n    _defineProperty(this, \"expandValues\", null);\n    var root = {\n      value: null,\n      parent: null,\n      children: []\n    };\n    this.data = root;\n    this.isMutex = options === null || options === void 0 ? void 0 : options.isMutex;\n    this.expandValues = new Set(options === null || options === void 0 ? void 0 : options.expandValues);\n  }\n  return _createClass(VMenu, [{\n    key: \"add\",\n    value: function add(item) {\n      var value = item.value,\n        parent = item.parent,\n        vnode = item.vnode;\n      var node = _objectSpread({\n        value: value,\n        parent: parent,\n        children: [],\n        vnode: vnode\n      }, item);\n      this.cache.forEach(function (data, v2, set) {\n        if (item.value === data.parent) {\n          node.children.push(data);\n          set[\"delete\"](data);\n        }\n      });\n      if (item.parent == null) {\n        this.data.children.push(node);\n        node.parent = this.data;\n      } else if (this.data.children.length > 0) {\n        var pNode = _DFS(this.data, parent);\n        if (pNode && !pNode.children.some(function (child) {\n          return child.value === node.value;\n        })) {\n          pNode.children.push(node);\n        } else {\n          this.cache.add(node);\n        }\n      } else {\n        this.cache.add(node);\n      }\n    }\n  }, {\n    key: \"select\",\n    value: function select(val) {\n      var activeValues = _getTreePaths(this.data, val, []) || [];\n      activeValues.push(val);\n      return activeValues.filter(function (val2) {\n        return val2 != null;\n      });\n    }\n  }, {\n    key: \"expand\",\n    value: function expand(val) {\n      var _this = this;\n      if (this.expandValues.has(val)) {\n        this.expandValues[\"delete\"](val);\n        return _toConsumableArray(this.expandValues);\n      }\n      this.expandValues.add(val);\n      if (!this.isMutex.value) {\n        return _toConsumableArray(this.expandValues);\n      }\n      var sameParentNodes = _getTreeSameParentNodes(this.data, val) || [];\n      var sameLevelSubmenuValues = new Set(sameParentNodes.filter(function (node) {\n        var _node$children;\n        return ((_node$children = node.children) === null || _node$children === void 0 ? void 0 : _node$children.length) > 0 && node.value !== val;\n      }).map(function (child) {\n        return child.value;\n      }));\n      this.expandValues.forEach(function (val2) {\n        var isHit = sameLevelSubmenuValues.has(val2);\n        if (isHit) {\n          _this.expandValues[\"delete\"](val2);\n        }\n      });\n      return _toConsumableArray(this.expandValues);\n    }\n  }, {\n    key: \"getChild\",\n    value: function getChild(value) {\n      var target = _DFS(this.data, value);\n      return target ? target.children : [];\n    }\n  }]);\n}();\nexport { VMenu as default };","map":{"version":3,"names":["_getTreePaths","getTreePaths","node","val","ans","i","children","length","child","value","concat","_toConsumableArray","target","_getTreeSameParentNodes","getTreeSameParentNodes","_DFS","DFS","root","len","res","VMenu","options","_classCallCheck","_defineProperty","Set","ref","parent","data","isMutex","expandValues","_createClass","key","add","item","vnode","_objectSpread","cache","forEach","v2","set","push","pNode","some","select","activeValues","filter","val2","expand","_this","has","sameParentNodes","sameLevelSubmenuValues","_node$children","map","isHit","getChild"],"sources":["../../src/menu/v-menu.ts"],"sourcesContent":["import { ref, Slot } from 'vue';\nimport type { TdMenuItemProps } from './type';\ntype MenuValue = string | number;\ntype MenuNode = MenuValue | VMenuData;\n\ninterface VMenuData {\n  value: MenuValue;\n  parent?: MenuNode;\n  children: VMenuData[];\n  vnode?: Slot;\n}\n\ninterface VMenuItem extends TdMenuItemProps {\n  value?: MenuValue;\n  parent: MenuValue;\n  vnode?: Slot;\n}\n\nconst getTreePaths = (node: VMenuData, val: MenuValue, ans: MenuValue[]): MenuValue[] => {\n  if (!node) return;\n  for (let i = 0; i < node.children.length; ++i) {\n    const child = node.children[i];\n    if (child.value === val) return [...ans, node.value];\n    const target = getTreePaths(child, val, [...ans, node.value]);\n    if (target) return target;\n  }\n};\n\nconst getTreeSameParentNodes = (node: VMenuData, val: MenuValue): VMenuData[] => {\n  if (!node) return [];\n  for (let i = 0; i < node.children.length; ++i) {\n    const child = node.children[i];\n    if (child.value === val) return node.children;\n    const target = getTreeSameParentNodes(child, val);\n    if (target) return target;\n  }\n};\n\nconst DFS = (root: VMenuData, val: MenuValue): VMenuData => {\n  if (root.value === val) return root;\n  if (root.children.length > 0) {\n    for (let i = 0, len = root.children.length; i < len; i++) {\n      const res = DFS(root.children[i], val);\n      if (res) return res;\n    }\n  }\n};\n\nexport default class VMenu {\n  data: VMenuData = null;\n\n  cache: Set<VMenuData> = new Set();\n\n  isMutex = ref(false);\n\n  expandValues: Set<MenuValue> = null;\n\n  constructor(options: Record<string, any>) {\n    const root: VMenuData = {\n      value: null,\n      parent: null,\n      children: [],\n    };\n    this.data = root;\n    this.isMutex = options?.isMutex;\n    this.expandValues = new Set(options?.expandValues);\n  }\n\n  add(item: VMenuItem) {\n    const { value, parent, vnode } = item;\n    const node: VMenuData = {\n      value,\n      parent,\n      children: [],\n      vnode,\n      ...item,\n    };\n\n    this.cache.forEach((data, v2, set) => {\n      if (item.value === data.parent) {\n        node.children.push(data);\n        set.delete(data);\n      }\n    });\n    if (item.parent == null) {\n      this.data.children.push(node);\n      node.parent = this.data;\n    } else if (this.data.children.length > 0) {\n      const pNode = DFS(this.data, parent);\n      if (pNode && !pNode.children.some((child) => child.value === node.value)) {\n        pNode.children.push(node);\n      } else {\n        this.cache.add(node);\n      }\n    } else {\n      this.cache.add(node);\n    }\n  }\n\n  select(val: MenuValue) {\n    const activeValues = getTreePaths(this.data, val, []) || [];\n\n    activeValues.push(val);\n    return activeValues.filter((val) => val != null);\n  }\n\n  expand(val: MenuValue) {\n    if (this.expandValues.has(val)) {\n      this.expandValues.delete(val);\n      return [...this.expandValues];\n    }\n\n    this.expandValues.add(val);\n\n    if (!this.isMutex.value) {\n      return [...this.expandValues];\n    }\n\n    const sameParentNodes = getTreeSameParentNodes(this.data, val) || [];\n    const sameLevelSubmenuValues = new Set(\n      sameParentNodes.filter((node) => node.children?.length > 0 && node.value !== val).map((child) => child.value),\n    );\n\n    this.expandValues.forEach((val) => {\n      const isHit = sameLevelSubmenuValues.has(val);\n      if (isHit) {\n        this.expandValues.delete(val);\n      }\n    });\n    return [...this.expandValues];\n  }\n\n  getChild(value: MenuValue) {\n    const target = DFS(this.data, value);\n\n    return target ? target.children : [];\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}