{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\n/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _toConsumableArray } from '../../_chunks/dep-4a990ea3.mjs';\nimport { _ as _defineProperty } from '../../_chunks/dep-fa52aa21.mjs';\nimport { _ as _slicedToArray } from '../../_chunks/dep-5efe53d1.mjs';\nimport { toRefs, ref, computed, createVNode, mergeProps, watch } from 'vue';\nimport { i as isFunction_1 } from '../../_chunks/dep-06dcbf4c.mjs';\nimport SorterButton from '../sorter-button.mjs';\nimport useDefaultValue from '../../hooks/useDefaultValue.mjs';\nimport { i as isArray_1 } from '../../_chunks/dep-eae2a67e.mjs';\nimport '../../_chunks/dep-593f2b67.mjs';\nimport '../../_chunks/dep-4659d73b.mjs';\nimport '../../_chunks/dep-eca422c3.mjs';\nimport '../../_chunks/dep-bf7257e7.mjs';\nimport '../../_chunks/dep-2b09875b.mjs';\nimport '../../_chunks/dep-cda4f568.mjs';\nimport 'tdesign-icons-vue-next';\nimport './useClassName.mjs';\nimport '../../hooks/useConfig.mjs';\nimport '../../config-provider/useConfig.mjs';\nimport '../../_chunks/dep-bb899bfd.mjs';\nimport '../../_chunks/dep-5922c8f3.mjs';\nimport '../../_chunks/dep-92f86d1d.mjs';\nimport '../../_chunks/dep-6ab5363f.mjs';\nimport '../../_chunks/dep-6dc3d0e1.mjs';\nimport '../../_chunks/dep-76958824.mjs';\nimport '../../_chunks/dep-e9841b9e.mjs';\nimport '../../_chunks/dep-1a4bb2f2.mjs';\nimport '../../_chunks/dep-cc8ebcde.mjs';\nimport '../../_chunks/dep-29ef8419.mjs';\nimport '../../_chunks/dep-f5579c03.mjs';\nimport '../../_chunks/dep-49aeee3c.mjs';\nimport '../../_chunks/dep-b5bf85f5.mjs';\nimport '../../_chunks/dep-3c65fae8.mjs';\nimport '../../_chunks/dep-626c497d.mjs';\nimport '../../_chunks/dep-ec0bbd9f.mjs';\nimport '../../_chunks/dep-1b78414a.mjs';\nimport '../../_chunks/dep-d84f19b3.mjs';\nimport '../../_chunks/dep-732f0b7d.mjs';\nimport '../../_chunks/dep-03a7fb6c.mjs';\nimport '../../_chunks/dep-1b9718a2.mjs';\nimport '../../_chunks/dep-e065dc25.mjs';\nimport '../../_chunks/dep-400ec705.mjs';\nimport '../../_chunks/dep-02f9394e.mjs';\nimport '../../_chunks/dep-1725b1c7.mjs';\nimport '../../_chunks/dep-532409c5.mjs';\nimport '../../_common/js/global-config/default-config.mjs';\nimport '../../_common/js/global-config/locale/zh_CN.mjs';\nimport '../../_chunks/dep-9ed7da3e.mjs';\nimport '../../_chunks/dep-7f65fc46.mjs';\nimport '../../_chunks/dep-4f2cabb0.mjs';\nimport '../../config-provider/type.mjs';\nimport '../../tooltip/index.mjs';\nimport '../../tooltip/tooltip.mjs';\nimport '../../_chunks/dep-88ae49da.mjs';\nimport '../../_chunks/dep-7932c2e8.mjs';\nimport '../../_chunks/dep-ab4bb9b8.mjs';\nimport '../../_chunks/dep-aeaef131.mjs';\nimport '../../_chunks/dep-88c8d9ed.mjs';\nimport '../../_chunks/dep-2f6e28a0.mjs';\nimport '../../_chunks/dep-4ec29b23.mjs';\nimport '../../tooltip/props.mjs';\nimport '../../popup/props.mjs';\nimport '../../popup/index.mjs';\nimport '../../popup/popup.mjs';\nimport '@popperjs/core';\nimport '../../_chunks/dep-5993931e.mjs';\nimport '../../_chunks/dep-8dfc9324.mjs';\nimport '../../hooks/index.mjs';\nimport '../../hooks/icon.mjs';\nimport '../../hooks/slot.mjs';\nimport '../../utils/render-tnode.mjs';\nimport '../../_chunks/dep-b91a8171.mjs';\nimport '../../_chunks/dep-03ad9cda.mjs';\nimport '../../_chunks/dep-d8a34055.mjs';\nimport '../../_chunks/dep-5a17bf21.mjs';\nimport '../../_chunks/dep-bad871d5.mjs';\nimport '../../hooks/tnode.mjs';\nimport '../../hooks/useCommonClassName.mjs';\nimport '../../hooks/useDestroyOnClose.mjs';\nimport '../../hooks/useKeepAnimation.mjs';\nimport '../../hooks/useRipple.mjs';\nimport '../../utils/set-style.mjs';\nimport '../../hooks/useVirtualScroll.mjs';\nimport '../../hooks/useVModel.mjs';\nimport '../../hooks/useImagePreviewUrl.mjs';\nimport '../../_common/js/upload/utils.mjs';\nimport '../../_common/js/log/log.mjs';\nimport '../../utils/dom.mjs';\nimport '../../utils/easing.mjs';\nimport '../../_common/js/utils/set-style.mjs';\nimport '../../popup/container.mjs';\nimport '../../hooks/useResizeObserver.mjs';\nimport '../../utils/withInstall.mjs';\nimport './style/css.mjs';\nimport '../../popup/type.mjs';\nimport '../../tooltip/util.mjs';\nimport '../../tooltip/type.mjs';\nimport '../../hooks/useGlobalIcon.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nfunction useSorter(props, _ref) {\n  var slots = _ref.slots;\n  var _toRefs = toRefs(props),\n    sort = _toRefs.sort,\n    data = _toRefs.data;\n  var originalData = ref();\n  var _useDefaultValue = useDefaultValue(sort, props.defaultSort, props.onSortChange, \"sort\"),\n    _useDefaultValue2 = _slicedToArray(_useDefaultValue, 2),\n    tSortInfo = _useDefaultValue2[0],\n    setTSortInfo = _useDefaultValue2[1];\n  var _useDefaultValue3 = useDefaultValue(data, [], props.onDataChange, \"data\"),\n    _useDefaultValue4 = _slicedToArray(_useDefaultValue3, 2),\n    tData = _useDefaultValue4[0],\n    setTData = _useDefaultValue4[1];\n  var sorterFuncMap = computed(function () {\n    return getSorterFuncMap(props.columns);\n  });\n  var innerSort = ref();\n  var sortArray = computed(function () {\n    var sort2 = tSortInfo.value;\n    if (!sort2) return [];\n    return isArray_1(sort2) ? sort2 : [sort2];\n  });\n  var sortMap = computed(function () {\n    var sortMap2 = {};\n    sortArray.value.forEach(function (info, index) {\n      var sortBy = info.sortBy;\n      sortMap2[sortBy] = _objectSpread({\n        index: index\n      }, info);\n    });\n    return sortMap2;\n  });\n  function getSorterFuncMap(columns) {\n    var map = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    for (var i = 0, len = columns.length; i < len; i++) {\n      var _col$children;\n      var col = columns[i];\n      if (isFunction_1(col.sorter)) {\n        map[col.colKey] = col.sorter;\n      }\n      if ((_col$children = col.children) !== null && _col$children !== void 0 && _col$children.length) {\n        getSorterFuncMap(col.children, map);\n      }\n    }\n    return map;\n  }\n  function handleDataSort(sortInfo) {\n    var sort2 = sortInfo;\n    if (!Object.keys(sorterFuncMap.value).length) return;\n    if (!originalData.value) {\n      originalData.value = tData.value;\n    }\n    var isEmptyArraySort = !sort2 || sort2 instanceof Array && !sort2.length;\n    var isEmptyObjectSort = !(sort2 instanceof Array) && !(sort2 !== null && sort2 !== void 0 && sort2.sortBy);\n    if (isEmptyArraySort || isEmptyObjectSort) {\n      setTData(originalData.value, {\n        trigger: \"sort\"\n      });\n      return originalData.value;\n    }\n    var formatedSort = sort2 instanceof Array ? sort2 : [sort2];\n    var newData = tData.value.slice().sort(function (a, b) {\n      var sortResult = 0;\n      for (var i = 0, len = formatedSort.length; i < len; i++) {\n        var item = formatedSort[i];\n        var sortFunc = sorterFuncMap.value[item.sortBy];\n        if (sortResult === 0 && sortFunc) {\n          sortResult = item.descending ? sortFunc(b, a) : sortFunc(a, b);\n        } else {\n          break;\n        }\n      }\n      return sortResult;\n    });\n    if (JSON.stringify(newData) === JSON.stringify(tData.value)) return;\n    setTData(newData, {\n      trigger: \"sort\"\n    });\n    return newData;\n  }\n  function handleSortHeaderClick(col, p) {\n    var _props$onChange;\n    var sortInfo;\n    if (props.multipleSort) {\n      sortInfo = getMultipleNextSort(col, p);\n    } else {\n      var sort2 = tSortInfo.value instanceof Array ? tSortInfo.value[0] : tSortInfo.value;\n      sortInfo = getSingleNextSort(col, sort2, p);\n    }\n    var newData = handleDataSort(sortInfo);\n    var currentData = newData || tData.value;\n    var currentDataSource = currentData;\n    setTSortInfo(sortInfo, {\n      currentDataSource: currentDataSource,\n      col: col\n    });\n    (_props$onChange = props.onChange) === null || _props$onChange === void 0 || _props$onChange.call(props, {\n      sorter: sortInfo\n    }, {\n      currentData: currentData,\n      trigger: \"sorter\"\n    });\n    innerSort.value = sortInfo;\n  }\n  function getSortOrder(descending) {\n    if (descending === void 0) return;\n    return descending ? \"desc\" : \"asc\";\n  }\n  function getSingleNextSort(col, sortInfo, p) {\n    if (sortInfo && sortInfo.sortBy === col.colKey && sortInfo.descending === p.descending) {\n      return void 0;\n    }\n    return {\n      sortBy: col.colKey,\n      descending: p.descending\n    };\n  }\n  function getMultipleNextSort(col, p) {\n    if (!Array.isArray(tSortInfo.value)) {\n      tSortInfo.value = tSortInfo.value ? [tSortInfo.value] : [];\n    }\n    var sort2 = tSortInfo.value;\n    var colKey = col.colKey;\n    var result = _toConsumableArray(sort2);\n    for (var i = 0, len = sort2.length; i < len; i++) {\n      if (sort2[i].sortBy === colKey) {\n        var next = getSingleNextSort(col, sort2[i], p);\n        next ? result[i] = next : result.splice(i, 1);\n        return result;\n      }\n    }\n    result.push({\n      sortBy: colKey,\n      descending: p.descending\n    });\n    return result;\n  }\n  function renderSortIcon(_ref2) {\n    var _sortMap$value$col$co;\n    var col = _ref2.col;\n    if (!col.sorter) return null;\n    var sorterButtonsProps = {\n      sortType: col.sortType,\n      sortOrder: getSortOrder((_sortMap$value$col$co = sortMap.value[col.colKey]) === null || _sortMap$value$col$co === void 0 ? void 0 : _sortMap$value$col$co.descending),\n      sortIcon: props.sortIcon,\n      hideSortTips: props.hideSortTips,\n      locale: props.locale\n    };\n    return createVNode(SorterButton, mergeProps(sorterButtonsProps, {\n      \"onSortIconClick\": function onSortIconClick(_, p) {\n        return handleSortHeaderClick(col, p);\n      }\n    }), {\n      sortIcon: slots.sortIcon\n    });\n  }\n  var isSortInfoSame = function isSortInfoSame(a, b) {\n    var tmpSortInfo = isArray_1(a) ? a : [a];\n    var tmpInnerSortInfo = isArray_1(b) ? b : [b];\n    if (tmpSortInfo.length && !b) return false;\n    var _loop = function _loop() {\n        var item = tmpSortInfo[i];\n        var result = tmpInnerSortInfo.find(function (t) {\n          return t.sortBy === item.sortBy;\n        });\n        if (!result) return {\n          v: false\n        };\n        return {\n          v: item.descending === result.descending\n        };\n      },\n      _ret;\n    for (var i = 0, len = tmpSortInfo.length; i < len; i++) {\n      _ret = _loop();\n      if (_ret) return _ret.v;\n    }\n  };\n  watch(function () {\n    return [tSortInfo, props.data];\n  }, function () {\n    if (!tSortInfo.value || !Object.keys(tSortInfo.value).length || !tData.value.length) return;\n    if (!isSortInfoSame(tSortInfo.value, innerSort.value)) {\n      handleDataSort(tSortInfo.value);\n    }\n  }, {\n    immediate: true\n  });\n  return {\n    renderSortIcon: renderSortIcon\n  };\n}\nexport { useSorter as default };","map":{"version":3,"names":["useSorter","props","_ref","slots","_toRefs","toRefs","sort","data","originalData","ref","_useDefaultValue","useDefaultValue","defaultSort","onSortChange","_useDefaultValue2","_slicedToArray","tSortInfo","setTSortInfo","_useDefaultValue3","onDataChange","_useDefaultValue4","tData","setTData","sorterFuncMap","computed","getSorterFuncMap","columns","innerSort","sortArray","sort2","value","isArray_1","sortMap","sortMap2","forEach","info","index","sortBy","_objectSpread","map","arguments","length","undefined","i","len","_col$children","col","isFunction_1","sorter","colKey","children","handleDataSort","sortInfo","Object","keys","isEmptyArraySort","Array","isEmptyObjectSort","trigger","formatedSort","newData","slice","a","b","sortResult","item","sortFunc","descending","JSON","stringify","handleSortHeaderClick","p","_props$onChange","multipleSort","getMultipleNextSort","getSingleNextSort","currentData","currentDataSource","onChange","call","getSortOrder","isArray","result","_toConsumableArray","next","splice","push","renderSortIcon","_ref2","_sortMap$value$col$co","sorterButtonsProps","sortType","sortOrder","sortIcon","hideSortTips","locale","createVNode","SorterButton","mergeProps","onSortIconClick","_","isSortInfoSame","tmpSortInfo","tmpInnerSortInfo","_loop","find","t","v","_ret","watch","immediate"],"sources":["../../../src/table/hooks/useSorter.tsx"],"sourcesContent":["import { SetupContext, computed, toRefs, ref, watch } from 'vue';\nimport isFunction from 'lodash/isFunction';\nimport { SortInfo, TdPrimaryTableProps, PrimaryTableCol, TableRowData } from '../type';\nimport SorterButton from '../sorter-button';\nimport useDefaultValue from '../../hooks/useDefaultValue';\nimport isArray from 'lodash/isArray';\n\nexport type SortMap = Record<string, SortInfo & { index: number }>;\n\nexport default function useSorter(props: TdPrimaryTableProps, { slots }: SetupContext) {\n  const { sort, data } = toRefs(props);\n  const originalData = ref();\n  const [tSortInfo, setTSortInfo] = useDefaultValue(sort, props.defaultSort, props.onSortChange, 'sort');\n  const [tData, setTData] = useDefaultValue(data, [], props.onDataChange, 'data');\n  // 本地数据排序：用于记录哪些字段是自定义排序函数\n  const sorterFuncMap = computed(() => getSorterFuncMap(props.columns));\n  const innerSort = ref<SortInfo | SortInfo[]>();\n\n  const sortArray = computed<Array<SortInfo>>(() => {\n    const sort = tSortInfo.value;\n    if (!sort) return [];\n    return isArray(sort) ? sort : [sort];\n  });\n\n  const sortMap = computed<SortMap>(() => {\n    const sortMap = {};\n    sortArray.value.forEach((info, index) => {\n      const { sortBy } = info;\n      sortMap[sortBy] = { index, ...info };\n    });\n    return sortMap;\n  });\n\n  function getSorterFuncMap(columns: PrimaryTableCol[], map: { [key: string]: Function } = {}) {\n    for (let i = 0, len = columns.length; i < len; i++) {\n      const col = columns[i];\n      if (isFunction(col.sorter)) {\n        // eslint-disable-next-line no-param-reassign\n        map[col.colKey] = col.sorter;\n      }\n      // 多级表头中的排序功能\n      if (col.children?.length) {\n        getSorterFuncMap(col.children, map);\n      }\n    }\n    return map;\n  }\n\n  function handleDataSort(sortInfo: SortInfo | Array<SortInfo>) {\n    const sort = sortInfo;\n    if (!Object.keys(sorterFuncMap.value).length) return;\n    if (!originalData.value) {\n      originalData.value = tData.value;\n    }\n    const isEmptyArraySort = !sort || (sort instanceof Array && !sort.length);\n    const isEmptyObjectSort = !(sort instanceof Array) && !sort?.sortBy;\n    if (isEmptyArraySort || isEmptyObjectSort) {\n      setTData(originalData.value, { trigger: 'sort' });\n      return originalData.value;\n    }\n    const formatedSort = sort instanceof Array ? sort : [sort];\n    // data 为受控属性，data.slice() 浅拷贝，防止 sort 导致原数据变异\n    const newData: TableRowData[] = tData.value.slice().sort((a: TableRowData, b: TableRowData) => {\n      let sortResult = 0;\n      for (let i = 0, len = formatedSort.length; i < len; i++) {\n        const item = formatedSort[i];\n        const sortFunc = sorterFuncMap.value[item.sortBy];\n        // 上一个排序字段值相同时才会进行下一个字段的大小对比\n        if (sortResult === 0 && sortFunc) {\n          sortResult = item.descending ? sortFunc(b, a) : sortFunc(a, b);\n        } else {\n          break;\n        }\n      }\n      return sortResult;\n    });\n    // Data 变化返回的是数据引用，为避免死循环，特此检测排序数据前后是否相同，如果相同则不再触发事件\n    if (JSON.stringify(newData) === JSON.stringify(tData.value)) return;\n    setTData(newData, { trigger: 'sort' });\n    return newData;\n  }\n\n  function handleSortHeaderClick(col: PrimaryTableCol<TableRowData>, p: { descending: boolean }) {\n    let sortInfo: SortInfo | Array<SortInfo>;\n    if (props.multipleSort) {\n      sortInfo = getMultipleNextSort(col, p);\n    } else {\n      // 如果此次调用之前开启了multipleSort，tSortInfo可能为数组，尝试取数组中第一个排序字段的参数\n      const sort = tSortInfo.value instanceof Array ? tSortInfo.value[0] : tSortInfo.value;\n      sortInfo = getSingleNextSort(col, sort, p);\n    }\n    // 本地数据 data 排序，需同时抛出 data-change\n    const newData = handleDataSort(sortInfo);\n    const currentData = newData || tData.value;\n    const currentDataSource = currentData;\n    setTSortInfo(sortInfo, { currentDataSource, col });\n    props.onChange?.({ sorter: sortInfo }, { currentData, trigger: 'sorter' });\n    innerSort.value = sortInfo;\n  }\n\n  function getSortOrder(descending: boolean) {\n    if (descending === undefined) return;\n    return descending ? 'desc' : 'asc';\n  }\n\n  // 点击新排序字段，则默认按照降序排序；点击原字段，则排序字段不变仅切换排序方式\n  function getSingleNextSort(col: PrimaryTableCol, sortInfo: SortInfo, p: { descending: boolean }): SortInfo {\n    // 排序字段和排序方式均相同，则取消排序\n    if (sortInfo && sortInfo.sortBy === col.colKey && sortInfo.descending === p.descending) {\n      return undefined;\n    }\n    return { sortBy: col.colKey, descending: p.descending };\n  }\n\n  function getMultipleNextSort(col: PrimaryTableCol<TableRowData>, p: { descending: boolean }): Array<SortInfo> {\n    // 如tSortInfo不是数组，判断是否存在，如存在作为第一个排序字段（保留之前未开启multipleSort时的字段），否则初始化为空数组\n    if (!Array.isArray(tSortInfo.value)) {\n      tSortInfo.value = tSortInfo.value ? [tSortInfo.value] : [];\n    }\n    const sort = tSortInfo.value;\n    const { colKey } = col;\n    const result = [...sort];\n    for (let i = 0, len = sort.length; i < len; i++) {\n      if (sort[i].sortBy === colKey) {\n        const next = getSingleNextSort(col, sort[i], p);\n        next ? (result[i] = next) : result.splice(i, 1);\n        return result;\n      }\n    }\n    result.push({ sortBy: colKey, descending: p.descending });\n    return result;\n  }\n\n  function renderSortIcon({ col }: { col: PrimaryTableCol<TableRowData>; colIndex: number }) {\n    if (!col.sorter) return null;\n    const sorterButtonsProps = {\n      sortType: col.sortType,\n      sortOrder: getSortOrder(sortMap.value[col.colKey]?.descending),\n      sortIcon: props.sortIcon,\n      hideSortTips: props.hideSortTips,\n      locale: props.locale,\n    };\n    return (\n      <SorterButton\n        v-slots={{ sortIcon: slots.sortIcon }}\n        {...sorterButtonsProps}\n        onSortIconClick={(_: MouseEvent, p: { descending: boolean }) => handleSortHeaderClick(col, p)}\n      />\n    );\n  }\n\n  const isSortInfoSame = (a: SortInfo | SortInfo[], b: SortInfo | SortInfo[]) => {\n    const tmpSortInfo = isArray(a) ? a : [a];\n    const tmpInnerSortInfo = isArray(b) ? b : [b];\n    if (tmpSortInfo.length && !b) return false;\n    // eslint-disable-next-line\n    for (let i = 0, len = tmpSortInfo.length; i < len; i++) {\n      const item = tmpSortInfo[i];\n      const result = tmpInnerSortInfo.find((t) => t.sortBy === item.sortBy);\n      if (!result) return false;\n      return item.descending === result.descending;\n    }\n  };\n\n  /**\n   * 如果外部的排序不为空，且和内部排序字段不同，说明传入的 sortInfo 和 data 可能存在不一致，\n   * 此时，需要在组件内部进行排序，并输出事件\n   */\n  watch(\n    () => [tSortInfo, props.data],\n    () => {\n      if (!tSortInfo.value || !Object.keys(tSortInfo.value).length || !tData.value.length) return;\n      // isSortInfoSame 的两个参数顺序不可变\n      if (!isSortInfoSame(tSortInfo.value, innerSort.value)) {\n        handleDataSort(tSortInfo.value);\n      }\n    },\n    { immediate: true },\n  );\n\n  return {\n    renderSortIcon,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}