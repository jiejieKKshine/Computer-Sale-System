{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.reduce.js\";\n/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _defineProperty } from '../../_chunks/dep-fa52aa21.mjs';\nimport { getCurrentInstance, computed } from 'vue';\nimport { i as isString_1 } from '../../_chunks/dep-03a7fb6c.mjs';\nimport { i as isArray_1 } from '../../_chunks/dep-eae2a67e.mjs';\nimport { c as camelCase_1 } from '../../_chunks/dep-03ad9cda.mjs';\nimport { useChildComponentSlots } from '../../hooks/slot.mjs';\nimport '../../_chunks/dep-4659d73b.mjs';\nimport '../../_chunks/dep-eca422c3.mjs';\nimport '../../_chunks/dep-bf7257e7.mjs';\nimport '../../_chunks/dep-626c497d.mjs';\nimport '../../_chunks/dep-29ef8419.mjs';\nimport '../../_chunks/dep-7932c2e8.mjs';\nimport '../../_chunks/dep-ab4bb9b8.mjs';\nimport '../../_chunks/dep-d8a34055.mjs';\nimport '../../_chunks/dep-2f6e28a0.mjs';\nimport '../../_chunks/dep-5a17bf21.mjs';\nimport '../../utils/render-tnode.mjs';\nimport '../../_chunks/dep-b91a8171.mjs';\nimport '../../_chunks/dep-1b78414a.mjs';\nimport '../../_chunks/dep-1a4bb2f2.mjs';\nimport '../../_chunks/dep-cc8ebcde.mjs';\nimport '../../_chunks/dep-06dcbf4c.mjs';\nimport '../../_chunks/dep-2b09875b.mjs';\nimport '../../_chunks/dep-cda4f568.mjs';\nimport '../../_chunks/dep-76958824.mjs';\nimport '../../_chunks/dep-f5579c03.mjs';\nimport '../../_chunks/dep-6dc3d0e1.mjs';\nimport '../../_chunks/dep-d84f19b3.mjs';\nimport '../../_chunks/dep-3c65fae8.mjs';\nimport '../../_chunks/dep-bad871d5.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nvar _getOptionsFromChildren = function getOptionsFromChildren(menuNode) {\n  var _menuNode$, _menuNode$3, _menuNode$4;\n  if (!menuNode) return [];\n  if (((_menuNode$ = menuNode[0]) === null || _menuNode$ === void 0 || (_menuNode$ = _menuNode$.type) === null || _menuNode$ === void 0 ? void 0 : _menuNode$.name) === \"TDropdownMenu\") {\n    var _menuNode$2, _menuNode$2$default;\n    var groupChildren = (_menuNode$2 = menuNode[0]) === null || _menuNode$2 === void 0 || (_menuNode$2 = _menuNode$2.children) === null || _menuNode$2 === void 0 || (_menuNode$2$default = _menuNode$2[\"default\"]) === null || _menuNode$2$default === void 0 ? void 0 : _menuNode$2$default.call(_menuNode$2);\n    if (isArray_1(groupChildren)) {\n      return _getOptionsFromChildren(groupChildren);\n    }\n  }\n  if (isArray_1(menuNode)) {\n    menuNode = menuNode.reduce(function (acc, item) {\n      acc = acc.concat(isArray_1(item.children) ? item.children : item);\n      return acc;\n    }, []);\n    return menuNode.map(function (item) {\n      var _item$children, _item$children$conten, _item$children2, _item$children2$prefi, _item$children3, _item$children3$prefi, _item$children4, _item$children4$defau, _groupChildren$filter, _groupChildren$filter2;\n      var slotContent = (_item$children = item.children) === null || _item$children === void 0 || (_item$children$conten = _item$children.content) === null || _item$children$conten === void 0 ? void 0 : _item$children$conten.call(_item$children);\n      var slotPrefixIcon = ((_item$children2 = item.children) === null || _item$children2 === void 0 || (_item$children2$prefi = _item$children2.prefixIcon) === null || _item$children2$prefi === void 0 ? void 0 : _item$children2$prefi.call(_item$children2)) || ((_item$children3 = item.children) === null || _item$children3 === void 0 || (_item$children3$prefi = _item$children3[\"prefix-icon\"]) === null || _item$children3$prefi === void 0 ? void 0 : _item$children3$prefi.call(_item$children3));\n      var groupChildren = (_item$children4 = item.children) === null || _item$children4 === void 0 || (_item$children4$defau = _item$children4[\"default\"]) === null || _item$children4$defau === void 0 ? void 0 : _item$children4$defau.call(_item$children4);\n      var contentCtx = groupChildren === null || groupChildren === void 0 || (_groupChildren$filter = groupChildren.filter) === null || _groupChildren$filter === void 0 ? void 0 : _groupChildren$filter.call(groupChildren, function (v) {\n        var _v$type;\n        return ![\"TDropdownMenu\", \"TDropdownItem\"].includes((_v$type = v.type) === null || _v$type === void 0 ? void 0 : _v$type.name);\n      });\n      var childrenCtx = groupChildren === null || groupChildren === void 0 || (_groupChildren$filter2 = groupChildren.filter) === null || _groupChildren$filter2 === void 0 ? void 0 : _groupChildren$filter2.call(groupChildren, function (v) {\n        var _v$type2;\n        return !isString_1(v.children) && [\"TDropdownMenu\", \"TDropdownItem\"].includes((_v$type2 = v.type) === null || _v$type2 === void 0 ? void 0 : _v$type2.name);\n      });\n      var itemProps = Object.keys(item.props || {}).reduce(function (props, propName) {\n        var _item$type;\n        if (item.props[propName] === \"\" && ((_item$type = item.type) === null || _item$type === void 0 ? void 0 : _item$type.name) === \"TDropdownItem\" && [\"active\", \"divider\", \"disabled\"].includes(propName)) {\n          props[camelCase_1(propName)] = true;\n        } else {\n          props[camelCase_1(propName)] = item.props[propName];\n        }\n        return props;\n      }, {});\n      return _objectSpread(_objectSpread(_objectSpread({\n        content: slotContent || contentCtx || groupChildren\n      }, itemProps), slotPrefixIcon ? {\n        prefixIcon: function prefixIcon() {\n          return slotPrefixIcon;\n        }\n      } : {}), {}, {\n        children: (childrenCtx === null || childrenCtx === void 0 ? void 0 : childrenCtx.length) > 0 ? _getOptionsFromChildren(childrenCtx) : null\n      });\n    }).filter(function (v) {\n      return !!v.content;\n    });\n  }\n  if (isArray_1((_menuNode$3 = menuNode[0]) === null || _menuNode$3 === void 0 ? void 0 : _menuNode$3.children)) return _getOptionsFromChildren((_menuNode$4 = menuNode[0]) === null || _menuNode$4 === void 0 ? void 0 : _menuNode$4.children);\n  return [];\n};\nfunction useDropdownOptions(props) {\n  var _getChildComponentSlo, _getChildComponentSlo2, _instance$slots, _instance$slots$dropd;\n  var getChildComponentSlots = useChildComponentSlots();\n  var instance = getCurrentInstance();\n  var menuSlot = ((_getChildComponentSlo = getChildComponentSlots(\"DropdownMenu\")) === null || _getChildComponentSlo === void 0 || (_getChildComponentSlo = _getChildComponentSlo[0]) === null || _getChildComponentSlo === void 0 || (_getChildComponentSlo = _getChildComponentSlo.children) === null || _getChildComponentSlo === void 0 || (_getChildComponentSlo2 = _getChildComponentSlo[\"default\"]) === null || _getChildComponentSlo2 === void 0 ? void 0 : _getChildComponentSlo2.call(_getChildComponentSlo)) || ((_instance$slots = instance.slots) === null || _instance$slots === void 0 || (_instance$slots$dropd = _instance$slots.dropdown) === null || _instance$slots$dropd === void 0 ? void 0 : _instance$slots$dropd.call(_instance$slots));\n  var dropdownOptions = computed(function () {\n    if (props.options && props.options.length > 0) return props.options;\n    return _getOptionsFromChildren(menuSlot);\n  });\n  return dropdownOptions;\n}\nexport { useDropdownOptions as default, _getOptionsFromChildren as getOptionsFromChildren };","map":{"version":3,"names":["_getOptionsFromChildren","getOptionsFromChildren","menuNode","_menuNode$","_menuNode$3","_menuNode$4","type","name","_menuNode$2","_menuNode$2$default","groupChildren","children","call","isArray_1","reduce","acc","item","concat","map","_item$children","_item$children$conten","_item$children2","_item$children2$prefi","_item$children3","_item$children3$prefi","_item$children4","_item$children4$defau","_groupChildren$filter","_groupChildren$filter2","slotContent","content","slotPrefixIcon","prefixIcon","contentCtx","filter","v","_v$type","includes","childrenCtx","_v$type2","isString_1","itemProps","Object","keys","props","propName","_item$type","camelCase_1","_objectSpread","length","useDropdownOptions","_getChildComponentSlo","_getChildComponentSlo2","_instance$slots","_instance$slots$dropd","getChildComponentSlots","useChildComponentSlots","instance","getCurrentInstance","menuSlot","slots","dropdown","dropdownOptions","computed","options"],"sources":["../../../src/dropdown/hooks/useDropdownOptions.ts"],"sourcesContent":["import { computed, ComputedRef, VNode, getCurrentInstance, Slots, Component } from 'vue';\nimport isString from 'lodash/isString';\nimport isArray from 'lodash/isArray';\nimport camelCase from 'lodash/camelCase';\n\nimport { useChildComponentSlots } from '../../hooks/slot';\nimport type { DropdownOption, TdDropdownProps } from '../type';\n\nexport const getOptionsFromChildren = (menuNode: VNode | VNode[]): DropdownOption[] => {\n  if (!menuNode) return [];\n\n  // 处理内部嵌套场景\n  if (menuNode[0]?.type?.name === 'TDropdownMenu') {\n    const groupChildren = menuNode[0]?.children?.default?.() as VNode;\n    if (isArray(groupChildren)) {\n      return getOptionsFromChildren(groupChildren);\n    }\n  }\n\n  if (isArray(menuNode)) {\n    menuNode = menuNode.reduce((acc, item) => {\n      acc = acc.concat(isArray(item.children) ? item.children : item);\n      return acc;\n    }, []);\n    return menuNode\n      .map((item) => {\n        const slotContent = (item.children as any)?.content?.();\n        const slotPrefixIcon = (item.children as any)?.prefixIcon?.() || (item.children as any)?.['prefix-icon']?.();\n        const groupChildren = (item.children as any)?.default?.();\n\n        // 当前节点的渲染内容\n        const contentCtx = groupChildren?.filter?.(\n          (v: VNode) => !['TDropdownMenu', 'TDropdownItem'].includes((v.type as { name: string })?.name),\n        );\n        // 嵌套菜单的节点\n        const childrenCtx = groupChildren?.filter?.(\n          (v: VNode) =>\n            !isString(v.children) && ['TDropdownMenu', 'TDropdownItem'].includes((v.type as { name: string })?.name),\n        );\n\n        // 将item.props的属性名都转成驼峰，再进行传递\n        const itemProps = Object.keys(item.props || {}).reduce((props, propName) => {\n          // 处理 TDropdownItem 的 boolean attribute\n          if (\n            item.props[propName] === '' &&\n            (item.type as Component)?.name === 'TDropdownItem' &&\n            ['active', 'divider', 'disabled'].includes(propName)\n          ) {\n            props[camelCase(propName)] = true;\n          } else {\n            props[camelCase(propName)] = item.props[propName];\n          }\n          return props;\n        }, {});\n\n        return {\n          content: slotContent || contentCtx || groupChildren,\n          ...itemProps,\n          ...(slotPrefixIcon ? { prefixIcon: () => slotPrefixIcon } : {}),\n          children: childrenCtx?.length > 0 ? getOptionsFromChildren(childrenCtx) : null,\n        };\n      })\n      .filter((v) => !!v.content);\n  }\n\n  // 处理v-if的场景\n  if (isArray(menuNode[0]?.children)) return getOptionsFromChildren(menuNode[0]?.children);\n\n  return [];\n};\n\nexport default function useDropdownOptions(props: TdDropdownProps): ComputedRef<DropdownOption[]> {\n  const getChildComponentSlots = useChildComponentSlots();\n  const instance = getCurrentInstance();\n  const menuSlot =\n    (getChildComponentSlots('DropdownMenu')?.[0]?.children as Slots)?.default?.() || instance.slots?.dropdown?.();\n\n  const dropdownOptions = computed(() => {\n    if (props.options && props.options.length > 0) return props.options;\n\n    return getOptionsFromChildren(menuSlot);\n  });\n  return dropdownOptions;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}