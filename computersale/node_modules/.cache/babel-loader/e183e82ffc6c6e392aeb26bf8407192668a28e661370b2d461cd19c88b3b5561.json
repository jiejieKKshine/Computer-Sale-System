{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\n/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _defineProperty } from '../../_chunks/dep-fa52aa21.mjs';\nimport { _ as _slicedToArray } from '../../_chunks/dep-5efe53d1.mjs';\nimport { defineComponent, computed, createVNode, mergeProps } from 'vue';\nimport TDatePickerCell from './Cell.mjs';\nimport { usePrefixClass } from '../../hooks/useConfig.mjs';\nimport { p as parseToDayjs } from '../../_chunks/dep-421d1ae8.mjs';\nimport { i as isArray_1 } from '../../_chunks/dep-eae2a67e.mjs';\nimport { useConfig } from '../../config-provider/useConfig.mjs';\nimport '../../_chunks/dep-4659d73b.mjs';\nimport '../../_chunks/dep-593f2b67.mjs';\nimport '../../_chunks/dep-7f65fc46.mjs';\nimport '../../_chunks/dep-eca422c3.mjs';\nimport '../../_chunks/dep-06dcbf4c.mjs';\nimport '../../_chunks/dep-bf7257e7.mjs';\nimport '../../_chunks/dep-2b09875b.mjs';\nimport '../../_chunks/dep-cda4f568.mjs';\nimport '../../_chunks/dep-bb899bfd.mjs';\nimport '../../_chunks/dep-5922c8f3.mjs';\nimport '../../_chunks/dep-92f86d1d.mjs';\nimport '../../_chunks/dep-6ab5363f.mjs';\nimport '../../_chunks/dep-6dc3d0e1.mjs';\nimport '../../_chunks/dep-76958824.mjs';\nimport '../../_chunks/dep-e9841b9e.mjs';\nimport '../../_chunks/dep-1a4bb2f2.mjs';\nimport '../../_chunks/dep-cc8ebcde.mjs';\nimport '../../_chunks/dep-29ef8419.mjs';\nimport '../../_chunks/dep-f5579c03.mjs';\nimport '../../_chunks/dep-49aeee3c.mjs';\nimport '../../_chunks/dep-b5bf85f5.mjs';\nimport '../../_chunks/dep-3c65fae8.mjs';\nimport '../../_chunks/dep-626c497d.mjs';\nimport '../../_chunks/dep-ec0bbd9f.mjs';\nimport '../../_chunks/dep-1b78414a.mjs';\nimport '../../_chunks/dep-d84f19b3.mjs';\nimport '../../_chunks/dep-732f0b7d.mjs';\nimport '../../_chunks/dep-03a7fb6c.mjs';\nimport '../../_chunks/dep-1b9718a2.mjs';\nimport '../../_chunks/dep-e065dc25.mjs';\nimport '../../_chunks/dep-400ec705.mjs';\nimport '../../_chunks/dep-02f9394e.mjs';\nimport '../../_chunks/dep-1725b1c7.mjs';\nimport '../../_chunks/dep-532409c5.mjs';\nimport '../../_common/js/global-config/default-config.mjs';\nimport '../../_common/js/global-config/locale/zh_CN.mjs';\nimport '../../_chunks/dep-9ed7da3e.mjs';\nimport '../../_chunks/dep-4f2cabb0.mjs';\nimport '../../config-provider/type.mjs';\nimport '../../_chunks/dep-b36eaefe.mjs';\nimport '../../_chunks/dep-2f6e28a0.mjs';\nimport '../../_chunks/dep-7af61576.mjs';\nimport '../../_chunks/dep-8dfc9324.mjs';\nimport '../../_chunks/dep-ab4bb9b8.mjs';\nimport '../../_common/js/log/index.mjs';\nimport '../../_common/js/log/log.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nvar TDateTable = defineComponent({\n  name: \"TDatePickerTable\",\n  props: {\n    mode: {\n      type: String,\n      \"default\": \"date\"\n    },\n    value: [String, Number, Array, Date],\n    format: String,\n    firstDayOfWeek: Number,\n    data: Array,\n    time: String,\n    onCellClick: Function,\n    onCellMouseEnter: Function,\n    onCellMouseLeave: Function\n  },\n  setup: function setup(props) {\n    var COMPONENT_NAME = usePrefixClass(\"date-picker__table\");\n    var _useConfig = useConfig(\"datePicker\"),\n      globalConfig = _useConfig.globalConfig;\n    var dayjsLocale = globalConfig.value.dayjsLocale;\n    var weekArr = computed(function () {\n      var weekArr2 = [];\n      var wi = props.firstDayOfWeek - 1;\n      var len = globalConfig.value.weekdays.length;\n      while (weekArr2.length < len) {\n        weekArr2.push(globalConfig.value.weekdays[wi]);\n        wi = (wi + len + 1) % len;\n      }\n      if (props.mode === \"week\") weekArr2.unshift(globalConfig.value.weekAbbreviation);\n      return weekArr2;\n    });\n    var showThead = computed(function () {\n      return props.mode === \"date\" || props.mode === \"week\";\n    });\n    var weekRowClass = function weekRowClass(value, format, targetValue) {\n      if (props.mode !== \"week\" || !value) return {};\n      if (isArray_1(value)) {\n        var _startObj$locale, _startObj$locale$week, _endObj$locale, _endObj$locale$week;\n        if (!value.length) return {};\n        var _value$map = value.map(function (v) {\n            return v && parseToDayjs(v, format);\n          }),\n          _value$map2 = _slicedToArray(_value$map, 2),\n          startObj = _value$map2[0],\n          endObj = _value$map2[1];\n        var startYear = startObj && startObj.year();\n        var startWeek = startObj === null || startObj === void 0 || (_startObj$locale = startObj.locale) === null || _startObj$locale === void 0 || (_startObj$locale = _startObj$locale.call(startObj, dayjsLocale)) === null || _startObj$locale === void 0 || (_startObj$locale$week = _startObj$locale.week) === null || _startObj$locale$week === void 0 ? void 0 : _startObj$locale$week.call(_startObj$locale);\n        var endYear = endObj && endObj.year();\n        var endWeek = endObj === null || endObj === void 0 || (_endObj$locale = endObj.locale) === null || _endObj$locale === void 0 || (_endObj$locale = _endObj$locale.call(endObj, dayjsLocale)) === null || _endObj$locale === void 0 || (_endObj$locale$week = _endObj$locale.week) === null || _endObj$locale$week === void 0 ? void 0 : _endObj$locale$week.call(_endObj$locale);\n        var targetObj = parseToDayjs(targetValue, format);\n        var targetYear = targetObj.year();\n        var targetWeek = targetObj.week();\n        var isActive = targetYear === startYear && targetWeek === startWeek || targetYear === endYear && targetWeek === endWeek;\n        var isRange = targetYear >= startYear && targetYear <= endYear && targetWeek > startWeek && targetWeek < endWeek;\n        return _defineProperty(_defineProperty({}, \"\".concat(COMPONENT_NAME.value, \"-\").concat(props.mode, \"-row--active\"), isActive), \"\".concat(COMPONENT_NAME.value, \"-\").concat(props.mode, \"-row--range\"), isRange);\n      }\n      return _defineProperty({}, \"\".concat(COMPONENT_NAME.value, \"-\").concat(props.mode, \"-row--active\"), parseToDayjs(value, format).locale(dayjsLocale).week() === parseToDayjs(targetValue, format).locale(dayjsLocale).week());\n    };\n    return function () {\n      return createVNode(\"div\", {\n        \"class\": COMPONENT_NAME.value,\n        \"onMouseleave\": function onMouseleave(e) {\n          var _props$onCellMouseLea;\n          return (_props$onCellMouseLea = props.onCellMouseLeave) === null || _props$onCellMouseLea === void 0 ? void 0 : _props$onCellMouseLea.call(props, {\n            e: e\n          });\n        }\n      }, [createVNode(\"table\", null, [showThead.value && createVNode(\"thead\", null, [createVNode(\"tr\", null, [weekArr.value.map(function (value, i) {\n        return createVNode(\"th\", {\n          \"key\": i\n        }, [value]);\n      })])]), createVNode(\"tbody\", null, [props.data.map(function (row, i) {\n        return createVNode(\"tr\", {\n          \"key\": i,\n          \"class\": _objectSpread(_defineProperty({}, \"\".concat(COMPONENT_NAME.value, \"-\").concat(props.mode, \"-row\"), true), weekRowClass(props.value, props.format, row[0].value))\n        }, [row.map(function (col, j) {\n          return createVNode(TDatePickerCell, mergeProps(col, {\n            \"key\": j,\n            \"time\": props.time,\n            \"onClick\": props.onCellClick,\n            \"onMouseEnter\": props.onCellMouseEnter\n          }), null);\n        })]);\n      })])])]);\n    };\n  }\n});\nexport { TDateTable as default };","map":{"version":3,"names":["TDateTable","defineComponent","name","props","mode","type","String","value","Number","Array","Date","format","firstDayOfWeek","data","time","onCellClick","Function","onCellMouseEnter","onCellMouseLeave","setup","COMPONENT_NAME","usePrefixClass","_useConfig","useConfig","globalConfig","dayjsLocale","weekArr","computed","weekArr2","wi","len","weekdays","length","push","unshift","weekAbbreviation","showThead","weekRowClass","targetValue","isArray_1","_startObj$locale","_startObj$locale$week","_endObj$locale","_endObj$locale$week","_value$map","map","v","parseToDayjs","_value$map2","_slicedToArray","startObj","endObj","startYear","year","startWeek","locale","call","week","endYear","endWeek","targetObj","targetYear","targetWeek","isActive","isRange","_defineProperty","concat","createVNode","onMouseleave","e","_props$onCellMouseLea","i","row","_objectSpread","col","j"],"sources":["../../../src/date-picker/base/Table.tsx"],"sourcesContent":["import { defineComponent, PropType, computed } from 'vue';\nimport TDatePickerCell from './Cell';\nimport { useConfig, usePrefixClass } from '../../hooks/useConfig';\nimport type { TdDatePickerProps } from '../type';\nimport { parseToDayjs } from '../../_common/js/date-picker/format';\nimport isArray from 'lodash/isArray';\n\nexport default defineComponent({\n  name: 'TDatePickerTable',\n  props: {\n    mode: {\n      type: String as PropType<TdDatePickerProps['mode']>,\n      default: 'date',\n    },\n    value: [String, Number, Array, Date],\n    format: String,\n    firstDayOfWeek: Number,\n    data: Array,\n    time: String,\n    onCellClick: Function,\n    onCellMouseEnter: Function,\n    onCellMouseLeave: Function,\n  },\n  setup(props) {\n    const COMPONENT_NAME = usePrefixClass('date-picker__table');\n    const { globalConfig } = useConfig('datePicker');\n    const { dayjsLocale } = globalConfig.value;\n\n    const weekArr = computed(() => {\n      const weekArr = [];\n      let wi = props.firstDayOfWeek - 1;\n      const len = globalConfig.value.weekdays.length;\n      while (weekArr.length < len) {\n        weekArr.push(globalConfig.value.weekdays[wi]);\n        wi = (wi + len + 1) % len;\n      }\n\n      if (props.mode === 'week') weekArr.unshift(globalConfig.value.weekAbbreviation);\n\n      return weekArr;\n    });\n\n    const showThead = computed(() => props.mode === 'date' || props.mode === 'week');\n\n    // 高亮周区间\n    const weekRowClass = (value: any, format: string, targetValue: Date) => {\n      if (props.mode !== 'week' || !value) return {};\n\n      if (isArray(value)) {\n        if (!value.length) return {};\n        const [startObj, endObj] = value.map((v) => v && parseToDayjs(v, format));\n        const startYear = startObj && startObj.year();\n        const startWeek = startObj?.locale?.(dayjsLocale)?.week?.();\n        const endYear = endObj && endObj.year();\n        const endWeek = endObj?.locale?.(dayjsLocale)?.week?.();\n\n        const targetObj = parseToDayjs(targetValue, format);\n        const targetYear = targetObj.year();\n        const targetWeek = targetObj.week();\n        const isActive =\n          (targetYear === startYear && targetWeek === startWeek) || (targetYear === endYear && targetWeek === endWeek);\n        const isRange =\n          targetYear >= startYear && targetYear <= endYear && targetWeek > startWeek && targetWeek < endWeek;\n        return {\n          // 同年同周\n          [`${COMPONENT_NAME.value}-${props.mode}-row--active`]: isActive,\n          [`${COMPONENT_NAME.value}-${props.mode}-row--range`]: isRange,\n        };\n      }\n\n      return {\n        [`${COMPONENT_NAME.value}-${props.mode}-row--active`]:\n          parseToDayjs(value, format).locale(dayjsLocale).week() ===\n          parseToDayjs(targetValue, format).locale(dayjsLocale).week(),\n      };\n    };\n\n    return () => (\n      <div class={COMPONENT_NAME.value} onMouseleave={(e: MouseEvent) => props.onCellMouseLeave?.({ e })}>\n        <table>\n          {showThead.value && (\n            <thead>\n              <tr>\n                {weekArr.value.map((value: string, i: number) => (\n                  <th key={i}>{value}</th>\n                ))}\n              </tr>\n            </thead>\n          )}\n          <tbody>\n            {props.data.map((row: Array<any>, i: number) => (\n              <tr\n                key={i}\n                class={{\n                  [`${COMPONENT_NAME.value}-${props.mode}-row`]: true,\n                  ...weekRowClass(props.value, props.format, row[0].value),\n                }}\n              >\n                {row.map((col: any, j: number) => (\n                  <TDatePickerCell\n                    {...col}\n                    key={j}\n                    time={props.time}\n                    onClick={props.onCellClick}\n                    onMouseEnter={props.onCellMouseEnter}\n                  />\n                ))}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    );\n  },\n});\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA,IAAAA,UAAA,GAAeC,eAAgB;EAC7BC,IAAM;EACNC,KAAO;IACLC,IAAM;MACJC,IAAM,EAAAC,MAAA;MACN,SAAS;KACX;IACAC,KAAO,GAACD,MAAQ,EAAAE,MAAA,EAAQC,KAAA,EAAOC,IAAI;IACnCC,MAAQ,EAAAL,MAAA;IACRM,cAAgB,EAAAJ,MAAA;IAChBK,IAAM,EAAAJ,KAAA;IACNK,IAAM,EAAAR,MAAA;IACNS,WAAa,EAAAC,QAAA;IACbC,gBAAkB,EAAAD,QAAA;IAClBE,gBAAkB,EAAAF;GACpB;EACAG,KAAA,WAAAA,MAAMhB,KAAO;IACL,IAAAiB,cAAA,GAAiBC,cAAA,CAAe,oBAAoB;IAC1D,IAAAC,UAAA,GAAyBC,SAAA,CAAU,YAAY;MAAvCC,YAAA,GAAAF,UAAA,CAAAE,YAAA;IACF,IAAEC,WAAY,GAAID,YAAa,CAAAjB,KAAA,CAA7BkB,WAAY;IAEd,IAAAC,OAAA,GAAUC,QAAA,CAAS,YAAM;MAC7B,IAAMC,QAAA,GAAU,EAAC;MACb,IAAAC,EAAA,GAAK1B,KAAA,CAAMS,cAAiB;MAC1B,IAAAkB,GAAA,GAAMN,YAAa,CAAAjB,KAAA,CAAMwB,QAAS,CAAAC,MAAA;MACjC,OAAAJ,QAAA,CAAQI,MAAA,GAASF,GAAK;QAC3BF,QAAQ,CAAAK,IAAA,CAAKT,YAAa,CAAAjB,KAAA,CAAMwB,QAAA,CAASF,EAAG;QACtCA,EAAA,IAAAA,EAAA,GAAKC,GAAA,GAAM,CAAK,IAAAA,GAAA;MACxB;MAEA,IAAI3B,KAAA,CAAMC,IAAS,aAAQwB,QAAQ,CAAAM,OAAA,CAAQV,YAAa,CAAAjB,KAAA,CAAM4B,gBAAgB;MAEvE,OAAAP,QAAA;IACT,CAAC;IAEK,IAAAQ,SAAA,GAAYT,QAAA,CAAS;MAAA,OAAMxB,KAAA,CAAMC,IAAA,KAAS,MAAU,IAAAD,KAAA,CAAMC,IAAA,KAAS,MAAM;KAAA;IAG/E,IAAMiC,YAAe,YAAfA,YAAeA,CAAC9B,KAAY,EAAAI,MAAA,EAAgB2B,WAAsB;MAClE,IAAAnC,KAAA,CAAMC,IAAS,eAAU,CAACG,KAAA,EAAO,OAAO,EAAC;MAEzC,IAAAgC,SAAA,CAAQhC,KAAK,CAAG;QAAA,IAAAiC,gBAAA,EAAAC,qBAAA,EAAAC,cAAA,EAAAC,mBAAA;QAClB,IAAI,CAACpC,KAAM,CAAAyB,MAAA,EAAQ,OAAO,EAAC;QAC3B,IAAAY,UAAA,GAA2BrC,KAAM,CAAAsC,GAAA,CAAI,UAACC,CAAA;YAAA,OAAMA,CAAK,IAAAC,YAAA,CAAaD,CAAG,EAAAnC,MAAM,CAAC;WAAA;UAAAqC,WAAA,GAAAC,cAAA,CAAAL,UAAA;UAAjEM,QAAA,GAAAF,WAAA;UAAUG,MAAM,GAAAH,WAAA;QACjB,IAAAI,SAAA,GAAYF,QAAY,IAAAA,QAAA,CAASG,IAAK;QAC5C,IAAMC,SAAY,GAAAJ,QAAA,aAAAA,QAAA,gBAAAV,gBAAA,GAAAU,QAAA,CAAUK,MAAS,cAAAf,gBAAA,gBAAAA,gBAAA,GAAnBA,gBAAA,CAAAgB,IAAA,CAAAN,QAAA,EAAmBzB,WAAW,eAAAe,gBAAA,gBAAAC,qBAAA,GAA9BD,gBAAA,CAAiCiB,IAAO,cAAAhB,qBAAA,KAAxC,kBAAAA,qBAAA,CAAAe,IAAA,CAAAhB,gBAAwC;QACpD,IAAAkB,OAAA,GAAUP,MAAU,IAAAA,MAAA,CAAOE,IAAK;QACtC,IAAMM,OAAU,GAAAR,MAAA,aAAAA,MAAA,gBAAAT,cAAA,GAAAS,MAAA,CAAQI,MAAS,cAAAb,cAAA,gBAAAA,cAAA,GAAjBA,cAAA,CAAAc,IAAA,CAAAL,MAAA,EAAiB1B,WAAW,eAAAiB,cAAA,gBAAAC,mBAAA,GAA5BD,cAAA,CAA+Be,IAAO,cAAAd,mBAAA,KAAtC,kBAAAA,mBAAA,CAAAa,IAAA,CAAAd,cAAsC;QAEhD,IAAAkB,SAAA,GAAYb,YAAa,CAAAT,WAAA,EAAa3B,MAAM;QAC5C,IAAAkD,UAAA,GAAaD,SAAA,CAAUP,IAAK;QAC5B,IAAAS,UAAA,GAAaF,SAAA,CAAUH,IAAK;QAClC,IAAMM,QAAA,GACHF,UAAe,KAAAT,SAAA,IAAaU,UAAA,KAAeR,SAAe,IAAAO,UAAA,KAAeH,OAAA,IAAWI,UAAe,KAAAH,OAAA;QACtG,IAAMK,OAAA,GACJH,UAAc,IAAAT,SAAA,IAAaS,UAAA,IAAcH,OAAW,IAAAI,UAAA,GAAaR,SAAA,IAAaQ,UAAa,GAAAH,OAAA;QACtF,OAAAM,eAAA,CAAAA,eAAA,QAAAC,MAAA,CAED9C,cAAe,CAAAb,KAAA,OAAA2D,MAAA,CAAS/D,KAAA,CAAMC,IAAqB,mBAAA2D,QAAA,MAAAG,MAAA,CACnD9C,cAAe,CAAAb,KAAA,OAAA2D,MAAA,CAAS/D,KAAA,CAAMC,IAAoB,kBAAA4D,OAAA;MAE1D;MAEO,OAAAC,eAAA,QAAAC,MAAA,CACD9C,cAAe,CAAAb,KAAA,OAAA2D,MAAA,CAAS/D,KAAA,CAAMC,IAChC,mBAAA2C,YAAA,CAAaxC,KAAO,EAAAI,MAAM,CAAE,CAAA4C,MAAA,CAAO9B,WAAW,CAAE,CAAAgC,IAAA,OAChDV,YAAa,CAAAT,WAAA,EAAa3B,MAAM,CAAE,CAAA4C,MAAA,CAAO9B,WAAW,EAAEgC,IAAK;KAEjE;IAEA,OAAO;MAAA,OAAAU,WAAA;QAAA,OACO,EAAA/C,cAAA,CAAeb,KAAO;QAAA,cAAc,WAAA6D,aAACC,CAAA;UAAA,IAAAC,qBAAA;UAAA,QAAAA,qBAAA,GAAkBnE,KAAA,CAAMe,gBAAmB,cAAAoD,qBAAA,uBAAzBA,qBAAA,CAAAd,IAAA,CAAArD,KAAA,EAAyB;YAAEkE,CAAE,EAAFA;UAAE,CAAC;;sBAE5F,gBAAAjC,SAAA,CAAU7B,KAAA,IAAA4D,WAAA,iBAAAA,WAAA,cAGJzC,OAAA,CAAQnB,KAAM,CAAAsC,GAAA,CAAI,UAACtC,KAAA,EAAegE,CAAA;;eACxB,EAAAA;QAAI,IAAAhE,KAAA;MAAA,CACd,KAJJ,EAAA4D,WAAA,iBASAhE,KAAM,CAAAU,IAAA,CAAKgC,GAAI,WAAC2B,GAAiB,EAAAD,CAAA;QAAA,OAAAJ,WAAA;UAAA,OAEzBI,CAAA;UAAA,SAAAE,aAAA,CAAAR,eAAA,QAAAC,MAAA,CAEC9C,cAAe,CAAAb,KAAA,OAAA2D,MAAA,CAAS/D,KAAA,CAAMC,IAAa,gBAC5C,EAAAiC,YAAA,CAAalC,KAAM,CAAAI,KAAA,EAAOJ,KAAA,CAAMQ,MAAQ,EAAA6D,GAAA,CAAI,GAAGjE,KAAK;QAAA,IAGxDiE,GAAI,CAAA3B,GAAA,CAAI,UAAC6B,GAAA,EAAUC,CAAA;yDAEZD,GACJ;YAAA,OAAKC,CACL;YAAA,MAAM,EAAAxE,KAAA,CAAMW,IACZ;YAAA,SAAS,EAAAX,KAAM,CAAAY,WAAA;YAAA,gBACDZ,KAAA,CAAMc;UACtB;QAAA,CACD,CACH;MAAA,CACD;KA9BN;EAmCL;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}