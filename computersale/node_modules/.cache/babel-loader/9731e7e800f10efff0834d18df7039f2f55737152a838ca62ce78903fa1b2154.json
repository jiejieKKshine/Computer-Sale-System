{"ast":null,"code":"/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _slicedToArray } from '../../_chunks/dep-5efe53d1.mjs';\nimport '../adapt.mjs';\nimport { getNode, pathMatchClass } from '../util.mjs';\nimport { usePrefixClass } from '../../hooks/useConfig.mjs';\nimport '../../_chunks/dep-593f2b67.mjs';\nimport 'vue';\nimport '../../utils/withInstall.mjs';\nimport '../../hooks/useVModel.mjs';\nimport '../../_chunks/dep-bad871d5.mjs';\nimport '../../_chunks/dep-eca422c3.mjs';\nimport '../../_chunks/dep-5a17bf21.mjs';\nimport '../../_chunks/dep-7932c2e8.mjs';\nimport '../../_chunks/dep-bf7257e7.mjs';\nimport '../../_chunks/dep-4659d73b.mjs';\nimport '../../_chunks/dep-eae2a67e.mjs';\nimport '../../_chunks/dep-626c497d.mjs';\nimport '../../_chunks/dep-ab4bb9b8.mjs';\nimport '../../_chunks/dep-29ef8419.mjs';\nimport '../../hooks/useDefaultValue.mjs';\nimport 'tdesign-icons-vue-next';\nimport '../../checkbox/index.mjs';\nimport '../../checkbox/checkbox.mjs';\nimport '../../_chunks/dep-fa52aa21.mjs';\nimport '../../_chunks/dep-03a7fb6c.mjs';\nimport '../../checkbox/props.mjs';\nimport '../../hooks/useRipple.mjs';\nimport '../../hooks/useKeepAnimation.mjs';\nimport '../../_chunks/dep-1b9718a2.mjs';\nimport '../../_chunks/dep-92f86d1d.mjs';\nimport '../../_chunks/dep-6ab5363f.mjs';\nimport '../../_chunks/dep-6dc3d0e1.mjs';\nimport '../../_chunks/dep-06dcbf4c.mjs';\nimport '../../_chunks/dep-2b09875b.mjs';\nimport '../../_chunks/dep-cda4f568.mjs';\nimport '../../_chunks/dep-76958824.mjs';\nimport '../../_chunks/dep-e9841b9e.mjs';\nimport '../../_chunks/dep-1a4bb2f2.mjs';\nimport '../../_chunks/dep-cc8ebcde.mjs';\nimport '../../_chunks/dep-f5579c03.mjs';\nimport '../../_chunks/dep-49aeee3c.mjs';\nimport '../../_chunks/dep-b5bf85f5.mjs';\nimport '../../_chunks/dep-3c65fae8.mjs';\nimport '../../_chunks/dep-ec0bbd9f.mjs';\nimport '../../_chunks/dep-e065dc25.mjs';\nimport '../../_chunks/dep-400ec705.mjs';\nimport '../../_chunks/dep-02f9394e.mjs';\nimport '../../_chunks/dep-1725b1c7.mjs';\nimport '../../_chunks/dep-532409c5.mjs';\nimport '../../_common/js/global-config/default-config.mjs';\nimport '../../_common/js/global-config/locale/zh_CN.mjs';\nimport '../../_chunks/dep-9ed7da3e.mjs';\nimport '../../_chunks/dep-7f65fc46.mjs';\nimport '../../_chunks/dep-4f2cabb0.mjs';\nimport '../../config-provider/useConfig.mjs';\nimport '../../_chunks/dep-bb899bfd.mjs';\nimport '../../_chunks/dep-5922c8f3.mjs';\nimport '../../_chunks/dep-1b78414a.mjs';\nimport '../../_chunks/dep-d84f19b3.mjs';\nimport '../../_chunks/dep-732f0b7d.mjs';\nimport '../../config-provider/type.mjs';\nimport '../../utils/set-style.mjs';\nimport '../../hooks/tnode.mjs';\nimport '../../_chunks/dep-03ad9cda.mjs';\nimport '../../_chunks/dep-d8a34055.mjs';\nimport '../../_chunks/dep-2f6e28a0.mjs';\nimport '../../utils/render-tnode.mjs';\nimport '../../_chunks/dep-b91a8171.mjs';\nimport '../../checkbox/constants.mjs';\nimport '../../checkbox/hooks/useCheckboxLazyLoad.mjs';\nimport '../../_common/js/utils/observe.mjs';\nimport '../../checkbox/hooks/useKeyboardEvent.mjs';\nimport '../../_common/js/common.mjs';\nimport '../../hooks/useDisabled.mjs';\nimport '../../_chunks/dep-df472119.mjs';\nimport '../../hooks/useReadonly.mjs';\nimport '../../checkbox/group.mjs';\nimport '../../_chunks/dep-4a990ea3.mjs';\nimport '../../_chunks/dep-64c2053b.mjs';\nimport '../../_chunks/dep-4d4e2af1.mjs';\nimport '../../_chunks/dep-3c4e4325.mjs';\nimport '../../_chunks/dep-58a62202.mjs';\nimport '../../checkbox/checkbox-group-props.mjs';\nimport '../../hooks/slot.mjs';\nimport './style/css.mjs';\nimport '../../checkbox/type.mjs';\nimport '../../loading/index.mjs';\nimport '../../_chunks/dep-bff7e93a.mjs';\nimport '../../_chunks/dep-0b414bea.mjs';\nimport '../../_chunks/dep-fbd4eddb.mjs';\nimport '../../_chunks/dep-ae202bc0.mjs';\nimport '../../_chunks/dep-aeaef131.mjs';\nimport '../../_chunks/dep-69e0f6fc.mjs';\nimport '../../_chunks/dep-ea20409b.mjs';\nimport '../../loading/plugin.mjs';\nimport '../../loading/loading.mjs';\nimport '../../loading/icon/gradient.mjs';\nimport '../../_common/js/loading/circle-adapter.mjs';\nimport '../../_common/js/utils/set-style.mjs';\nimport '../../_common/js/utils/helper.mjs';\nimport '../../_chunks/dep-5d3f7c0e.mjs';\nimport '../../_chunks/dep-73384992.mjs';\nimport '../../_chunks/dep-889e457b.mjs';\nimport '../../utils/dom.mjs';\nimport '../../utils/easing.mjs';\nimport '../../loading/props.mjs';\nimport '../../hooks/useTeleport.mjs';\nimport '../../loading/type.mjs';\nimport '../../hooks/useGlobalIcon.mjs';\nimport '../../hooks/useLazyLoad.mjs';\nimport '../../hooks/useVirtualScrollNew.mjs';\nimport '../../hooks/useResizeObserver.mjs';\nimport '../../_chunks/dep-525a54df.mjs';\nimport '../../_chunks/dep-5993931e.mjs';\nimport '../../_chunks/dep-8dfc9324.mjs';\nimport '../../_common/js/tree/tree-node.mjs';\nimport '../../_chunks/dep-0d047dce.mjs';\nimport '../../_chunks/dep-f909a041.mjs';\nimport '../../_chunks/dep-e4a8ef7d.mjs';\nimport '../../_chunks/dep-d2f4e062.mjs';\nimport '../../_common/js/tree/tree-node-model.mjs';\nimport '../../_chunks/dep-88ae49da.mjs';\nimport '../../_chunks/dep-88c8d9ed.mjs';\nimport '../../_chunks/dep-4ec29b23.mjs';\nimport '../../_common/js/log/log.mjs';\nimport '../../_common/js/log/index.mjs';\nfunction useTreeAction(state) {\n  var treeState = state;\n  var store = treeState.store;\n  var componentName = usePrefixClass(\"tree\").value;\n  var _state$vmValue = _slicedToArray(state.vmValue, 2),\n    tValue = _state$vmValue[0],\n    setTValue = _state$vmValue[1];\n  var _state$vmActived = _slicedToArray(state.vmActived, 2),\n    tActived = _state$vmActived[0],\n    setTActived = _state$vmActived[1];\n  var _state$vmExpanded = _slicedToArray(state.vmExpanded, 2),\n    tExpanded = _state$vmExpanded[0],\n    setTExpanded = _state$vmExpanded[1];\n  var setExpanded = function setExpanded(item, isExpanded) {\n    var node = getNode(store, item);\n    var mouseEvent = treeState.mouseEvent;\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: \"setItem\"\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = \"node-click\";\n      var target = mouseEvent.target;\n      var currentTarget = mouseEvent.currentTarget;\n      if (pathMatchClass(\"\".concat(componentName, \"__icon\"), target, currentTarget)) {\n        evtCtx.trigger = \"icon-click\";\n      }\n    }\n    var expanded = node.setExpanded(isExpanded, {\n      directly: true\n    });\n    setTExpanded(expanded, evtCtx);\n    if (evtCtx.trigger !== \"setItem\") {\n      store.replaceExpanded(tExpanded.value || []);\n    }\n    return expanded;\n  };\n  var toggleExpanded = function toggleExpanded(item) {\n    var node = getNode(store, item);\n    if (!node.children) return;\n    return setExpanded(node, !node.isExpanded());\n  };\n  var setActived = function setActived(item, isActived) {\n    var node = getNode(store, item);\n    var mouseEvent = treeState.mouseEvent;\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: \"setItem\"\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = \"node-click\";\n    }\n    var actived = node.setActived(isActived, {\n      isAction: evtCtx.trigger === \"node-click\",\n      directly: true\n    });\n    setTActived(actived, evtCtx);\n    if (evtCtx.trigger !== \"setItem\") {\n      store.replaceActived(tActived.value || []);\n    }\n    return actived;\n  };\n  var toggleActived = function toggleActived(item) {\n    var node = getNode(store, item);\n    return setActived(node, !node.isActived());\n  };\n  var setChecked = function setChecked(item, isChecked, ctx) {\n    var node = getNode(store, item);\n    var mouseEvent = ctx === null || ctx === void 0 ? void 0 : ctx.e;\n    var evtCtx = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: \"setItem\"\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = \"node-click\";\n    }\n    var checked = node.setChecked(isChecked, {\n      isAction: evtCtx.trigger === \"node-click\",\n      directly: true\n    });\n    setTValue(checked, evtCtx);\n    if (evtCtx.trigger !== \"setItem\") {\n      store.replaceChecked(tValue.value || []);\n    }\n    return checked;\n  };\n  var toggleChecked = function toggleChecked(item, ctx) {\n    var node = getNode(store, item);\n    if (node.isIndeterminate()) {\n      var expectState = node.hasEnableUnCheckedChild();\n      return setChecked(node, expectState, ctx);\n    }\n    return setChecked(node, !node.isChecked(), ctx);\n  };\n  return {\n    setExpanded: setExpanded,\n    toggleExpanded: toggleExpanded,\n    setActived: setActived,\n    toggleActived: toggleActived,\n    setChecked: setChecked,\n    toggleChecked: toggleChecked\n  };\n}\nexport { useTreeAction as default };","map":{"version":3,"names":["useTreeAction","state","treeState","store","componentName","usePrefixClass","value","_state$vmValue","_slicedToArray","vmValue","tValue","setTValue","_state$vmActived","vmActived","tActived","setTActived","_state$vmExpanded","vmExpanded","tExpanded","setTExpanded","setExpanded","item","isExpanded","node","getNode","mouseEvent","evtCtx","getModel","e","trigger","target","currentTarget","pathMatchClass","concat","expanded","directly","replaceExpanded","toggleExpanded","children","setActived","isActived","actived","isAction","replaceActived","toggleActived","setChecked","isChecked","ctx","checked","replaceChecked","toggleChecked","isIndeterminate","expectState","hasEnableUnCheckedChild"],"sources":["../../../src/tree/hooks/useTreeAction.ts"],"sourcesContent":["import { usePrefixClass } from '../adapt';\nimport {\n  TreeNodeValue,\n  TypeTreeState,\n  TypeTargetNode,\n  TypeExpandEventContext,\n  TypeActiveEventContext,\n  TypeChangeEventContext,\n} from '../tree-types';\nimport { getNode, pathMatchClass } from '../util';\n\n// tree 组件节点状态设置\nexport default function useTreeAction(state: TypeTreeState) {\n  const treeState = state;\n  const { store } = treeState;\n  const componentName = usePrefixClass('tree').value;\n\n  const [tValue, setTValue] = state.vmValue;\n  const [tActived, setTActived] = state.vmActived;\n  const [tExpanded, setTExpanded] = state.vmExpanded;\n\n  const setExpanded = (item: TypeTargetNode, isExpanded: boolean): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    const mouseEvent = treeState.mouseEvent as MouseEvent;\n    const evtCtx: TypeExpandEventContext = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: 'setItem',\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = 'node-click';\n      const target = mouseEvent.target as HTMLElement;\n      const currentTarget = mouseEvent.currentTarget as HTMLElement;\n      if (pathMatchClass(`${componentName}__icon`, target, currentTarget)) {\n        evtCtx.trigger = 'icon-click';\n      }\n    }\n    const expanded = node.setExpanded(isExpanded, {\n      directly: true,\n    });\n    setTExpanded(expanded, evtCtx);\n    if (evtCtx.trigger !== 'setItem') {\n      store.replaceExpanded((tExpanded.value || []) as TreeNodeValue[]);\n    }\n    return expanded;\n  };\n\n  const toggleExpanded = (item: TypeTargetNode): TreeNodeValue[] => {\n    const node = getNode(store, item);\n\n    if (!node.children) return;\n\n    return setExpanded(node, !node.isExpanded());\n  };\n\n  const setActived = (item: TypeTargetNode, isActived: boolean) => {\n    const node = getNode(store, item);\n    const mouseEvent = treeState.mouseEvent as MouseEvent;\n    const evtCtx: TypeActiveEventContext = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: 'setItem',\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = 'node-click';\n    }\n    const actived = node.setActived(isActived, {\n      isAction: evtCtx.trigger === 'node-click',\n      directly: true,\n    });\n    setTActived(actived, evtCtx);\n    if (evtCtx.trigger !== 'setItem') {\n      store.replaceActived((tActived.value || []) as TreeNodeValue[]);\n    }\n    return actived;\n  };\n\n  const toggleActived = (item: TypeTargetNode): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    return setActived(node, !node.isActived());\n  };\n\n  const setChecked = (item: TypeTargetNode, isChecked: boolean, ctx: { e: Event }): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    const mouseEvent = ctx?.e as MouseEvent;\n    const evtCtx: TypeChangeEventContext = {\n      node: node.getModel(),\n      e: mouseEvent,\n      trigger: 'setItem',\n    };\n    if (mouseEvent) {\n      evtCtx.trigger = 'node-click';\n    }\n    const checked = node.setChecked(isChecked, {\n      isAction: evtCtx.trigger === 'node-click',\n      directly: true,\n    });\n    setTValue(checked, evtCtx);\n    // 这是针对受控执行的操作，如果 props.value 未变更，则执行还原操作\n    if (evtCtx.trigger !== 'setItem') {\n      store.replaceChecked((tValue.value || []) as TreeNodeValue[]);\n    }\n    return checked;\n  };\n\n  const toggleChecked = (item: TypeTargetNode, ctx: { e: Event }): TreeNodeValue[] => {\n    const node = getNode(store, item);\n    if (node.isIndeterminate()) {\n      const expectState = node.hasEnableUnCheckedChild();\n      return setChecked(node, expectState, ctx);\n    }\n    return setChecked(node, !node.isChecked(), ctx);\n  };\n\n  return {\n    setExpanded,\n    toggleExpanded,\n    setActived,\n    toggleActived,\n    setChecked,\n    toggleChecked,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}