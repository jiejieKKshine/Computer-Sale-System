{"ast":null,"code":"/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { ref, getCurrentInstance, inject, computed, h, provide } from 'vue';\nimport { i as isFunction_1 } from '../_chunks/dep-06dcbf4c.mjs';\nimport { c as cloneDeep_1 } from '../_chunks/dep-bb899bfd.mjs';\nimport { i as isString_1 } from '../_chunks/dep-03a7fb6c.mjs';\nimport { c as configProviderInjectKey, d as defaultGlobalConfig, a as mergeWith } from '../_chunks/dep-1b9718a2.mjs';\nimport './type.mjs';\nimport '../_chunks/dep-eca422c3.mjs';\nimport '../_chunks/dep-bf7257e7.mjs';\nimport '../_chunks/dep-4659d73b.mjs';\nimport '../_chunks/dep-2b09875b.mjs';\nimport '../_chunks/dep-cda4f568.mjs';\nimport '../_chunks/dep-5922c8f3.mjs';\nimport '../_chunks/dep-92f86d1d.mjs';\nimport '../_chunks/dep-6ab5363f.mjs';\nimport '../_chunks/dep-6dc3d0e1.mjs';\nimport '../_chunks/dep-76958824.mjs';\nimport '../_chunks/dep-e9841b9e.mjs';\nimport '../_chunks/dep-1a4bb2f2.mjs';\nimport '../_chunks/dep-cc8ebcde.mjs';\nimport '../_chunks/dep-29ef8419.mjs';\nimport '../_chunks/dep-f5579c03.mjs';\nimport '../_chunks/dep-49aeee3c.mjs';\nimport '../_chunks/dep-b5bf85f5.mjs';\nimport '../_chunks/dep-3c65fae8.mjs';\nimport '../_chunks/dep-eae2a67e.mjs';\nimport '../_chunks/dep-626c497d.mjs';\nimport '../_chunks/dep-ec0bbd9f.mjs';\nimport '../_chunks/dep-1b78414a.mjs';\nimport '../_chunks/dep-d84f19b3.mjs';\nimport '../_chunks/dep-732f0b7d.mjs';\nimport '../_chunks/dep-e065dc25.mjs';\nimport '../_chunks/dep-400ec705.mjs';\nimport '../_chunks/dep-02f9394e.mjs';\nimport '../_chunks/dep-1725b1c7.mjs';\nimport '../_chunks/dep-532409c5.mjs';\nimport '../_common/js/global-config/default-config.mjs';\nimport '../_common/js/global-config/locale/zh_CN.mjs';\nimport '../_chunks/dep-9ed7da3e.mjs';\nimport '../_chunks/dep-7f65fc46.mjs';\nimport '../_chunks/dep-4f2cabb0.mjs';\nvar globalConfigCopy = ref();\nfunction useConfig() {\n  var componentName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : void 0;\n  var componentLocale = arguments.length > 1 ? arguments[1] : undefined;\n  var injectGlobalConfig = getCurrentInstance() ? inject(configProviderInjectKey, null) : globalConfigCopy;\n  var mergedGlobalConfig = computed(function () {\n    return (injectGlobalConfig === null || injectGlobalConfig === void 0 ? void 0 : injectGlobalConfig.value) || defaultGlobalConfig;\n  });\n  var globalConfig = computed(function () {\n    return Object.assign({}, mergedGlobalConfig.value[componentName], componentLocale);\n  });\n  var classPrefix = computed(function () {\n    return mergedGlobalConfig.value.classPrefix;\n  });\n  var t = function t(pattern) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    var data = args[0];\n    if (isString_1(pattern)) {\n      if (!data) return pattern;\n      var regular = /\\{\\s*([\\w-]+)\\s*\\}/g;\n      var translated = pattern.replace(regular, function (match, key) {\n        if (data) {\n          return String(data[key]);\n        }\n        return \"\";\n      });\n      return translated;\n    }\n    if (isFunction_1(pattern)) {\n      if (!args.length) return pattern(h);\n      return pattern.apply(void 0, args);\n    }\n    return \"\";\n  };\n  return {\n    t: t,\n    global: globalConfig,\n    globalConfig: globalConfig,\n    classPrefix: classPrefix\n  };\n}\nvar provideConfig = function provideConfig(props) {\n  var defaultData = cloneDeep_1(defaultGlobalConfig);\n  var mergedGlobalConfig = computed(function () {\n    return Object.assign({}, mergeWith(defaultData, props.globalConfig));\n  });\n  provide(configProviderInjectKey, mergedGlobalConfig);\n  if (!globalConfigCopy.value) {\n    globalConfigCopy.value = mergedGlobalConfig.value;\n  }\n  return mergedGlobalConfig;\n};\nexport { provideConfig, useConfig };","map":{"version":3,"names":["globalConfigCopy","ref","useConfig","componentName","arguments","length","undefined","componentLocale","injectGlobalConfig","getCurrentInstance","inject","configProviderInjectKey","mergedGlobalConfig","computed","value","defaultGlobalConfig","globalConfig","Object","assign","classPrefix","t","pattern","_len","args","Array","_key","data","isString_1","regular","translated","replace","match","key","String","isFunction_1","h","apply","global","provideConfig","props","defaultData","cloneDeep_1","mergeWith","provide"],"sources":["../../src/config-provider/useConfig.tsx"],"sourcesContent":["import { computed, h, inject, getCurrentInstance, ref, provide } from 'vue';\nimport isFunction from 'lodash/isFunction';\nimport cloneDeep from 'lodash/cloneDeep';\nimport isString from 'lodash/isString';\n\nimport { defaultGlobalConfig, configProviderInjectKey, mergeWith } from './context';\nimport { GlobalConfigProvider } from './type';\nimport type { ConfigProviderProps } from './config-provider';\n\n// 这是为了解决在非component里调用useConfig hook时发出的警告\n// https://github.com/Tencent/tdesign-vue-next/issues/2025\nconst globalConfigCopy = ref<GlobalConfigProvider>();\n\nexport * from './type';\n\n/**\n * component globalConfig\n * @param componentName\n * @returns {t, globalConfig}\n * useConfig('pagination')\n */\nexport function useConfig<T extends keyof GlobalConfigProvider>(\n  componentName: T = undefined,\n  componentLocale?: GlobalConfigProvider[T],\n) {\n  const injectGlobalConfig = getCurrentInstance() ? inject(configProviderInjectKey, null) : globalConfigCopy;\n  const mergedGlobalConfig = computed(() => injectGlobalConfig?.value || defaultGlobalConfig);\n  const globalConfig = computed(() => Object.assign({}, mergedGlobalConfig.value[componentName], componentLocale));\n\n  const classPrefix = computed(() => {\n    return mergedGlobalConfig.value.classPrefix;\n  });\n\n  // 处理正则表达式\n  const t = function <T>(pattern: T, ...args: any[]) {\n    const [data] = args;\n    if (isString(pattern)) {\n      if (!data) return pattern;\n      const regular = /\\{\\s*([\\w-]+)\\s*\\}/g;\n      const translated = pattern.replace(regular, (match, key) => {\n        if (data) {\n          return String(data[key]);\n        }\n        return '';\n      });\n      return translated;\n    }\n    if (isFunction(pattern)) {\n      // 重要：组件的渲染必须存在参数 h，不能移除\n      if (!args.length) return pattern(h);\n      return pattern(...args);\n    }\n    return '';\n  };\n\n  return {\n    t,\n    global: globalConfig,\n    globalConfig,\n    classPrefix,\n  };\n}\n\n/**\n * provide globalConfig\n * @param {ConfigProviderProps} props\n * @returns {ComputedRef<GlobalConfigProvider>}\n */\nexport const provideConfig = (props: ConfigProviderProps) => {\n  const defaultData = cloneDeep(defaultGlobalConfig);\n  const mergedGlobalConfig = computed(() =>\n    Object.assign({}, mergeWith(defaultData as unknown as GlobalConfigProvider, props.globalConfig)),\n  );\n\n  provide(configProviderInjectKey, mergedGlobalConfig);\n\n  if (!globalConfigCopy.value) {\n    globalConfigCopy.value = mergedGlobalConfig.value;\n  }\n\n  return mergedGlobalConfig;\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWA,IAAMA,gBAAA,GAAmBC,GAA0B;AAUnC,SAAAC,UAAA,EAGd;EAAA,IAFAC,aAAmB,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA;EAAA,IACnBG,eACA,GAAAH,SAAA,CAAAC,MAAA,OAAAD,SAAA,MAAAE,SAAA;EACA,IAAME,kBAAA,GAAqBC,kBAAmB,KAAIC,MAAO,CAAAC,uBAAA,EAAyB,IAAI,CAAI,GAAAX,gBAAA;EAC1F,IAAMY,kBAAqB,GAAAC,QAAA,CAAS;IAAA,OAAM,CAAAL,kBAAA,aAAAA,kBAAA,uBAAAA,kBAAA,CAAoBM,KAAA,KAASC,mBAAmB;GAAA;EACpF,IAAAC,YAAA,GAAeH,QAAS;IAAA,OAAMI,MAAO,CAAAC,MAAA,CAAO,EAAC,EAAGN,kBAAmB,CAAAE,KAAA,CAAMX,aAAgB,GAAAI,eAAe,CAAC;GAAA;EAEzG,IAAAY,WAAA,GAAcN,QAAA,CAAS,YAAM;IACjC,OAAOD,kBAAA,CAAmBE,KAAM,CAAAK,WAAA;EAClC,CAAC;EAGK,IAAAC,CAAA,GAAI,SAAJA,EAAiBC,OAAA,EAA4B;IAAA,SAAAC,IAAA,GAAAlB,SAAA,CAAAC,MAAA,EAAbkB,IAAa,OAAAC,KAAA,CAAAF,IAAA,OAAAA,IAAA,WAAAG,IAAA,MAAAA,IAAA,GAAAH,IAAA,EAAAG,IAAA;MAAbF,IAAa,CAAAE,IAAA,QAAArB,SAAA,CAAAqB,IAAA;IAAA;IAC3C,IAACC,IAAI,GAAIH,IAAA;IACX,IAAAI,UAAA,CAASN,OAAO,CAAG;MACrB,IAAI,CAACK,IAAA,EAAa,OAAAL,OAAA;MAClB,IAAMO,OAAU;MAChB,IAAMC,UAAA,GAAaR,OAAQ,CAAAS,OAAA,CAAQF,OAAS,YAACG,KAAA,EAAOC,GAAQ;QAC1D,IAAIN,IAAM;UACD,OAAAO,MAAA,CAAOP,IAAA,CAAKM,GAAI;QACzB;QACO;MACT,CAAC;MACM,OAAAH,UAAA;IACT;IACI,IAAAK,YAAA,CAAWb,OAAO,CAAG;MAEvB,IAAI,CAACE,IAAK,CAAAlB,MAAA,EAAQ,OAAOgB,OAAA,CAAQc,CAAC;MAC3B,OAAAd,OAAA,CAAAe,KAAA,SAAWb,IAAI;IACxB;IACO;GACT;EAEO;IACLH,CAAA,EAAAA,CAAA;IACAiB,MAAQ,EAAArB,YAAA;IACRA,YAAA,EAAAA,YAAA;IACAG,WAAA,EAAAA;GACF;AACF;IAOamB,aAAA,GAAgB,SAAhBA,cAAiBC,KAA+B;EACrD,IAAAC,WAAA,GAAcC,WAAA,CAAU1B,mBAAmB;EACjD,IAAMH,kBAAqB,GAAAC,QAAA,CAAS;IAAA,OAClCI,MAAA,CAAOC,MAAO,KAAIwB,SAAU,CAAAF,WAAA,EAAgDD,KAAM,CAAAvB,YAAY,CAAC;EAAA,CACjG;EAEA2B,OAAA,CAAQhC,uBAAA,EAAyBC,kBAAkB;EAE/C,KAACZ,gBAAA,CAAiBc,KAAO;IAC3Bd,gBAAA,CAAiBc,KAAA,GAAQF,kBAAmB,CAAAE,KAAA;EAC9C;EAEO,OAAAF,kBAAA;AACT","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}