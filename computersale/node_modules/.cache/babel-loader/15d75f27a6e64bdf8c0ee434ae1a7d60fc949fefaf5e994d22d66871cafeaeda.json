{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\n/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _defineProperty } from '../_chunks/dep-fa52aa21.mjs';\nimport { defineComponent, reactive, h, createApp } from 'vue';\nimport { m as merge_1 } from '../_chunks/dep-1b9718a2.mjs';\nimport _Loading from './loading.mjs';\nimport { getAttach, addClass, removeClass } from '../utils/dom.mjs';\nimport { usePrefixClass } from '../hooks/useConfig.mjs';\nimport '../_chunks/dep-4659d73b.mjs';\nimport '../_chunks/dep-eca422c3.mjs';\nimport '../_chunks/dep-92f86d1d.mjs';\nimport '../_chunks/dep-6ab5363f.mjs';\nimport '../_chunks/dep-6dc3d0e1.mjs';\nimport '../_chunks/dep-06dcbf4c.mjs';\nimport '../_chunks/dep-bf7257e7.mjs';\nimport '../_chunks/dep-2b09875b.mjs';\nimport '../_chunks/dep-cda4f568.mjs';\nimport '../_chunks/dep-76958824.mjs';\nimport '../_chunks/dep-e9841b9e.mjs';\nimport '../_chunks/dep-1a4bb2f2.mjs';\nimport '../_chunks/dep-cc8ebcde.mjs';\nimport '../_chunks/dep-29ef8419.mjs';\nimport '../_chunks/dep-f5579c03.mjs';\nimport '../_chunks/dep-49aeee3c.mjs';\nimport '../_chunks/dep-b5bf85f5.mjs';\nimport '../_chunks/dep-3c65fae8.mjs';\nimport '../_chunks/dep-eae2a67e.mjs';\nimport '../_chunks/dep-626c497d.mjs';\nimport '../_chunks/dep-ec0bbd9f.mjs';\nimport '../_chunks/dep-e065dc25.mjs';\nimport '../_chunks/dep-400ec705.mjs';\nimport '../_chunks/dep-02f9394e.mjs';\nimport '../_chunks/dep-1725b1c7.mjs';\nimport '../_chunks/dep-532409c5.mjs';\nimport '../_common/js/global-config/default-config.mjs';\nimport '../_common/js/global-config/locale/zh_CN.mjs';\nimport '../_chunks/dep-9ed7da3e.mjs';\nimport '../_chunks/dep-7f65fc46.mjs';\nimport '../_chunks/dep-4f2cabb0.mjs';\nimport '../_chunks/dep-5efe53d1.mjs';\nimport '../_chunks/dep-593f2b67.mjs';\nimport './icon/gradient.mjs';\nimport '../_common/js/loading/circle-adapter.mjs';\nimport '../_common/js/utils/set-style.mjs';\nimport '../_common/js/utils/helper.mjs';\nimport '../_chunks/dep-4a990ea3.mjs';\nimport '../_chunks/dep-5d3f7c0e.mjs';\nimport '../_chunks/dep-03a7fb6c.mjs';\nimport '../_chunks/dep-73384992.mjs';\nimport '../_chunks/dep-58a62202.mjs';\nimport '../_chunks/dep-889e457b.mjs';\nimport '../utils/render-tnode.mjs';\nimport '../_chunks/dep-b91a8171.mjs';\nimport '../_chunks/dep-1b78414a.mjs';\nimport '../_chunks/dep-d84f19b3.mjs';\nimport '../_chunks/dep-03ad9cda.mjs';\nimport '../_chunks/dep-7932c2e8.mjs';\nimport '../_chunks/dep-ab4bb9b8.mjs';\nimport '../_chunks/dep-d8a34055.mjs';\nimport '../_chunks/dep-2f6e28a0.mjs';\nimport '../_chunks/dep-5a17bf21.mjs';\nimport '../_chunks/dep-bad871d5.mjs';\nimport './props.mjs';\nimport '../hooks/useTeleport.mjs';\nimport '../utils/easing.mjs';\nimport '../config-provider/useConfig.mjs';\nimport '../_chunks/dep-bb899bfd.mjs';\nimport '../_chunks/dep-5922c8f3.mjs';\nimport '../_chunks/dep-732f0b7d.mjs';\nimport '../config-provider/type.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nvar fullScreenLoadingInstance = null;\nfunction mergeDefaultProps(props) {\n  var options = merge_1({\n    fullscreen: false,\n    attach: \"body\",\n    loading: true,\n    preventScrollThrough: true\n  }, props);\n  return options;\n}\nfunction createLoading(props) {\n  var mergedProps = mergeDefaultProps(props);\n  if (mergedProps.fullscreen && fullScreenLoadingInstance) {\n    return fullScreenLoadingInstance;\n  }\n  var component = defineComponent({\n    setup: function setup() {\n      var loadingOptions = reactive(mergedProps);\n      return {\n        loadingOptions: loadingOptions\n      };\n    },\n    render: function render() {\n      return h(_Loading, _objectSpread({}, this.loadingOptions));\n    }\n  });\n  var attach = getAttach(mergedProps.fullscreen ? \"body\" : mergedProps.attach);\n  var app = createApp(component);\n  var loading = app.mount(document.createElement(\"div\"));\n  var parentRelativeClass = usePrefixClass(\"loading__parent--relative\").value;\n  var lockClass = usePrefixClass(\"loading--lock\");\n  var lockFullscreen = mergedProps.preventScrollThrough && mergedProps.fullscreen;\n  if (lockFullscreen) {\n    addClass(document.body, lockClass.value);\n  }\n  if (attach) {\n    addClass(attach, parentRelativeClass);\n  } else {\n    console.error(\"attach is not exist\");\n  }\n  var loadingInstance = {\n    hide: function hide() {\n      loading.loading = false;\n      removeClass(attach, parentRelativeClass);\n      removeClass(document.body, lockClass.value);\n      app.unmount();\n    }\n  };\n  return loadingInstance;\n}\nfunction produceLoading(props) {\n  if (props === true) {\n    fullScreenLoadingInstance = createLoading({\n      fullscreen: true,\n      loading: true,\n      attach: \"body\",\n      preventScrollThrough: true\n    });\n    return fullScreenLoadingInstance;\n  }\n  if (props === false) {\n    var _fullScreenLoadingIns;\n    (_fullScreenLoadingIns = fullScreenLoadingInstance) === null || _fullScreenLoadingIns === void 0 || _fullScreenLoadingIns.hide();\n    fullScreenLoadingInstance = null;\n    return;\n  }\n  return createLoading(props);\n}\nvar LoadingPlugin = produceLoading;\nLoadingPlugin.install = function (app) {\n  app.config.globalProperties.$loading = produceLoading;\n};\nexport { LoadingPlugin, LoadingPlugin as default };","map":{"version":3,"names":["fullScreenLoadingInstance","mergeDefaultProps","props","options","merge_1","fullscreen","attach","loading","preventScrollThrough","createLoading","mergedProps","component","defineComponent","setup","loadingOptions","reactive","render","h","_Loading","_objectSpread","getAttach","app","createApp","mount","document","createElement","parentRelativeClass","usePrefixClass","value","lockClass","lockFullscreen","addClass","body","console","error","loadingInstance","hide","removeClass","unmount","produceLoading","_fullScreenLoadingIns","LoadingPlugin","install","config","globalProperties","$loading"],"sources":["../../src/loading/plugin.tsx"],"sourcesContent":["import { App, Plugin, createApp, defineComponent, h, reactive } from 'vue';\nimport merge from 'lodash/merge';\nimport LoadingComponent from './loading';\nimport { getAttach, removeClass, addClass } from '../utils/dom';\nimport { TdLoadingProps, LoadingInstance, LoadingMethod } from './type';\nimport { usePrefixClass } from '../hooks/useConfig';\n\nlet fullScreenLoadingInstance: LoadingInstance = null;\n\nfunction mergeDefaultProps(props: TdLoadingProps): TdLoadingProps {\n  const options: TdLoadingProps = merge(\n    {\n      fullscreen: false,\n      attach: 'body',\n      loading: true,\n      preventScrollThrough: true,\n    },\n    props,\n  );\n\n  return options;\n}\n\nfunction createLoading(props: TdLoadingProps): LoadingInstance {\n  const mergedProps = mergeDefaultProps(props);\n\n  if (mergedProps.fullscreen && fullScreenLoadingInstance) {\n    return fullScreenLoadingInstance;\n  }\n\n  const component = defineComponent({\n    setup() {\n      const loadingOptions = reactive(mergedProps);\n      return {\n        loadingOptions,\n      };\n    },\n    render() {\n      return h(LoadingComponent, {\n        ...this.loadingOptions,\n      });\n    },\n  });\n\n  const attach = getAttach(mergedProps.fullscreen ? 'body' : mergedProps.attach);\n\n  const app = createApp(component);\n  const loading = app.mount(document.createElement('div'));\n  const parentRelativeClass = usePrefixClass('loading__parent--relative').value;\n  const lockClass = usePrefixClass('loading--lock');\n  const lockFullscreen = mergedProps.preventScrollThrough && mergedProps.fullscreen;\n\n  if (lockFullscreen) {\n    addClass(document.body, lockClass.value);\n  }\n\n  if (attach) {\n    addClass(attach, parentRelativeClass);\n  } else {\n    console.error('attach is not exist');\n  }\n\n  const loadingInstance: LoadingInstance = {\n    hide: () => {\n      loading.loading = false;\n      removeClass(attach, parentRelativeClass);\n      removeClass(document.body, lockClass.value);\n      app.unmount();\n    },\n  };\n  return loadingInstance;\n}\n\nfunction produceLoading(props: boolean | TdLoadingProps): LoadingInstance {\n  // 全屏加载\n  if (props === true) {\n    fullScreenLoadingInstance = createLoading({\n      fullscreen: true,\n      loading: true,\n      attach: 'body',\n      preventScrollThrough: true,\n    });\n    return fullScreenLoadingInstance;\n  }\n\n  if (props === false) {\n    // 销毁全屏实例\n    fullScreenLoadingInstance?.hide();\n    fullScreenLoadingInstance = null;\n    return;\n  }\n  return createLoading(props);\n}\n\nexport type LoadingPluginType = Plugin & LoadingMethod;\n\nexport const LoadingPlugin: LoadingPluginType = produceLoading as LoadingPluginType;\n\nLoadingPlugin.install = (app: App) => {\n  // eslint-disable-next-line no-param-reassign\n  app.config.globalProperties.$loading = produceLoading;\n};\n\nexport default LoadingPlugin;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA,IAAIA,yBAA6C;AAEjD,SAASC,kBAAkBC,KAAuC;EAChE,IAAMC,OAA0B,GAAAC,OAAA,CAC9B;IACEC,UAAY;IACZC,MAAQ;IACRC,OAAS;IACTC,oBAAsB;GACxB,EACAN,KACF;EAEO,OAAAC,OAAA;AACT;AAEA,SAASM,cAAcP,KAAwC;EACvD,IAAAQ,WAAA,GAAcT,iBAAA,CAAkBC,KAAK;EAEvC,IAAAQ,WAAA,CAAYL,UAAA,IAAcL,yBAA2B;IAChD,OAAAA,yBAAA;EACT;EAEA,IAAMW,SAAA,GAAYC,eAAgB;IAChCC,KAAQ,WAARA,KAAQA,CAAA;MACA,IAAAC,cAAA,GAAiBC,QAAA,CAASL,WAAW;MACpC;QACLI,cAAA,EAAAA;OACF;KACF;IACAE,MAAS,WAATA,MAASA,CAAA;MACP,OAAOC,CAAA,CAAEC,QAAkB,EAAAC,aAAA,KACtB,IAAK,CAAAL,cAAA,CACT;IACH;EACF,CAAC;EAED,IAAMR,MAAA,GAASc,SAAU,CAAAV,WAAA,CAAYL,UAAa,YAASK,WAAA,CAAYJ,MAAM;EAEvE,IAAAe,GAAA,GAAMC,SAAA,CAAUX,SAAS;EAC/B,IAAMJ,OAAA,GAAUc,GAAI,CAAAE,KAAA,CAAMC,QAAS,CAAAC,aAAA,CAAc,KAAK,CAAC;EACjD,IAAAC,mBAAA,GAAsBC,cAAe,4BAA2B,CAAE,CAAAC,KAAA;EAClE,IAAAC,SAAA,GAAYF,cAAA,CAAe,eAAe;EAC1C,IAAAG,cAAA,GAAiBpB,WAAY,CAAAF,oBAAA,IAAwBE,WAAY,CAAAL,UAAA;EAEvE,IAAIyB,cAAgB;IACTC,QAAA,CAAAP,QAAA,CAASQ,IAAM,EAAAH,SAAA,CAAUD,KAAK;EACzC;EAEA,IAAItB,MAAQ;IACVyB,QAAA,CAASzB,MAAA,EAAQoB,mBAAmB;EACtC,CAAO;IACLO,OAAA,CAAQC,KAAA,CAAM,qBAAqB;EACrC;EAEA,IAAMC,eAAmC;IACvCC,IAAA,EAAM,SAANA,KAAA,EAAY;MACV7B,OAAA,CAAQA,OAAU;MAClB8B,WAAA,CAAY/B,MAAA,EAAQoB,mBAAmB;MAC3BW,WAAA,CAAAb,QAAA,CAASQ,IAAM,EAAAH,SAAA,CAAUD,KAAK;MAC1CP,GAAA,CAAIiB,OAAQ;IACd;GACF;EACO,OAAAH,eAAA;AACT;AAEA,SAASI,eAAerC,KAAkD;EAExE,IAAIA,KAAA,KAAU,IAAM;IAClBF,yBAAA,GAA4BS,aAAc;MACxCJ,UAAY;MACZE,OAAS;MACTD,MAAQ;MACRE,oBAAsB;IACxB,CAAC;IACM,OAAAR,yBAAA;EACT;EAEA,IAAIE,KAAA,KAAU,KAAO;IAAA,IAAAsC,qBAAA;IAEnB,CAAAA,qBAAA,GAAAxC,yBAAA,cAAAwC,qBAAA,eAAAA,qBAAA,CAA2BJ,IAAK;IACJpC,yBAAA;IAC5B;EACF;EACA,OAAOS,aAAA,CAAcP,KAAK;AAC5B;AAIO,IAAMuC,aAAmC,GAAAF,cAAA;AAEhDE,aAAc,CAAAC,OAAA,GAAU,UAACrB,GAAa;EAEhCA,GAAA,CAAAsB,MAAA,CAAOC,gBAAA,CAAiBC,QAAW,GAAAN,cAAA;AACzC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}