{"ast":null,"code":"/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport useResizeObserver from '../hooks/useResizeObserver.mjs';\nimport { toRefs, ref, onBeforeUnmount, watch, nextTick, onMounted } from 'vue';\nvar ANIMATION_TIME = 100;\nfunction useInputWidth(props, inputRef, innerValue) {\n  var _toRefs = toRefs(props),\n    autoWidth = _toRefs.autoWidth,\n    placeholder = _toRefs.placeholder;\n  var inputPreRef = ref(null);\n  var observerTimer = ref(null);\n  var updateInputWidth = function updateInputWidth() {\n    if (!inputPreRef.value || !inputRef.value) return;\n    inputRef.value.style.width = getComputedStyle(inputPreRef.value).width;\n  };\n  useResizeObserver(inputPreRef, function () {\n    if (autoWidth.value) {\n      observerTimer.value = setTimeout(function () {\n        updateInputWidth();\n        clearTimeout(observerTimer.value);\n      }, ANIMATION_TIME);\n    }\n  });\n  onBeforeUnmount(function () {\n    clearTimeout(observerTimer.value);\n  });\n  var addListeners = function addListeners() {\n    watch([innerValue, placeholder], function () {\n      if (!autoWidth.value) return;\n      nextTick(function () {\n        updateInputWidth();\n      });\n    }, {\n      immediate: true\n    });\n  };\n  onMounted(function () {\n    if (autoWidth.value) {\n      addListeners();\n    }\n  });\n  return {\n    inputPreRef: inputPreRef\n  };\n}\nexport { useInputWidth as default };","map":{"version":3,"names":["ANIMATION_TIME","useInputWidth","props","inputRef","innerValue","_toRefs","toRefs","autoWidth","placeholder","inputPreRef","ref","observerTimer","updateInputWidth","value","style","width","getComputedStyle","useResizeObserver","setTimeout","clearTimeout","onBeforeUnmount","addListeners","watch","nextTick","immediate","onMounted"],"sources":["../../src/input/useInputWidth.ts"],"sourcesContent":["import useResizeObserver from '../hooks/useResizeObserver';\nimport { onMounted, Ref, ref, watch, nextTick, onBeforeUnmount, toRefs } from 'vue';\nimport { InputValue, TdInputProps } from './type';\n\nconst ANIMATION_TIME = 100;\n\nexport default function useInputWidth(\n  props: TdInputProps,\n  inputRef: Ref<HTMLInputElement>,\n  innerValue: Ref<InputValue>,\n) {\n  const { autoWidth, placeholder } = toRefs(props);\n  const inputPreRef = ref<HTMLSpanElement>(null);\n  const observerTimer = ref(null);\n\n  const updateInputWidth = () => {\n    if (!inputPreRef.value || !inputRef.value) return;\n    // 使用 getComputedStyle 规避 transform 带来的影响\n    inputRef.value.style.width = getComputedStyle(inputPreRef.value).width;\n  };\n\n  useResizeObserver(inputPreRef, () => {\n    if (autoWidth.value) {\n      observerTimer.value = setTimeout(() => {\n        updateInputWidth();\n        clearTimeout(observerTimer.value);\n      }, ANIMATION_TIME);\n    }\n  });\n\n  onBeforeUnmount(() => {\n    clearTimeout(observerTimer.value);\n  });\n\n  const addListeners = () => {\n    watch(\n      [innerValue, placeholder],\n      () => {\n        if (!autoWidth.value) return;\n        nextTick(() => {\n          updateInputWidth();\n        });\n      },\n      { immediate: true },\n    );\n  };\n\n  onMounted(() => {\n    if (autoWidth.value) {\n      addListeners();\n    }\n  });\n\n  return {\n    inputPreRef,\n  };\n}\n"],"mappings":";;;;;;;;AAIA,IAAMA,cAAiB;AAEC,SAAAC,cACtBC,KACA,EAAAC,QAAA,EACAC,UACA;EACA,IAAAC,OAAA,GAAmCC,MAAA,CAAOJ,KAAK;IAAvCK,SAAA,GAAAF,OAAA,CAAAE,SAAA;IAAWC,WAAY,GAAAH,OAAA,CAAZG,WAAY;EACzB,IAAAC,WAAA,GAAcC,GAAA,CAAqB,IAAI;EACvC,IAAAC,aAAA,GAAgBD,GAAA,CAAI,IAAI;EAE9B,IAAME,gBAAA,GAAmB,SAAnBA,iBAAA,EAAyB;IAC7B,IAAI,CAACH,WAAA,CAAYI,KAAS,KAACV,QAAS,CAAAU,KAAA,EAAO;IAE3CV,QAAA,CAASU,KAAA,CAAMC,KAAM,CAAAC,KAAA,GAAQC,gBAAiB,CAAAP,WAAA,CAAYI,KAAK,CAAE,CAAAE,KAAA;GACnE;EAEAE,iBAAA,CAAkBR,WAAA,EAAa,YAAM;IACnC,IAAIF,SAAA,CAAUM,KAAO;MACLF,aAAA,CAAAE,KAAA,GAAQK,UAAA,CAAW,YAAM;QACpBN,gBAAA;QACjBO,YAAA,CAAaR,aAAA,CAAcE,KAAK;SAC/Bb,cAAc;IACnB;EACF,CAAC;EAEDoB,eAAA,CAAgB,YAAM;IACpBD,YAAA,CAAaR,aAAA,CAAcE,KAAK;EAClC,CAAC;EAED,IAAMQ,YAAA,GAAe,SAAfA,aAAA,EAAqB;IACzBC,KAAA,CACE,CAAClB,UAAA,EAAYI,WAAW,GACxB,YAAM;MACJ,IAAI,CAACD,SAAU,CAAAM,KAAA,EAAO;MACtBU,QAAA,CAAS,YAAM;QACIX,gBAAA;MACnB,CAAC;IACH,GACA;MAAEY,SAAA,EAAW;IAAK,CACpB;GACF;EAEAC,SAAA,CAAU,YAAM;IACd,IAAIlB,SAAA,CAAUM,KAAO;MACNQ,YAAA;IACf;EACF,CAAC;EAEM;IACLZ,WAAA,EAAAA;GACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}