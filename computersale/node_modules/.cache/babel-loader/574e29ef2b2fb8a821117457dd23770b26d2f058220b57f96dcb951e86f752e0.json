{"ast":null,"code":"/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { i as isFunction_1 } from '../../_chunks/dep-06dcbf4c.mjs';\nimport { ref, toRefs, onMounted, onUnmounted } from 'vue';\nimport '../../_chunks/dep-eca422c3.mjs';\nimport '../../_chunks/dep-bf7257e7.mjs';\nimport '../../_chunks/dep-4659d73b.mjs';\nimport '../../_chunks/dep-2b09875b.mjs';\nimport '../../_chunks/dep-cda4f568.mjs';\nfunction useTagScroll(props) {\n  var tagInputRef = ref();\n  var _toRefs = toRefs(props),\n    excessTagsDisplayType = _toRefs.excessTagsDisplayType,\n    readonly = _toRefs.readonly,\n    disabled = _toRefs.disabled;\n  var scrollDistance = ref(0);\n  var scrollElement = ref();\n  var mouseEnterTimer = ref();\n  var isScrollable = ref(false);\n  var updateScrollElement = function updateScrollElement(element) {\n    var inputElement = element.children[0];\n    scrollElement.value = inputElement;\n  };\n  var updateScrollDistance = function updateScrollDistance() {\n    scrollDistance.value = scrollElement.value.scrollWidth - scrollElement.value.clientWidth;\n  };\n  var scrollTo = function scrollTo(distance) {\n    var _scrollElement$value;\n    if (!isFunction_1((_scrollElement$value = scrollElement.value) === null || _scrollElement$value === void 0 ? void 0 : _scrollElement$value.scroll)) return;\n    scrollElement.value.scroll({\n      left: distance,\n      behavior: \"smooth\"\n    });\n  };\n  var scrollToRight = function scrollToRight() {\n    updateScrollDistance();\n    scrollTo(scrollDistance.value);\n    setTimeout(function () {\n      isScrollable.value = true;\n    }, 200);\n  };\n  var scrollToLeft = function scrollToLeft() {\n    scrollTo(0);\n  };\n  var onWheel = function onWheel(_ref) {\n    var e = _ref.e;\n    if (readonly.value || disabled.value) return;\n    if (!scrollElement.value) return;\n    if (e.deltaX > 0) {\n      var distance = Math.min(scrollElement.value.scrollLeft + 120, scrollDistance.value);\n      scrollTo(distance);\n    } else {\n      var _distance = Math.max(scrollElement.value.scrollLeft - 120, 0);\n      scrollTo(_distance);\n    }\n  };\n  var scrollToRightOnEnter = function scrollToRightOnEnter() {\n    if (excessTagsDisplayType.value !== \"scroll\") return;\n    mouseEnterTimer.value = setTimeout(function () {\n      scrollToRight();\n      clearTimeout(mouseEnterTimer.value);\n    }, 100);\n  };\n  var scrollToLeftOnLeave = function scrollToLeftOnLeave() {\n    if (excessTagsDisplayType.value !== \"scroll\") return;\n    isScrollable.value = false;\n    scrollTo(0);\n    clearTimeout(mouseEnterTimer.value);\n  };\n  var init = function init() {\n    var _tagInputRef$value;\n    var element = (_tagInputRef$value = tagInputRef.value) === null || _tagInputRef$value === void 0 ? void 0 : _tagInputRef$value.$el;\n    if (!element) return;\n    updateScrollElement(element);\n  };\n  var clear = function clear() {\n    clearTimeout(mouseEnterTimer.value);\n  };\n  onMounted(init);\n  onUnmounted(clear);\n  return {\n    tagInputRef: tagInputRef,\n    scrollElement: scrollElement,\n    scrollDistance: scrollDistance,\n    scrollTo: scrollTo,\n    scrollToRight: scrollToRight,\n    scrollToLeft: scrollToLeft,\n    updateScrollElement: updateScrollElement,\n    updateScrollDistance: updateScrollDistance,\n    onWheel: onWheel,\n    scrollToRightOnEnter: scrollToRightOnEnter,\n    scrollToLeftOnLeave: scrollToLeftOnLeave,\n    isScrollable: isScrollable\n  };\n}\nexport { useTagScroll as default };","map":{"version":3,"names":["useTagScroll","props","tagInputRef","ref","_toRefs","toRefs","excessTagsDisplayType","readonly","disabled","scrollDistance","scrollElement","mouseEnterTimer","isScrollable","updateScrollElement","element","inputElement","children","value","updateScrollDistance","scrollWidth","clientWidth","scrollTo","distance","_scrollElement$value","isFunction_1","scroll","left","behavior","scrollToRight","setTimeout","scrollToLeft","onWheel","_ref","e","deltaX","Math","min","scrollLeft","_distance","max","scrollToRightOnEnter","clearTimeout","scrollToLeftOnLeave","init","_tagInputRef$value","$el","clear","onMounted","onUnmounted"],"sources":["../../../src/tag-input/hooks/useTagScroll.ts"],"sourcesContent":["/**\n * 当标签数量过多时，输入框显示不下，则需要滚动查看，以下为滚动逻辑\n * 如果标签过多时的处理方式，是标签省略，则不需要此功能\n */\n\nimport isFunction from 'lodash/isFunction';\nimport { onMounted, onUnmounted, ref, toRefs } from 'vue';\nimport { TdTagInputProps } from '../type';\n\nexport default function useTagScroll(props: TdTagInputProps) {\n  const tagInputRef = ref();\n  const { excessTagsDisplayType, readonly, disabled } = toRefs(props);\n  // 允许向右滚动的最大距离\n  const scrollDistance = ref(0);\n  const scrollElement = ref<HTMLElement>();\n  const mouseEnterTimer = ref();\n  const isScrollable = ref(false); // 设置可滚动\n\n  const updateScrollElement = (element: HTMLElement) => {\n    const inputElement = element.children[0] as HTMLElement;\n    scrollElement.value = inputElement;\n  };\n\n  const updateScrollDistance = () => {\n    scrollDistance.value = scrollElement.value.scrollWidth - scrollElement.value.clientWidth;\n  };\n\n  const scrollTo = (distance: number) => {\n    if (!isFunction(scrollElement.value?.scroll)) return;\n    scrollElement.value.scroll({ left: distance, behavior: 'smooth' });\n  };\n\n  const scrollToRight = () => {\n    updateScrollDistance();\n    scrollTo(scrollDistance.value);\n    setTimeout(() => {\n      isScrollable.value = true;\n    }, 200);\n  };\n\n  const scrollToLeft = () => {\n    scrollTo(0);\n  };\n\n  // TODO：MAC 电脑横向滚动，Windows 纵向滚动。当前只处理了横向滚动\n  const onWheel = ({ e }: { e: WheelEvent }) => {\n    if (readonly.value || disabled.value) return;\n    if (!scrollElement.value) return;\n    if (e.deltaX > 0) {\n      const distance = Math.min(scrollElement.value.scrollLeft + 120, scrollDistance.value);\n      scrollTo(distance);\n    } else {\n      const distance = Math.max(scrollElement.value.scrollLeft - 120, 0);\n      scrollTo(distance);\n    }\n  };\n\n  // 鼠标 hover，自动滑动到最右侧，以便输入新标签\n  const scrollToRightOnEnter = () => {\n    if (excessTagsDisplayType.value !== 'scroll') return;\n    // 一闪而过的 mousenter 不需要执行\n    mouseEnterTimer.value = setTimeout(() => {\n      scrollToRight();\n      clearTimeout(mouseEnterTimer.value);\n    }, 100);\n  };\n\n  const scrollToLeftOnLeave = () => {\n    if (excessTagsDisplayType.value !== 'scroll') return;\n    isScrollable.value = false; // 离开焦点不可滚动\n    scrollTo(0);\n    clearTimeout(mouseEnterTimer.value);\n  };\n\n  const init = () => {\n    const element = tagInputRef.value?.$el;\n    if (!element) return;\n    updateScrollElement(element);\n  };\n\n  const clear = () => {\n    clearTimeout(mouseEnterTimer.value);\n  };\n\n  onMounted(init);\n\n  onUnmounted(clear);\n\n  return {\n    tagInputRef,\n    scrollElement,\n    scrollDistance,\n    scrollTo,\n    scrollToRight,\n    scrollToLeft,\n    updateScrollElement,\n    updateScrollDistance,\n    onWheel,\n    scrollToRightOnEnter,\n    scrollToLeftOnLeave,\n    isScrollable,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}