{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\n/**\n * tdesign v1.10.5\n * (c) 2024 tdesign\n * @license MIT\n */\n\nimport { _ as _defineProperty } from '../_chunks/dep-fa52aa21.mjs';\nimport { positiveAdd, positiveSubtract } from '../_common/js/input-number/number.mjs';\nimport { ref, watch } from 'vue';\nimport { t as throttle_1 } from '../_chunks/dep-525a54df.mjs';\nimport '../_chunks/dep-4659d73b.mjs';\nimport '../_chunks/dep-58a62202.mjs';\nimport '../_chunks/dep-eca422c3.mjs';\nimport '../_chunks/dep-03a7fb6c.mjs';\nimport '../_chunks/dep-bf7257e7.mjs';\nimport '../_chunks/dep-eae2a67e.mjs';\nimport '../_chunks/dep-626c497d.mjs';\nimport '../_chunks/dep-29ef8419.mjs';\nimport '../_chunks/dep-889e457b.mjs';\nimport '../_common/js/input-number/large-number.mjs';\nimport '../_chunks/dep-5efe53d1.mjs';\nimport '../_chunks/dep-593f2b67.mjs';\nimport '../_chunks/dep-2b09875b.mjs';\nimport '../_common/js/log/log.mjs';\nimport '../_common/js/log/index.mjs';\nimport '../_chunks/dep-5993931e.mjs';\nimport '../_chunks/dep-cda4f568.mjs';\nimport '../_chunks/dep-8dfc9324.mjs';\nimport '../_chunks/dep-ab4bb9b8.mjs';\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nfunction useDrag(initTransform) {\n  var transform = ref(initTransform);\n  var mouseDownHandler = function mouseDownHandler(e) {\n    var startX = e.pageX,\n      startY = e.pageY;\n    var _transform$value = transform.value,\n      translateX = _transform$value.translateX,\n      translateY = _transform$value.translateY;\n    var mouseMoveHandler = function mouseMoveHandler(e2) {\n      var pageX = e2.pageX,\n        pageY = e2.pageY;\n      transform.value = {\n        translateX: translateX + pageX - startX,\n        translateY: translateY + pageY - startY\n      };\n    };\n    var _mouseUpHandler = function mouseUpHandler() {\n      document.removeEventListener(\"mousemove\", mouseMoveHandler);\n      document.removeEventListener(\"mouseup\", _mouseUpHandler);\n    };\n    document.addEventListener(\"mousemove\", mouseMoveHandler);\n    document.addEventListener(\"mouseup\", _mouseUpHandler);\n  };\n  var resetTransform = function resetTransform() {\n    transform.value = _objectSpread({}, initTransform);\n  };\n  return {\n    transform: transform,\n    mouseDownHandler: mouseDownHandler,\n    resetTransform: resetTransform\n  };\n}\nfunction useMirror() {\n  var mirror = ref(1);\n  var onMirror = function onMirror() {\n    mirror.value *= -1;\n  };\n  var resetMirror = function resetMirror() {\n    mirror.value = 1;\n  };\n  return {\n    mirror: mirror,\n    onMirror: onMirror,\n    resetMirror: resetMirror\n  };\n}\nfunction useScale() {\n  var imageScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n    max: 2,\n    min: 0.5,\n    step: 0.2\n  };\n  var max = imageScale.max,\n    min = imageScale.min,\n    step = imageScale.step,\n    defaultScale = imageScale.defaultScale;\n  var scale = ref(defaultScale !== null && defaultScale !== void 0 ? defaultScale : 1);\n  var onZoomIn = throttle_1(function () {\n    var result = positiveAdd(scale.value, step);\n    setScale(result);\n  }, 50);\n  var onZoomOut = throttle_1(function () {\n    var result = positiveSubtract(scale.value, step);\n    setScale(result);\n  }, 50);\n  var resetScale = function resetScale() {\n    scale.value = defaultScale !== null && defaultScale !== void 0 ? defaultScale : 1;\n  };\n  var setScale = function setScale(newScale) {\n    var value = newScale;\n    if (newScale < min) {\n      value = min;\n    }\n    if (newScale > max) {\n      value = max;\n    }\n    scale.value = value;\n  };\n  watch(function () {\n    return imageScale;\n  }, function () {\n    return resetScale();\n  });\n  return {\n    scale: scale,\n    onZoomIn: onZoomIn,\n    onZoomOut: onZoomOut,\n    resetScale: resetScale\n  };\n}\nfunction useRotate() {\n  var rotate = ref(0);\n  var ROTATE_DEG = 90;\n  var onRotate = function onRotate() {\n    rotate.value += ROTATE_DEG;\n  };\n  var resetRotate = function resetRotate() {\n    rotate.value = 0;\n  };\n  return {\n    rotate: rotate,\n    onRotate: onRotate,\n    resetRotate: resetRotate\n  };\n}\nexport { useDrag, useMirror, useRotate, useScale };","map":{"version":3,"names":["useDrag","initTransform","transform","ref","mouseDownHandler","e","startX","pageX","startY","pageY","_transform$value","value","translateX","translateY","mouseMoveHandler","e2","_mouseUpHandler","mouseUpHandler","document","removeEventListener","addEventListener","resetTransform","_objectSpread","useMirror","mirror","onMirror","resetMirror","useScale","imageScale","arguments","length","undefined","max","min","step","defaultScale","scale","onZoomIn","throttle_1","result","positiveAdd","setScale","onZoomOut","positiveSubtract","resetScale","newScale","watch","useRotate","rotate","ROTATE_DEG","onRotate","resetRotate"],"sources":["../../src/image-viewer/hooks.ts"],"sourcesContent":["import { positiveSubtract, positiveAdd } from '../_common/js/input-number/number';\nimport { ref, watch } from 'vue';\nimport { ImageScale } from './type';\nimport throttle from 'lodash/throttle';\n\ninterface InitTransform {\n  translateX: number;\n  translateY: number;\n}\n\nexport function useDrag(initTransform: InitTransform) {\n  const transform = ref(initTransform);\n\n  const mouseDownHandler = (e: MouseEvent) => {\n    const { pageX: startX, pageY: startY } = e;\n    const { translateX, translateY } = transform.value;\n    const mouseMoveHandler = (e: MouseEvent) => {\n      const { pageX, pageY } = e;\n      transform.value = {\n        translateX: translateX + pageX - startX,\n        translateY: translateY + pageY - startY,\n      };\n    };\n    const mouseUpHandler = () => {\n      document.removeEventListener('mousemove', mouseMoveHandler);\n      document.removeEventListener('mouseup', mouseUpHandler);\n    };\n\n    document.addEventListener('mousemove', mouseMoveHandler);\n    document.addEventListener('mouseup', mouseUpHandler);\n  };\n\n  const resetTransform = () => {\n    transform.value = { ...initTransform };\n  };\n\n  return { transform, mouseDownHandler, resetTransform };\n}\n\nexport function useMirror() {\n  const mirror = ref(1);\n  const onMirror = () => {\n    mirror.value *= -1;\n  };\n  const resetMirror = () => {\n    mirror.value = 1;\n  };\n\n  return { mirror, onMirror, resetMirror };\n}\n\nexport function useScale(imageScale: ImageScale = { max: 2, min: 0.5, step: 0.2 }) {\n  const { max, min, step, defaultScale } = imageScale;\n  const scale = ref(defaultScale ?? 1);\n\n  const onZoomIn = throttle(() => {\n    const result = positiveAdd(scale.value, step);\n    setScale(result);\n  }, 50);\n\n  const onZoomOut = throttle(() => {\n    const result = positiveSubtract(scale.value, step);\n    setScale(result);\n  }, 50);\n\n  const resetScale = () => {\n    scale.value = defaultScale ?? 1;\n  };\n\n  const setScale = (newScale: number) => {\n    let value = newScale;\n    if (newScale < min) {\n      value = min;\n    }\n    if (newScale > max) {\n      value = max;\n    }\n    scale.value = value;\n  };\n\n  watch(\n    () => imageScale,\n    () => resetScale(),\n  );\n\n  return { scale, onZoomIn, onZoomOut, resetScale };\n}\n\nexport function useRotate() {\n  const rotate = ref(0);\n  const ROTATE_DEG = 90;\n\n  const onRotate = () => {\n    rotate.value += ROTATE_DEG;\n  };\n  const resetRotate = () => {\n    rotate.value = 0;\n  };\n\n  return { rotate, onRotate, resetRotate };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}